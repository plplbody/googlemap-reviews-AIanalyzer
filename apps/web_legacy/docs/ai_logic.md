# AI評価ロジック仕様書
*   **フィルタリング条件**:
    *   **文字数制限**: 15文字以上 (`MIN_REVIEW_LENGTH = 15`)
    *   **目的**: 「美味しい」「最悪」といった一言だけの感情的な投稿や、具体性のないサクラ投稿を排除し、論理的な構造を持つレビューのみを抽出するため。
*   **フォールバック**:
    *   フィルタリング後のレビューが0件になった場合は、元のレビュー（全件）をフォールバックとして使用します。
    *   APIからレビューが1件も取得できなかった場合は、デモ用のモックレビューを使用します（開発環境用）。

## 3. AIプロンプト設計 (Prompt Engineering)

Geminiに入力するプロンプトには、客観性と整合性を保つための厳格なルールを設定しています。

### 3.1. 主要な指示 (Core Instructions)

*   **役割**: レストランレビュアーとして、提供されたテキストのみに基づいて分析を行う。
*   **言語**: 出力は**必ず日本語**で行う。
*   **スコアリング**: 味、接客、雰囲気、コスパを0-5点で評価する。

### 3.2. スコアリング・ルール (Scoring Rules)

以下の3つのルールを徹底させています。

1.  **事前知識の排除 (NO PRIOR KNOWLEDGE)**
    *   「はま寿司＝安い」といったブランドイメージや外部知識は一切使用しない。
    *   **提供された口コミテキストのみ**を根拠に判断する。

2.  **証拠主義 (EVIDENCE BASED)**
    *   特定の評価軸（例：コスパ）に関する具体的な記述が口コミにない場合は、推測せずに**「3 (Neutral/標準)」**をつける。
    *   これにより、根拠のない高評価/低評価（ハルシネーション）を防ぐ。

3.  **論理的評価 (STRUCTURED REVIEWS ONLY)**
    *   感情的な罵倒や絶賛ではなく、論理と理由（Logic and Reasoning）に焦点を当てる。

### 3.3. 出力項目 (Output Schema)

AIは以下のJSON形式で結果を出力します。

| 項目 | 説明 |
| :--- | :--- |
| `trueScore` | **AI分析スコア (AI Analysis Score)**。感情の信頼性に基づく加重平均スコア。Googleスコアとの乖離がある場合、こちらが「口コミの実態」を表す。 |
| `axisScores` | 味、接客、雰囲気、コスパの4軸評価 (0-5)。 |
| `usageScores` | 利用シーン（ビジネス、デート、お一人様、ファミリー）への適性評価 (0-5)。 |
| `usageSummary` | 利用シーン評価の根拠となる要約コメント（例：「個室があるためビジネス向き」など）。 |
| `summary` | 全体的な要約コメント。 |
| `gapReason` | GoogleスコアとAI分析スコアに乖離がある理由の解説。 |
| `axisAnalysis` | 4つの評価軸ごとの詳細分析。<br>- `pros`: 評価されている点（リスト）<br>- `cons`: 懸念されている点（リスト）<br>- `summary`: その軸の要約 |

## 4. AI分析スコア (AI Analysis Score) の定義

**AI分析スコア** とは、単なる平均値ではなく、AIが口コミの内容を精査し、**「信頼できるレビュアーの意見」を重視して算出したスコア**です。

*   **Googleスコアとの違い**:
    *   Googleスコア: 全ての星評価の単純平均（サクラや一言レビューも含む）。
    *   AI分析スコア: 具体的な記述があるレビューに基づき、AIが質的判断を加えたスコア。
*   **活用方法**:
    *   Googleスコアが高くてもAI分析スコアが低い場合 → 「見かけ倒し」や「サクラ疑惑」の可能性。
    *   Googleスコアが低くてもAI分析スコアが高い場合 → 「隠れた名店」の可能性。
