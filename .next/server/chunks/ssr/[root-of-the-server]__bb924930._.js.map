{"version":3,"sources":["../../../../node_modules/data-uri-to-buffer/src/index.ts"],"sourcesContent":["export interface MimeBuffer extends Buffer {\n\ttype: string;\n\ttypeFull: string;\n\tcharset: string;\n}\n\n/**\n * Returns a `Buffer` instance from the given data URI `uri`.\n *\n * @param {String} uri Data URI to turn into a Buffer instance\n * @returns {Buffer} Buffer instance from Data URI\n * @api public\n */\nexport function dataUriToBuffer(uri: string): MimeBuffer {\n\tif (!/^data:/i.test(uri)) {\n\t\tthrow new TypeError(\n\t\t\t'`uri` does not appear to be a Data URI (must begin with \"data:\")'\n\t\t);\n\t}\n\n\t// strip newlines\n\turi = uri.replace(/\\r?\\n/g, '');\n\n\t// split the URI up into the \"metadata\" and the \"data\" portions\n\tconst firstComma = uri.indexOf(',');\n\tif (firstComma === -1 || firstComma <= 4) {\n\t\tthrow new TypeError('malformed data: URI');\n\t}\n\n\t// remove the \"data:\" scheme and parse the metadata\n\tconst meta = uri.substring(5, firstComma).split(';');\n\n\tlet charset = '';\n\tlet base64 = false;\n\tconst type = meta[0] || 'text/plain';\n\tlet typeFull = type;\n\tfor (let i = 1; i < meta.length; i++) {\n\t\tif (meta[i] === 'base64') {\n\t\t\tbase64 = true;\n\t\t} else if(meta[i]) {\n\t\t\ttypeFull += `;${  meta[i]}`;\n\t\t\tif (meta[i].indexOf('charset=') === 0) {\n\t\t\t\tcharset = meta[i].substring(8);\n\t\t\t}\n\t\t}\n\t}\n\t// defaults to US-ASCII only if type is not provided\n\tif (!meta[0] && !charset.length) {\n\t\ttypeFull += ';charset=US-ASCII';\n\t\tcharset = 'US-ASCII';\n\t}\n\n\t// get the encoded data portion and decode URI-encoded chars\n\tconst encoding = base64 ? 'base64' : 'ascii';\n\tconst data = unescape(uri.substring(firstComma + 1));\n\tconst buffer = Buffer.from(data, encoding) as MimeBuffer;\n\n\t// set `.type` and `.typeFull` properties to MIME type\n\tbuffer.type = type;\n\tbuffer.typeFull = typeFull;\n\n\t// set the `.charset` property\n\tbuffer.charset = charset;\n\n\treturn buffer;\n}\n\nexport default dataUriToBuffer;\n"],"names":[],"mappings":"siBAaM,SAA0B,AAAhB,CAA2B,EAC1C,GAAI,CAAC,QADyB,CAChB,CAAC,IAAI,CAAC,GAAG,AACtB,CADuB,EAAE,GACnB,AAAI,SAAS,CAClB,kEAAkE,CAClE,CAAC,AAOH,IAAM,EAAa,CAHnB,EAAM,AAGgB,CAHnB,CAAO,CAAD,EAGO,IAHC,CAAC,QAAQ,CAAE,GAAE,CAAC,CAAC,AAGT,OAAO,CAAC,GAAG,CAAC,CACnC,AADoC,GACjB,CAAC,CAAC,GAAjB,GAAqB,GAAc,CAAC,CACvC,CADyC,CAA5B,GAAqB,CAC5B,AAAI,SAAS,CAAC,qBAAqB,CAAC,CAAC,AAI5C,IAAM,EAAO,EAAH,AAAO,CAAD,QAAU,CAAC,CAAC,CAAE,GAAY,KAAK,CAAC,CAAR,CAAC,CAAU,CAAC,CAEhD,AAFiD,EAEvC,EAAE,CAAC,AACb,EADO,CACE,EACP,CADI,CACG,CADK,AACD,CADE,AACT,AAAQ,CAAC,CAAC,EAAI,YAAY,CAChC,AADiC,EACtB,EACf,EADmB,CAAC,CAAR,AACP,IAAI,CAAC,CAAG,CAAC,CAAE,CAAC,CAAG,EAAK,EAAD,IAAO,CAAE,CAAC,EAAE,CAAE,AACrB,QAAQ,EAAE,CAAtB,CAAI,CAAC,CAAC,CAAC,CACV,GAAS,EACA,CADH,AACO,CADA,AACC,CADA,AACC,CAAC,EAAE,CAClB,GAAY,CAAA,CAAA,EAAM,CAAI,AAAd,CAAe,CAAC,CAAC,CAAA,CAAE,CACS,AADR,CACS,EAAE,CAAnC,CAAI,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,UAAU,CAAC,GAC9B,EAAU,CAAI,CAAC,CAAC,CAAC,CAAV,AAAW,SAAS,CAAC,EAAC,CAAC,CAAC,CAK7B,CAAI,CAAC,CAAC,CAAC,EAAK,EAAD,AAAS,KAAD,CAAO,EAAE,CAChC,GAAY,KAAJ,cAAuB,CAAC,AAChC,EAAU,KAAH,KAAa,CAAC,CAItB,IAAM,EAAW,EAAS,IAAZ,AAAS,CAAC,CAAC,EAAS,CAAC,AAAE,CAAD,MAAQ,CAAC,AACvC,EAAO,EAAH,MAAW,CAAC,EAAI,CAAD,QAAU,CAAC,EAAa,CAAC,CAAC,CAAC,CAAC,AAC/C,EAAS,EAD+B,EAClC,EAAS,CAAC,IAAI,CAAC,EAAM,EAAF,CAS/B,KATyC,CAAe,CAAC,AAGzD,EAAO,IAAD,AAAK,CAAG,EACd,EADkB,AACX,CADY,GACb,IAAS,CAAG,EAGlB,EAAO,IAHmB,AAGpB,CAHqB,EAGb,CAAG,EAEV,CACR,CAAC,GAHwB,CAAC,AAEZ,CAAC","ignoreList":[0]}