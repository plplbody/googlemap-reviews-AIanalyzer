module.exports=[37936,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"registerServerReference",{enumerable:!0,get:function(){return d.registerServerReference}});let d=a.r(11857)},36447,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.GCE_LINUX_BIOS_PATHS=void 0,c.isGoogleCloudServerless=f,c.isGoogleComputeEngineLinux=g,c.isGoogleComputeEngineMACAddress=h,c.isGoogleComputeEngine=i,c.detectGCPResidency=function(){return f()||i()},a.r(22734);let d=a.r(46786);c.GCE_LINUX_BIOS_PATHS={BIOS_DATE:"/sys/class/dmi/id/bios_date",BIOS_VENDOR:"/sys/class/dmi/id/bios_vendor"};let e=/^42:01/;function f(){return!!(process.env.CLOUD_RUN_JOB||process.env.FUNCTION_NAME||process.env.K_SERVICE)}function g(){if("linux"!==(0,d.platform)())return!1}function h(){for(let a of Object.values((0,d.networkInterfaces)()))if(a){for(let{mac:b}of a)if(e.test(b))return!0}return!1}function i(){return g()||h()}},51933,(a,b,c)=>{"use strict";var d={};function e(a,b){!b.unsigned&&--a;let c=b.unsigned?0:-Math.pow(2,a),d=Math.pow(2,a)-1,e=b.moduloBitLength?Math.pow(2,b.moduloBitLength):Math.pow(2,a),f=b.moduloBitLength?Math.pow(2,b.moduloBitLength-1):Math.pow(2,a-1);return function(a,g){g||(g={});let h=+a;if(g.enforceRange){if(!Number.isFinite(h))throw TypeError("Argument is not a finite number");if((h=(h<0?-1:1)*Math.floor(Math.abs(h)))<c||h>d)throw TypeError("Argument is not in byte range");return h}if(!isNaN(h)&&g.clamp){var i;return(h=(i=h)%1==.5&&(1&i)==0?Math.floor(i):Math.round(i))<c&&(h=c),h>d&&(h=d),h}if(!Number.isFinite(h)||0===h)return 0;if(h=(h<0?-1:1)*Math.floor(Math.abs(h))%e,!b.unsigned&&h>=f)return h-e;if(b.unsigned){if(h<0)h+=e;else if(-0===h)return 0}return h}}b.exports=d,d.void=function(){},d.boolean=function(a){return!!a},d.byte=e(8,{unsigned:!1}),d.octet=e(8,{unsigned:!0}),d.short=e(16,{unsigned:!1}),d["unsigned short"]=e(16,{unsigned:!0}),d.long=e(32,{unsigned:!1}),d["unsigned long"]=e(32,{unsigned:!0}),d["long long"]=e(32,{unsigned:!1,moduloBitLength:64}),d["unsigned long long"]=e(32,{unsigned:!0,moduloBitLength:64}),d.double=function(a){let b=+a;if(!Number.isFinite(b))throw TypeError("Argument is not a finite floating-point value");return b},d["unrestricted double"]=function(a){let b=+a;if(isNaN(b))throw TypeError("Argument is NaN");return b},d.float=d.double,d["unrestricted float"]=d["unrestricted double"],d.DOMString=function(a,b){return(b||(b={}),b.treatNullAsEmptyString&&null===a)?"":String(a)},d.ByteString=function(a,b){let c,d=String(a);for(let a=0;void 0!==(c=d.codePointAt(a));++a)if(c>255)throw TypeError("Argument is not a valid bytestring");return d},d.USVString=function(a){let b=String(a),c=b.length,d=[];for(let a=0;a<c;++a){let e=b.charCodeAt(a);if(e<55296||e>57343)d.push(String.fromCodePoint(e));else if(56320<=e&&e<=57343)d.push(String.fromCodePoint(65533));else if(a===c-1)d.push(String.fromCodePoint(65533));else{let c=b.charCodeAt(a+1);if(56320<=c&&c<=57343){let b=1023&e,f=1023&c;d.push(String.fromCodePoint(65536+1024*b+f)),++a}else d.push(String.fromCodePoint(65533))}}return d.join("")},d.Date=function(a,b){if(!(a instanceof Date))throw TypeError("Argument is not a Date object");if(!isNaN(a))return a},d.RegExp=function(a,b){return a instanceof RegExp||(a=new RegExp(a)),a}},39534,(a,b,c)=>{"use strict";b.exports.mixin=function(a,b){let c=Object.getOwnPropertyNames(b);for(let d=0;d<c.length;++d)Object.defineProperty(a,c[d],Object.getOwnPropertyDescriptor(b,c[d]))},b.exports.wrapperSymbol=Symbol("wrapper"),b.exports.implSymbol=Symbol("impl"),b.exports.wrapperForImpl=function(a){return a[b.exports.wrapperSymbol]},b.exports.implForWrapper=function(a){return a[b.exports.implSymbol]}},33205,(a,b,c)=>{"use strict";var d=a.r(92097),e=a.r(45736),f={TRANSITIONAL:0,NONTRANSITIONAL:1};function g(a){return a.split("\0").map(function(a){return a.normalize("NFC")}).join("\0")}function h(a){for(var b=0,c=e.length-1;b<=c;){var d=Math.floor((b+c)/2),f=e[d];if(f[0][0]<=a&&f[0][1]>=a)return f;f[0][0]>a?c=d-1:b=d+1}return null}var i=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g;function j(a){return a.replace(i,"_").length}var k=/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08E4-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D01-\u0D03\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u18A9\u1920-\u192B\u1930-\u193B\u19B0-\u19C0\u19C8\u19C9\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF8\u1CF9\u1DC0-\u1DF5\u1DFC-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C4\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2D]|\uD800[\uDDFD\uDEE0\uDF76-\uDF7A]|\uD802[\uDE01-\uDE03\uDE05\uDE06\uDE0C-\uDE0F\uDE38-\uDE3A\uDE3F\uDEE5\uDEE6]|\uD804[\uDC00-\uDC02\uDC38-\uDC46\uDC7F-\uDC82\uDCB0-\uDCBA\uDD00-\uDD02\uDD27-\uDD34\uDD73\uDD80-\uDD82\uDDB3-\uDDC0\uDE2C-\uDE37\uDEDF-\uDEEA\uDF01-\uDF03\uDF3C\uDF3E-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF57\uDF62\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDCB0-\uDCC3\uDDAF-\uDDB5\uDDB8-\uDDC0\uDE30-\uDE40\uDEAB-\uDEB7]|\uD81A[\uDEF0-\uDEF4\uDF30-\uDF36]|\uD81B[\uDF51-\uDF7E\uDF8F-\uDF92]|\uD82F[\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD83A[\uDCD0-\uDCD6]|\uDB40[\uDD00-\uDDEF]/;function l(a,b,c){var e=function(a,b,c){for(var d=!1,e="",g=j(a),i=0;i<g;++i){var k=a.codePointAt(i),l=h(k);switch(l[1]){case"disallowed":d=!0,e+=String.fromCodePoint(k);break;case"ignored":break;case"mapped":e+=String.fromCodePoint.apply(String,l[2]);break;case"deviation":c===f.TRANSITIONAL?e+=String.fromCodePoint.apply(String,l[2]):e+=String.fromCodePoint(k);break;case"valid":e+=String.fromCodePoint(k);break;case"disallowed_STD3_mapped":b?(d=!0,e+=String.fromCodePoint(k)):e+=String.fromCodePoint.apply(String,l[2]);break;case"disallowed_STD3_valid":b&&(d=!0),e+=String.fromCodePoint(k)}}return{string:e,error:d}}(a,b,c);e.string=g(e.string);for(var i=e.string.split("."),m=0;m<i.length;++m)try{var n=function(a,b){"xn--"===a.substr(0,4)&&(a=d.toUnicode(a),f.NONTRANSITIONAL);var c=!1;(g(a)!==a||"-"===a[3]&&"-"===a[4]||"-"===a[0]||"-"===a[a.length-1]||-1!==a.indexOf(".")||0===a.search(k))&&(c=!0);for(var e=j(a),i=0;i<e;++i){var m=h(a.codePointAt(i));if(l===f.TRANSITIONAL&&"valid"!==m[1]||l===f.NONTRANSITIONAL&&"valid"!==m[1]&&"deviation"!==m[1]){c=!0;break}}return{label:a,error:c}}(i[m]);i[m]=n.label,e.error=e.error||n.error}catch(a){e.error=!0}return{string:i.join("."),error:e.error}}b.exports.toASCII=function(a,b,c,e){var f=l(a,b,c),g=f.string.split(".");if(g=g.map(function(a){try{return d.toASCII(a)}catch(b){return f.error=!0,a}}),e){var h=g.slice(0,g.length-1).join(".").length;(h.length>253||0===h.length)&&(f.error=!0);for(var i=0;i<g.length;++i)if(g.length>63||0===g.length){f.error=!0;break}}return f.error?null:g.join(".")},b.exports.toUnicode=function(a,b){var c=l(a,b,f.NONTRANSITIONAL);return{domain:c.string,error:c.error}},b.exports.PROCESSING_OPTIONS=f},16114,(a,b,c)=>{"use strict";let d=a.r(92097),e=a.r(33205),f={ftp:21,file:null,gopher:70,http:80,https:443,ws:80,wss:443},g=Symbol("failure");function h(a){return d.ucs2.decode(a).length}function i(a,b){let c=a[b];return isNaN(c)?void 0:String.fromCodePoint(c)}function j(a){return a>=48&&a<=57}function k(a){return a>=65&&a<=90||a>=97&&a<=122}function l(a){return j(a)||a>=65&&a<=70||a>=97&&a<=102}function m(a){return"."===a||"%2e"===a.toLowerCase()}function n(a){return 2===a.length&&k(a.codePointAt(0))&&(":"===a[1]||"|"===a[1])}function o(a){return void 0!==f[a]}function p(a){return o(a.scheme)}function q(a){let b=a.toString(16).toUpperCase();return 1===b.length&&(b="0"+b),"%"+b}function r(a){return a<=31||a>126}let s=new Set([32,34,35,60,62,63,96,123,125]);function t(a){return r(a)||s.has(a)}let u=new Set([47,58,59,61,64,91,92,93,94,124]);function v(a){return t(a)||u.has(a)}function w(a,b){let c=String.fromCodePoint(a);if(b(a)){let a=new Buffer(c),b="";for(let c=0;c<a.length;++c)b+=q(a[c]);return b}return c}function x(a,b){if("["===a[0])return"]"!==a[a.length-1]?g:function(a){let b=[0,0,0,0,0,0,0,0],c=0,e=null,f=0;if(58===(a=d.ucs2.decode(a))[f]){if(58!==a[f+1])return g;f+=2,e=++c}for(;f<a.length;){if(8===c)return g;if(58===a[f]){if(null!==e)return g;++f,e=++c;continue}let d=0,h=0;for(;h<4&&l(a[f]);)d=16*d+parseInt(i(a,f),16),++f,++h;if(46===a[f]){if(0===h||(f-=h,c>6))return g;let d=0;for(;void 0!==a[f];){let e=null;if(d>0)if(46!==a[f]||!(d<4))return g;else++f;if(!j(a[f]))return g;for(;j(a[f]);){let b=parseInt(i(a,f));if(null===e)e=b;else{if(0===e)return g;e=10*e+b}if(e>255)return g;++f}b[c]=256*b[c]+e,(2==++d||4===d)&&++c}if(4!==d)return g;break}if(58===a[f]){if(void 0===a[++f])return g}else if(void 0!==a[f])return g;b[c]=d,++c}if(null!==e){let a=c-e;for(c=7;0!==c&&a>0;){let d=b[e+a-1];b[e+a-1]=b[c],b[c]=d,--c,--a}}else if(null===e&&8!==c)return g;return b}(a.substring(1,a.length-1));if(!b){var c=a;if(-1!==c.search(/\u0000|\u0009|\u000A|\u000D|\u0020|#|\/|:|\?|@|\[|\\|\]/))return g;let b="",e=d.ucs2.decode(c);for(let a=0;a<e.length;++a)b+=w(e[a],r);return b}let f=function(a){let b=new Buffer(a),c=[];for(let a=0;a<b.length;++a)37!==b[a]?c.push(b[a]):37===b[a]&&l(b[a+1])&&l(b[a+2])?(c.push(parseInt(b.slice(a+1,a+3).toString(),16)),a+=2):c.push(b[a]);return new Buffer(c).toString()}(a),h=e.toASCII(f,!1,e.PROCESSING_OPTIONS.NONTRANSITIONAL,!1);if(null===h||-1!==h.search(/\u0000|\u0009|\u000A|\u000D|\u0020|#|%|\/|:|\?|@|\[|\\|\]/))return g;let k=function(a){let b=a.split(".");if(""===b[b.length-1]&&b.length>1&&b.pop(),b.length>4)return a;let c=[];for(let d of b){if(""===d)return a;let b=function(a){let b=10;return(a.length>=2&&"0"===a.charAt(0)&&"x"===a.charAt(1).toLowerCase()?(a=a.substring(2),b=16):a.length>=2&&"0"===a.charAt(0)&&(a=a.substring(1),b=8),""===a)?0:(10===b?/[^0-9]/:16===b?/[^0-9A-Fa-f]/:/[^0-7]/).test(a)?g:parseInt(a,b)}(d);if(b===g)return a;c.push(b)}for(let a=0;a<c.length-1;++a)if(c[a]>255)return g;if(c[c.length-1]>=Math.pow(256,5-c.length))return g;let d=c.pop(),e=0;for(let a of c)d+=a*Math.pow(256,3-e),++e;return d}(h);return"number"==typeof k||k===g?k:h}function y(a){if("number"==typeof a){let b="",c=a;for(let a=1;a<=4;++a)b=String(c%256)+b,4!==a&&(b="."+b),c=Math.floor(c/256);return b}return a instanceof Array?"["+function(a){let b="",c=function(a){let b=null,c=1,d=null,e=0;for(let f=0;f<a.length;++f)0!==a[f]?(e>c&&(b=d,c=e),d=null,e=0):(null===d&&(d=f),++e);return e>c&&(b=d,c=e),{idx:b,len:c}}(a).idx,d=!1;for(let e=0;e<=7;++e)if(!d||0!==a[e]){if(d&&(d=!1),c===e){b+=0===e?"::":":",d=!0;continue}b+=a[e].toString(16),7!==e&&(b+=":")}return b}(a)+"]":a}function z(a){var b;let c=a.path;0===c.length||"file"===a.scheme&&1===c.length&&(b=c[0],/^[A-Za-z]:$/.test(b))||c.pop()}function A(a){return""!==a.username||""!==a.password}function B(a,b,c,e,f){if(this.pointer=0,this.input=a,this.base=b||null,this.encodingOverride=c||"utf-8",this.stateOverride=f,this.url=e,this.failure=!1,this.parseError=!1,!this.url){this.url={scheme:"",username:"",password:"",host:null,port:null,path:[],query:null,fragment:null,cannotBeABaseURL:!1};let a=this.input.replace(/^[\u0000-\u001F\u0020]+|[\u0000-\u001F\u0020]+$/g,"");a!==this.input&&(this.parseError=!0),this.input=a}let h=this.input.replace(/\u0009|\u000A|\u000D/g,"");for(h!==this.input&&(this.parseError=!0),this.input=h,this.state=f||"scheme start",this.buffer="",this.atFlag=!1,this.arrFlag=!1,this.passwordTokenSeenFlag=!1,this.input=d.ucs2.decode(this.input);this.pointer<=this.input.length;++this.pointer){let a=this.input[this.pointer],b=isNaN(a)?void 0:String.fromCodePoint(a),c=this["parse "+this.state](a,b);if(c){if(c===g){this.failure=!0;break}}else break}}B.prototype["parse scheme start"]=function(a,b){if(k(a))this.buffer+=b.toLowerCase(),this.state="scheme";else{if(this.stateOverride)return this.parseError=!0,g;this.state="no scheme",--this.pointer}return!0},B.prototype["parse scheme"]=function(a,b){if(k(a)||j(a)||43===a||45===a||46===a)this.buffer+=b.toLowerCase();else if(58===a){if(this.stateOverride&&(p(this.url)&&!o(this.buffer)||!p(this.url)&&o(this.buffer)||(A(this.url)||null!==this.url.port)&&"file"===this.buffer||"file"===this.url.scheme&&(""===this.url.host||null===this.url.host))||(this.url.scheme=this.buffer,this.buffer="",this.stateOverride))return!1;"file"===this.url.scheme?((47!==this.input[this.pointer+1]||47!==this.input[this.pointer+2])&&(this.parseError=!0),this.state="file"):p(this.url)&&null!==this.base&&this.base.scheme===this.url.scheme?this.state="special relative or authority":p(this.url)?this.state="special authority slashes":47===this.input[this.pointer+1]?(this.state="path or authority",++this.pointer):(this.url.cannotBeABaseURL=!0,this.url.path.push(""),this.state="cannot-be-a-base-URL path")}else{if(this.stateOverride)return this.parseError=!0,g;this.buffer="",this.state="no scheme",this.pointer=-1}return!0},B.prototype["parse no scheme"]=function(a){return null===this.base||this.base.cannotBeABaseURL&&35!==a?g:(this.base.cannotBeABaseURL&&35===a?(this.url.scheme=this.base.scheme,this.url.path=this.base.path.slice(),this.url.query=this.base.query,this.url.fragment="",this.url.cannotBeABaseURL=!0,this.state="fragment"):("file"===this.base.scheme?this.state="file":this.state="relative",--this.pointer),!0)},B.prototype["parse special relative or authority"]=function(a){return 47===a&&47===this.input[this.pointer+1]?(this.state="special authority ignore slashes",++this.pointer):(this.parseError=!0,this.state="relative",--this.pointer),!0},B.prototype["parse path or authority"]=function(a){return 47===a?this.state="authority":(this.state="path",--this.pointer),!0},B.prototype["parse relative"]=function(a){return this.url.scheme=this.base.scheme,isNaN(a)?(this.url.username=this.base.username,this.url.password=this.base.password,this.url.host=this.base.host,this.url.port=this.base.port,this.url.path=this.base.path.slice(),this.url.query=this.base.query):47===a?this.state="relative slash":63===a?(this.url.username=this.base.username,this.url.password=this.base.password,this.url.host=this.base.host,this.url.port=this.base.port,this.url.path=this.base.path.slice(),this.url.query="",this.state="query"):35===a?(this.url.username=this.base.username,this.url.password=this.base.password,this.url.host=this.base.host,this.url.port=this.base.port,this.url.path=this.base.path.slice(),this.url.query=this.base.query,this.url.fragment="",this.state="fragment"):p(this.url)&&92===a?(this.parseError=!0,this.state="relative slash"):(this.url.username=this.base.username,this.url.password=this.base.password,this.url.host=this.base.host,this.url.port=this.base.port,this.url.path=this.base.path.slice(0,this.base.path.length-1),this.state="path",--this.pointer),!0},B.prototype["parse relative slash"]=function(a){return p(this.url)&&(47===a||92===a)?(92===a&&(this.parseError=!0),this.state="special authority ignore slashes"):47===a?this.state="authority":(this.url.username=this.base.username,this.url.password=this.base.password,this.url.host=this.base.host,this.url.port=this.base.port,this.state="path",--this.pointer),!0},B.prototype["parse special authority slashes"]=function(a){return 47===a&&47===this.input[this.pointer+1]?(this.state="special authority ignore slashes",++this.pointer):(this.parseError=!0,this.state="special authority ignore slashes",--this.pointer),!0},B.prototype["parse special authority ignore slashes"]=function(a){return 47!==a&&92!==a?(this.state="authority",--this.pointer):this.parseError=!0,!0},B.prototype["parse authority"]=function(a,b){if(64===a){this.parseError=!0,this.atFlag&&(this.buffer="%40"+this.buffer),this.atFlag=!0;let a=h(this.buffer);for(let b=0;b<a;++b){let a=this.buffer.codePointAt(b);if(58===a&&!this.passwordTokenSeenFlag){this.passwordTokenSeenFlag=!0;continue}let c=w(a,v);this.passwordTokenSeenFlag?this.url.password+=c:this.url.username+=c}this.buffer=""}else if(isNaN(a)||47===a||63===a||35===a||p(this.url)&&92===a){if(this.atFlag&&""===this.buffer)return this.parseError=!0,g;this.pointer-=h(this.buffer)+1,this.buffer="",this.state="host"}else this.buffer+=b;return!0},B.prototype["parse hostname"]=B.prototype["parse host"]=function(a,b){if(this.stateOverride&&"file"===this.url.scheme)--this.pointer,this.state="file host";else if(58!==a||this.arrFlag)if(isNaN(a)||47===a||63===a||35===a||p(this.url)&&92===a){if(--this.pointer,p(this.url)&&""===this.buffer)return this.parseError=!0,g;if(this.stateOverride&&""===this.buffer&&(A(this.url)||null!==this.url.port))return this.parseError=!0,!1;let a=x(this.buffer,p(this.url));if(a===g)return g;if(this.url.host=a,this.buffer="",this.state="path start",this.stateOverride)return!1}else 91===a?this.arrFlag=!0:93===a&&(this.arrFlag=!1),this.buffer+=b;else{if(""===this.buffer)return this.parseError=!0,g;let a=x(this.buffer,p(this.url));if(a===g)return g;if(this.url.host=a,this.buffer="",this.state="port","hostname"===this.stateOverride)return!1}return!0},B.prototype["parse port"]=function(a,b){if(j(a))this.buffer+=b;else{if(!(isNaN(a)||47===a||63===a||35===a||p(this.url)&&92===a)&&!this.stateOverride)return this.parseError=!0,g;if(""!==this.buffer){let a=parseInt(this.buffer);if(a>65535)return this.parseError=!0,g;this.url.port=a===f[this.url.scheme]?null:a,this.buffer=""}if(this.stateOverride)return!1;this.state="path start",--this.pointer}return!0};let C=new Set([47,92,63,35]);B.prototype["parse file"]=function(a){if(this.url.scheme="file",47===a||92===a)92===a&&(this.parseError=!0),this.state="file slash";else if(null!==this.base&&"file"===this.base.scheme)if(isNaN(a))this.url.host=this.base.host,this.url.path=this.base.path.slice(),this.url.query=this.base.query;else if(63===a)this.url.host=this.base.host,this.url.path=this.base.path.slice(),this.url.query="",this.state="query";else if(35===a)this.url.host=this.base.host,this.url.path=this.base.path.slice(),this.url.query=this.base.query,this.url.fragment="",this.state="fragment";else{var b;this.input.length-this.pointer-1!=0&&(b=this.input[this.pointer+1],k(a)&&(58===b||124===b))&&(!(this.input.length-this.pointer-1>=2)||C.has(this.input[this.pointer+2]))?this.parseError=!0:(this.url.host=this.base.host,this.url.path=this.base.path.slice(),z(this.url)),this.state="path",--this.pointer}else this.state="path",--this.pointer;return!0},B.prototype["parse file slash"]=function(a){if(47===a||92===a)92===a&&(this.parseError=!0),this.state="file host";else{if(null!==this.base&&"file"===this.base.scheme){var b;2===(b=this.base.path[0]).length&&k(b.codePointAt(0))&&":"===b[1]?this.url.path.push(this.base.path[0]):this.url.host=this.base.host}this.state="path",--this.pointer}return!0},B.prototype["parse file host"]=function(a,b){if(isNaN(a)||47===a||92===a||63===a||35===a)if(--this.pointer,!this.stateOverride&&n(this.buffer))this.parseError=!0,this.state="path";else if(""===this.buffer){if(this.url.host="",this.stateOverride)return!1;this.state="path start"}else{let a=x(this.buffer,p(this.url));if(a===g)return g;if("localhost"===a&&(a=""),this.url.host=a,this.stateOverride)return!1;this.buffer="",this.state="path start"}else this.buffer+=b;return!0},B.prototype["parse path start"]=function(a){return p(this.url)?(92===a&&(this.parseError=!0),this.state="path",47!==a&&92!==a&&--this.pointer):this.stateOverride||63!==a?this.stateOverride||35!==a?void 0!==a&&(this.state="path",47!==a&&--this.pointer):(this.url.fragment="",this.state="fragment"):(this.url.query="",this.state="query"),!0},B.prototype["parse path"]=function(a){if(isNaN(a)||47===a||p(this.url)&&92===a||!this.stateOverride&&(63===a||35===a)){var b;if((p(this.url)&&92===a&&(this.parseError=!0),".."===(b=(b=this.buffer).toLowerCase())||"%2e."===b||".%2e"===b||"%2e%2e"===b)?(z(this.url),47===a||p(this.url)&&92===a||this.url.path.push("")):m(this.buffer)&&47!==a&&!(p(this.url)&&92===a)?this.url.path.push(""):m(this.buffer)||("file"===this.url.scheme&&0===this.url.path.length&&n(this.buffer)&&(""!==this.url.host&&null!==this.url.host&&(this.parseError=!0,this.url.host=""),this.buffer=this.buffer[0]+":"),this.url.path.push(this.buffer)),this.buffer="","file"===this.url.scheme&&(void 0===a||63===a||35===a))for(;this.url.path.length>1&&""===this.url.path[0];)this.parseError=!0,this.url.path.shift();63===a&&(this.url.query="",this.state="query"),35===a&&(this.url.fragment="",this.state="fragment")}else 37!==a||l(this.input[this.pointer+1])&&l(this.input[this.pointer+2])||(this.parseError=!0),this.buffer+=w(a,t);return!0},B.prototype["parse cannot-be-a-base-URL path"]=function(a){return 63===a?(this.url.query="",this.state="query"):35===a?(this.url.fragment="",this.state="fragment"):(isNaN(a)||37===a||(this.parseError=!0),37!==a||l(this.input[this.pointer+1])&&l(this.input[this.pointer+2])||(this.parseError=!0),isNaN(a)||(this.url.path[0]=this.url.path[0]+w(a,r))),!0},B.prototype["parse query"]=function(a,b){if(isNaN(a)||!this.stateOverride&&35===a){p(this.url)&&"ws"!==this.url.scheme&&"wss"!==this.url.scheme||(this.encodingOverride="utf-8");let b=new Buffer(this.buffer);for(let a=0;a<b.length;++a)b[a]<33||b[a]>126||34===b[a]||35===b[a]||60===b[a]||62===b[a]?this.url.query+=q(b[a]):this.url.query+=String.fromCodePoint(b[a]);this.buffer="",35===a&&(this.url.fragment="",this.state="fragment")}else 37!==a||l(this.input[this.pointer+1])&&l(this.input[this.pointer+2])||(this.parseError=!0),this.buffer+=b;return!0},B.prototype["parse fragment"]=function(a){return isNaN(a)||(0===a?this.parseError=!0:(37!==a||l(this.input[this.pointer+1])&&l(this.input[this.pointer+2])||(this.parseError=!0),this.url.fragment+=w(a,r))),!0},b.exports.serializeURL=function(a,b){let c=a.scheme+":";if(null!==a.host?(c+="//",(""!==a.username||""!==a.password)&&(c+=a.username,""!==a.password&&(c+=":"+a.password),c+="@"),c+=y(a.host),null!==a.port&&(c+=":"+a.port)):null===a.host&&"file"===a.scheme&&(c+="//"),a.cannotBeABaseURL)c+=a.path[0];else for(let b of a.path)c+="/"+b;return null!==a.query&&(c+="?"+a.query),b||null===a.fragment||(c+="#"+a.fragment),c},b.exports.serializeURLOrigin=function(a){switch(a.scheme){case"blob":try{return b.exports.serializeURLOrigin(b.exports.parseURL(a.path[0]))}catch(a){return"null"}case"ftp":case"gopher":case"http":case"https":case"ws":case"wss":var c;let d;return d=(c={scheme:a.scheme,host:a.host,port:a.port}).scheme+"://"+y(c.host),null!==c.port&&(d+=":"+c.port),d;case"file":return"file://";default:return"null"}},b.exports.basicURLParse=function(a,b){void 0===b&&(b={});let c=new B(a,b.baseURL,b.encodingOverride,b.url,b.stateOverride);return c.failure?"failure":c.url},b.exports.setTheUsername=function(a,b){a.username="";let c=d.ucs2.decode(b);for(let b=0;b<c.length;++b)a.username+=w(c[b],v)},b.exports.setThePassword=function(a,b){a.password="";let c=d.ucs2.decode(b);for(let b=0;b<c.length;++b)a.password+=w(c[b],v)},b.exports.serializeHost=y,b.exports.cannotHaveAUsernamePasswordPort=function(a){return null===a.host||""===a.host||a.cannotBeABaseURL||"file"===a.scheme},b.exports.serializeInteger=function(a){return String(a)},b.exports.parseURL=function(a,c){return void 0===c&&(c={}),b.exports.basicURLParse(a,{baseURL:c.baseURL,encodingOverride:c.encodingOverride})}},96983,(a,b,c)=>{"use strict";let d=a.r(16114);c.implementation=class{constructor(a){const b=a[0],c=a[1];let e=null;if(void 0!==c&&"failure"===(e=d.basicURLParse(c)))throw TypeError("Invalid base URL");const f=d.basicURLParse(b,{baseURL:e});if("failure"===f)throw TypeError("Invalid URL");this._url=f}get href(){return d.serializeURL(this._url)}set href(a){let b=d.basicURLParse(a);if("failure"===b)throw TypeError("Invalid URL");this._url=b}get origin(){return d.serializeURLOrigin(this._url)}get protocol(){return this._url.scheme+":"}set protocol(a){d.basicURLParse(a+":",{url:this._url,stateOverride:"scheme start"})}get username(){return this._url.username}set username(a){d.cannotHaveAUsernamePasswordPort(this._url)||d.setTheUsername(this._url,a)}get password(){return this._url.password}set password(a){d.cannotHaveAUsernamePasswordPort(this._url)||d.setThePassword(this._url,a)}get host(){let a=this._url;return null===a.host?"":null===a.port?d.serializeHost(a.host):d.serializeHost(a.host)+":"+d.serializeInteger(a.port)}set host(a){this._url.cannotBeABaseURL||d.basicURLParse(a,{url:this._url,stateOverride:"host"})}get hostname(){return null===this._url.host?"":d.serializeHost(this._url.host)}set hostname(a){this._url.cannotBeABaseURL||d.basicURLParse(a,{url:this._url,stateOverride:"hostname"})}get port(){return null===this._url.port?"":d.serializeInteger(this._url.port)}set port(a){d.cannotHaveAUsernamePasswordPort(this._url)||(""===a?this._url.port=null:d.basicURLParse(a,{url:this._url,stateOverride:"port"}))}get pathname(){return this._url.cannotBeABaseURL?this._url.path[0]:0===this._url.path.length?"":"/"+this._url.path.join("/")}set pathname(a){this._url.cannotBeABaseURL||(this._url.path=[],d.basicURLParse(a,{url:this._url,stateOverride:"path start"}))}get search(){return null===this._url.query||""===this._url.query?"":"?"+this._url.query}set search(a){let b=this._url;if(""===a){b.query=null;return}let c="?"===a[0]?a.substring(1):a;b.query="",d.basicURLParse(c,{url:b,stateOverride:"query"})}get hash(){return null===this._url.fragment||""===this._url.fragment?"":"#"+this._url.fragment}set hash(a){if(""===a){this._url.fragment=null;return}let b="#"===a[0]?a.substring(1):a;this._url.fragment="",d.basicURLParse(b,{url:this._url,stateOverride:"fragment"})}toJSON(){return this.href}}},60007,(a,b,c)=>{"use strict";let d=a.r(51933),e=a.r(39534),f=a.r(96983),g=e.implSymbol;function h(a){if(!this||this[g]||!(this instanceof h))throw TypeError("Failed to construct 'URL': Please use the 'new' operator, this DOM object constructor cannot be called as a function.");if(arguments.length<1)throw TypeError("Failed to construct 'URL': 1 argument required, but only "+arguments.length+" present.");let c=[];for(let a=0;a<arguments.length&&a<2;++a)c[a]=arguments[a];c[0]=d.USVString(c[0]),void 0!==c[1]&&(c[1]=d.USVString(c[1])),b.exports.setup(this,c)}h.prototype.toJSON=function(){if(!this||!b.exports.is(this))throw TypeError("Illegal invocation");let a=[];for(let b=0;b<arguments.length&&b<0;++b)a[b]=arguments[b];return this[g].toJSON.apply(this[g],a)},Object.defineProperty(h.prototype,"href",{get(){return this[g].href},set(a){a=d.USVString(a),this[g].href=a},enumerable:!0,configurable:!0}),h.prototype.toString=function(){if(!this||!b.exports.is(this))throw TypeError("Illegal invocation");return this.href},Object.defineProperty(h.prototype,"origin",{get(){return this[g].origin},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"protocol",{get(){return this[g].protocol},set(a){a=d.USVString(a),this[g].protocol=a},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"username",{get(){return this[g].username},set(a){a=d.USVString(a),this[g].username=a},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"password",{get(){return this[g].password},set(a){a=d.USVString(a),this[g].password=a},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"host",{get(){return this[g].host},set(a){a=d.USVString(a),this[g].host=a},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"hostname",{get(){return this[g].hostname},set(a){a=d.USVString(a),this[g].hostname=a},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"port",{get(){return this[g].port},set(a){a=d.USVString(a),this[g].port=a},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"pathname",{get(){return this[g].pathname},set(a){a=d.USVString(a),this[g].pathname=a},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"search",{get(){return this[g].search},set(a){a=d.USVString(a),this[g].search=a},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"hash",{get(){return this[g].hash},set(a){a=d.USVString(a),this[g].hash=a},enumerable:!0,configurable:!0}),b.exports={is:a=>!!a&&a[g]instanceof f.implementation,create(a,b){let c=Object.create(h.prototype);return this.setup(c,a,b),c},setup(a,b,c){c||(c={}),c.wrapper=a,a[g]=new f.implementation(b,c),a[g][e.wrapperSymbol]=a},interface:h,expose:{Window:{URL:h},Worker:{URL:h}}}},97884,(a,b,c)=>{"use strict";c.URL=a.r(60007).interface,c.serializeURL=a.r(16114).serializeURL,c.serializeURLOrigin=a.r(16114).serializeURLOrigin,c.basicURLParse=a.r(16114).basicURLParse,c.setTheUsername=a.r(16114).setTheUsername,c.setThePassword=a.r(16114).setThePassword,c.serializeHost=a.r(16114).serializeHost,c.serializeInteger=a.r(16114).serializeInteger,c.parseURL=a.r(16114).parseURL},98445,a=>{"use strict";let b;var c=a.i(88947),d=a.i(21517),e=a.i(92509),f=a.i(97884),g=a.i(24836),h=a.i(6461);let i=c.default.Readable,j=Symbol("buffer"),k=Symbol("type");class l{constructor(){this[k]="";const a=arguments[0],b=arguments[1],c=[];if(a){const b=Number(a.length);for(let d=0;d<b;d++){let b;const e=a[d];(b=e instanceof Buffer?e:ArrayBuffer.isView(e)?Buffer.from(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?Buffer.from(e):e instanceof l?e[j]:Buffer.from("string"==typeof e?e:String(e))).length,c.push(b)}}this[j]=Buffer.concat(c);let d=b&&void 0!==b.type&&String(b.type).toLowerCase();d&&!/[^\u0020-\u007E]/.test(d)&&(this[k]=d)}get size(){return this[j].length}get type(){return this[k]}text(){return Promise.resolve(this[j].toString())}arrayBuffer(){let a=this[j];return Promise.resolve(a.buffer.slice(a.byteOffset,a.byteOffset+a.byteLength))}stream(){let a=new i;return a._read=function(){},a.push(this[j]),a.push(null),a}toString(){return"[object Blob]"}slice(){let a,b=this.size,c=arguments[0],d=arguments[1];a=void 0===c?0:c<0?Math.max(b+c,0):Math.min(c,b);let e=Math.max((void 0===d?b:d<0?Math.max(b+d,0):Math.min(d,b))-a,0),f=this[j].slice(a,a+e),g=new l([],{type:arguments[2]});return g[j]=f,g}}function m(a,b,c){Error.call(this,a),this.message=a,this.type=b,c&&(this.code=this.errno=c.code),Error.captureStackTrace(this,this.constructor)}Object.defineProperties(l.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}}),Object.defineProperty(l.prototype,Symbol.toStringTag,{value:"Blob",writable:!1,enumerable:!1,configurable:!0}),m.prototype=Object.create(Error.prototype),m.prototype.constructor=m,m.prototype.name="FetchError";try{b=(()=>{let a=Error("Cannot find module 'encoding'");throw a.code="MODULE_NOT_FOUND",a})().convert}catch(a){}let n=Symbol("Body internals"),o=c.default.PassThrough;function p(a){var b=this,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=d.size,f=d.timeout;null==a?a=null:r(a)?a=Buffer.from(a.toString()):s(a)||Buffer.isBuffer(a)||("[object ArrayBuffer]"===Object.prototype.toString.call(a)?a=Buffer.from(a):ArrayBuffer.isView(a)?a=Buffer.from(a.buffer,a.byteOffset,a.byteLength):a instanceof c.default||(a=Buffer.from(String(a)))),this[n]={body:a,disturbed:!1,error:null},this.size=void 0===e?0:e,this.timeout=void 0===f?0:f,a instanceof c.default&&a.on("error",function(a){let c="AbortError"===a.name?a:new m(`Invalid response body while trying to fetch ${b.url}: ${a.message}`,"system",a);b[n].error=c})}function q(){var a=this;if(this[n].disturbed)return p.Promise.reject(TypeError(`body used already for: ${this.url}`));if(this[n].disturbed=!0,this[n].error)return p.Promise.reject(this[n].error);let b=this.body;if(null===b)return p.Promise.resolve(Buffer.alloc(0));if(s(b)&&(b=b.stream()),Buffer.isBuffer(b))return p.Promise.resolve(b);if(!(b instanceof c.default))return p.Promise.resolve(Buffer.alloc(0));let d=[],e=0,f=!1;return new p.Promise(function(c,g){let h;a.timeout&&(h=setTimeout(function(){f=!0,g(new m(`Response timeout while trying to fetch ${a.url} (over ${a.timeout}ms)`,"body-timeout"))},a.timeout)),b.on("error",function(b){"AbortError"===b.name?(f=!0,g(b)):g(new m(`Invalid response body while trying to fetch ${a.url}: ${b.message}`,"system",b))}),b.on("data",function(b){if(!f&&null!==b){if(a.size&&e+b.length>a.size){f=!0,g(new m(`content size at ${a.url} over limit: ${a.size}`,"max-size"));return}e+=b.length,d.push(b)}}),b.on("end",function(){if(!f){clearTimeout(h);try{c(Buffer.concat(d,e))}catch(b){g(new m(`Could not create Buffer from response body for ${a.url}: ${b.message}`,"system",b))}}})})}function r(a){return"object"==typeof a&&"function"==typeof a.append&&"function"==typeof a.delete&&"function"==typeof a.get&&"function"==typeof a.getAll&&"function"==typeof a.has&&"function"==typeof a.set&&("URLSearchParams"===a.constructor.name||"[object URLSearchParams]"===Object.prototype.toString.call(a)||"function"==typeof a.sort)}function s(a){return"object"==typeof a&&"function"==typeof a.arrayBuffer&&"string"==typeof a.type&&"function"==typeof a.stream&&"function"==typeof a.constructor&&"string"==typeof a.constructor.name&&/^(Blob|File)$/.test(a.constructor.name)&&/^(Blob|File)$/.test(a[Symbol.toStringTag])}function t(a){let b,d,e=a.body;if(a.bodyUsed)throw Error("cannot clone body after it is used");return e instanceof c.default&&"function"!=typeof e.getBoundary&&(b=new o,d=new o,e.pipe(b),e.pipe(d),a[n].body=b,e=d),e}function u(a){if(null===a)return null;if("string"==typeof a)return"text/plain;charset=UTF-8";if(r(a))return"application/x-www-form-urlencoded;charset=UTF-8";if(s(a))return a.type||null;if(Buffer.isBuffer(a))return null;else if("[object ArrayBuffer]"===Object.prototype.toString.call(a))return null;else if(ArrayBuffer.isView(a))return null;else if("function"==typeof a.getBoundary)return`multipart/form-data;boundary=${a.getBoundary()}`;else if(a instanceof c.default)return null;else return"text/plain;charset=UTF-8"}function v(a){let b=a.body;return null===b?0:s(b)?b.size:Buffer.isBuffer(b)?b.length:b&&"function"==typeof b.getLengthSync?b._lengthRetrievers&&0==b._lengthRetrievers.length||b.hasKnownLength&&b.hasKnownLength()?b.getLengthSync():null:null}p.prototype={get body(){return this[n].body},get bodyUsed(){return this[n].disturbed},arrayBuffer(){return q.call(this).then(function(a){return a.buffer.slice(a.byteOffset,a.byteOffset+a.byteLength)})},blob(){let a=this.headers&&this.headers.get("content-type")||"";return q.call(this).then(function(b){return Object.assign(new l([],{type:a.toLowerCase()}),{[j]:b})})},json(){var a=this;return q.call(this).then(function(b){try{return JSON.parse(b.toString())}catch(b){return p.Promise.reject(new m(`invalid json response body at ${a.url} reason: ${b.message}`,"invalid-json"))}})},text(){return q.call(this).then(function(a){return a.toString()})},buffer(){return q.call(this)},textConverted(){var a=this;return q.call(this).then(function(c){return function(a,c){let d,e;if("function"!=typeof b)throw Error("The package `encoding` must be installed to use the textConverted() function");let f=c.get("content-type"),g="utf-8";return f&&(d=/charset=([^;]*)/i.exec(f)),e=a.slice(0,1024).toString(),!d&&e&&(d=/<meta.+?charset=(['"])(.+?)\1/i.exec(e)),!d&&e&&(!(d=/<meta[\s]+?http-equiv=(['"])content-type\1[\s]+?content=(['"])(.+?)\2/i.exec(e))&&(d=/<meta[\s]+?content=(['"])(.+?)\1[\s]+?http-equiv=(['"])content-type\3/i.exec(e))&&d.pop(),d&&(d=/charset=(.*)/i.exec(d.pop()))),!d&&e&&(d=/<\?xml.+?encoding=(['"])(.+?)\1/i.exec(e)),d&&("gb2312"===(g=d.pop())||"gbk"===g)&&(g="gb18030"),b(a,"UTF-8",g).toString()}(c,a.headers)})}},Object.defineProperties(p.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}}),p.mixIn=function(a){for(let b of Object.getOwnPropertyNames(p.prototype))if(!(b in a)){let c=Object.getOwnPropertyDescriptor(p.prototype,b);Object.defineProperty(a,b,c)}},p.Promise=a.g.Promise;let w=/[^\^_`a-zA-Z\-0-9!#$%&'*+.|~]/,x=/[^\t\x20-\x7e\x80-\xff]/;function y(a){if(a=`${a}`,w.test(a)||""===a)throw TypeError(`${a} is not a legal HTTP header name`)}function z(a){if(a=`${a}`,x.test(a))throw TypeError(`${a} is not a legal HTTP header value`)}function A(a,b){for(let c in b=b.toLowerCase(),a)if(c.toLowerCase()===b)return c}let B=Symbol("map");class C{constructor(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(this[B]=Object.create(null),a instanceof C){const b=a.raw();for(const a of Object.keys(b))for(const c of b[a])this.append(a,c);return}if(null==a);else if("object"==typeof a){const b=a[Symbol.iterator];if(null!=b){if("function"!=typeof b)throw TypeError("Header pairs must be iterable");const c=[];for(const b of a){if("object"!=typeof b||"function"!=typeof b[Symbol.iterator])throw TypeError("Each header pair must be iterable");c.push(Array.from(b))}for(const a of c){if(2!==a.length)throw TypeError("Each header pair must be a name/value tuple");this.append(a[0],a[1])}}else for(const b of Object.keys(a)){const c=a[b];this.append(b,c)}}else throw TypeError("Provided initializer must be an object")}get(a){y(a=`${a}`);let b=A(this[B],a);return void 0===b?null:this[B][b].join(", ")}forEach(a){let b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,c=D(this),d=0;for(;d<c.length;){var e=c[d];let f=e[0],g=e[1];a.call(b,g,f,this),c=D(this),d++}}set(a,b){a=`${a}`,b=`${b}`,y(a),z(b);let c=A(this[B],a);this[B][void 0!==c?c:a]=[b]}append(a,b){a=`${a}`,b=`${b}`,y(a),z(b);let c=A(this[B],a);void 0!==c?this[B][c].push(b):this[B][a]=[b]}has(a){return y(a=`${a}`),void 0!==A(this[B],a)}delete(a){y(a=`${a}`);let b=A(this[B],a);void 0!==b&&delete this[B][b]}raw(){return this[B]}keys(){return F(this,"key")}values(){return F(this,"value")}[Symbol.iterator](){return F(this,"key+value")}}function D(a){let b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"key+value";return Object.keys(a[B]).sort().map("key"===b?function(a){return a.toLowerCase()}:"value"===b?function(b){return a[B][b].join(", ")}:function(b){return[b.toLowerCase(),a[B][b].join(", ")]})}C.prototype.entries=C.prototype[Symbol.iterator],Object.defineProperty(C.prototype,Symbol.toStringTag,{value:"Headers",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(C.prototype,{get:{enumerable:!0},forEach:{enumerable:!0},set:{enumerable:!0},append:{enumerable:!0},has:{enumerable:!0},delete:{enumerable:!0},keys:{enumerable:!0},values:{enumerable:!0},entries:{enumerable:!0}});let E=Symbol("internal");function F(a,b){let c=Object.create(G);return c[E]={target:a,kind:b,index:0},c}let G=Object.setPrototypeOf({next(){if(!this||Object.getPrototypeOf(this)!==G)throw TypeError("Value of `this` is not a HeadersIterator");var a=this[E];let b=a.target,c=a.kind,d=a.index,e=D(b,c);return d>=e.length?{value:void 0,done:!0}:(this[E].index=d+1,{value:e[d],done:!1})}},Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));Object.defineProperty(G,Symbol.toStringTag,{value:"HeadersIterator",writable:!1,enumerable:!1,configurable:!0});let H=Symbol("Response internals"),I=d.default.STATUS_CODES;class J{constructor(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};p.call(this,a,b);const c=b.status||200,d=new C(b.headers);if(null!=a&&!d.has("Content-Type")){const b=u(a);b&&d.append("Content-Type",b)}this[H]={url:b.url,status:c,statusText:b.statusText||I[c],headers:d,counter:b.counter}}get url(){return this[H].url||""}get status(){return this[H].status}get ok(){return this[H].status>=200&&this[H].status<300}get redirected(){return this[H].counter>0}get statusText(){return this[H].statusText}get headers(){return this[H].headers}clone(){return new J(t(this),{url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected})}}p.mixIn(J.prototype),Object.defineProperties(J.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}}),Object.defineProperty(J.prototype,Symbol.toStringTag,{value:"Response",writable:!1,enumerable:!1,configurable:!0});let K=Symbol("Request internals"),L=e.default.URL||f.default.URL,M=e.default.parse,N=e.default.format;function O(a){return/^[a-zA-Z][a-zA-Z\d+\-.]*:/.exec(a)&&(a=new L(a).toString()),M(a)}let P="destroy"in c.default.Readable.prototype;function Q(a){return"object"==typeof a&&"object"==typeof a[K]}class R{constructor(a){let b,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Q(a)?b=O(a.url):(b=a&&a.href?O(a.href):O(`${a}`),a={});let d=c.method||a.method||"GET";if(d=d.toUpperCase(),(null!=c.body||Q(a)&&null!==a.body)&&("GET"===d||"HEAD"===d))throw TypeError("Request with GET/HEAD method cannot have body");let e=null!=c.body?c.body:Q(a)&&null!==a.body?t(a):null;p.call(this,e,{timeout:c.timeout||a.timeout||0,size:c.size||a.size||0});const f=new C(c.headers||a.headers||{});if(null!=e&&!f.has("Content-Type")){const a=u(e);a&&f.append("Content-Type",a)}let g=Q(a)?a.signal:null;if("signal"in c&&(g=c.signal),null!=g&&!function(a){let b=a&&"object"==typeof a&&Object.getPrototypeOf(a);return!!(b&&"AbortSignal"===b.constructor.name)}(g))throw TypeError("Expected signal to be an instanceof AbortSignal");this[K]={method:d,redirect:c.redirect||a.redirect||"follow",headers:f,parsedURL:b,signal:g},this.follow=void 0!==c.follow?c.follow:void 0!==a.follow?a.follow:20,this.compress=void 0!==c.compress?c.compress:void 0===a.compress||a.compress,this.counter=c.counter||a.counter||0,this.agent=c.agent||a.agent}get method(){return this[K].method}get url(){return N(this[K].parsedURL)}get headers(){return this[K].headers}get redirect(){return this[K].redirect}get signal(){return this[K].signal}clone(){return new R(this)}}function S(a){Error.call(this,a),this.type="aborted",this.message=a,Error.captureStackTrace(this,this.constructor)}p.mixIn(R.prototype),Object.defineProperty(R.prototype,Symbol.toStringTag,{value:"Request",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(R.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}}),S.prototype=Object.create(Error.prototype),S.prototype.constructor=S,S.prototype.name="AbortError";let T=e.default.URL||f.default.URL,U=c.default.PassThrough,V=function(a,b){let c=new T(b).hostname,d=new T(a).hostname;return c===d||"."===c[c.length-d.length-1]&&c.endsWith(d)};function W(a,b){if(!W.Promise)throw Error("native promise missing, set fetch.Promise to your favorite alternative");return p.Promise=W.Promise,new W.Promise(function(e,f){var i,j;let k,l,n,o=new R(a,b),p=function(a){let b,d,e=a[K].parsedURL,f=new C(a[K].headers);if(f.has("Accept")||f.set("Accept","*/*"),!e.protocol||!e.hostname)throw TypeError("Only absolute URLs are supported");if(!/^https?:$/.test(e.protocol))throw TypeError("Only HTTP(S) protocols are supported");if(a.signal&&a.body instanceof c.default.Readable&&!P)throw Error("Cancellation of streamed requests with AbortSignal is not supported in node < 8");let g=null;if(null==a.body&&/^(POST|PUT)$/i.test(a.method)&&(g="0"),null!=a.body){let b=v(a);"number"==typeof b&&(g=String(b))}g&&f.set("Content-Length",g),f.has("User-Agent")||f.set("User-Agent","node-fetch/1.0 (+https://github.com/bitinn/node-fetch)"),a.compress&&!f.has("Accept-Encoding")&&f.set("Accept-Encoding","gzip,deflate");let h=a.agent;return"function"==typeof h&&(h=h(e)),Object.assign({},e,{method:a.method,headers:(b=Object.assign({__proto__:null},f[B]),void 0!==(d=A(f[B],"Host"))&&(b[d]=b[d][0]),b),agent:h})}(o),q=("https:"===p.protocol?g.default:d.default).request,r=o.signal,t=null,u=function(){let a=new S("The user aborted a request.");f(a),o.body&&o.body instanceof c.default.Readable&&X(o.body,a),t&&t.body&&t.body.emit("error",a)};if(r&&r.aborted)return void u();let y=function(){u(),D()},z=q(p);function D(){z.abort(),r&&r.removeEventListener("abort",y),clearTimeout(l)}r&&r.addEventListener("abort",y),o.timeout&&z.once("socket",function(a){l=setTimeout(function(){f(new m(`network timeout at: ${o.url}`,"request-timeout")),D()},o.timeout)}),z.on("error",function(a){f(new m(`request to ${o.url} failed, reason: ${a.message}`,"system",a)),t&&t.body&&X(t.body,a),D()}),i=z,j=function(a){(!r||!r.aborted)&&t&&t.body&&X(t.body,a)},i.on("socket",function(a){k=a}),i.on("response",function(a){let b=a.headers;"chunked"!==b["transfer-encoding"]||b["content-length"]||a.once("close",function(a){if(k&&k.listenerCount("data")>0&&!a){let a=Error("Premature close");a.code="ERR_STREAM_PREMATURE_CLOSE",j(a)}})}),14>parseInt(process.version.substring(1))&&z.on("socket",function(a){a.addListener("close",function(b){let c=a.listenerCount("data")>0;if(t&&c&&!b&&!(r&&r.aborted)){let a=Error("Premature close");a.code="ERR_STREAM_PREMATURE_CLOSE",t.body.emit("error",a)}})}),z.on("response",function(a){clearTimeout(l);let b=function(a){let b=new C;for(let c of Object.keys(a))if(!w.test(c))if(Array.isArray(a[c]))for(let d of a[c])x.test(d)||(void 0===b[B][c]?b[B][c]=[d]:b[B][c].push(d));else x.test(a[c])||(b[B][c]=[a[c]]);return b}(a.headers);if(W.isRedirect(a.statusCode)){let d=b.get("Location"),g=null;try{g=null===d?null:new T(d,o.url).toString()}catch(a){if("manual"!==o.redirect){f(new m(`uri requested responds with an invalid redirect URL: ${d}`,"invalid-redirect")),D();return}}switch(o.redirect){case"error":f(new m(`uri requested responds with a redirect, redirect mode is set to error: ${o.url}`,"no-redirect")),D();return;case"manual":if(null!==g)try{b.set("Location",g)}catch(a){f(a)}break;case"follow":var c;if(null===g)break;if(o.counter>=o.follow){f(new m(`maximum redirect reached at: ${o.url}`,"max-redirect")),D();return}let h={headers:new C(o.headers),follow:o.follow,counter:o.counter+1,agent:o.agent,compress:o.compress,method:o.method,body:o.body,signal:o.signal,timeout:o.timeout,size:o.size};if(!V(o.url,g)||(c=o.url,new T(g).protocol!==new T(c).protocol))for(let a of["authorization","www-authenticate","cookie","cookie2"])h.headers.delete(a);if(303!==a.statusCode&&o.body&&null===v(o)){f(new m("Cannot follow redirect with body being a readable stream","unsupported-redirect")),D();return}(303===a.statusCode||(301===a.statusCode||302===a.statusCode)&&"POST"===o.method)&&(h.method="GET",h.body=void 0,h.headers.delete("content-length")),e(W(new R(g,h))),D();return}}a.once("end",function(){r&&r.removeEventListener("abort",y)});let d=a.pipe(new U),g={url:o.url,status:a.statusCode,statusText:a.statusMessage,headers:b,size:o.size,timeout:o.timeout,counter:o.counter},i=b.get("Content-Encoding");if(!o.compress||"HEAD"===o.method||null===i||204===a.statusCode||304===a.statusCode)return void e(t=new J(d,g));let j={flush:h.default.Z_SYNC_FLUSH,finishFlush:h.default.Z_SYNC_FLUSH};if("gzip"==i||"x-gzip"==i)return void e(t=new J(d=d.pipe(h.default.createGunzip(j)),g));if("deflate"==i||"x-deflate"==i){let b=a.pipe(new U);b.once("data",function(a){e(t=new J(d=(15&a[0])==8?d.pipe(h.default.createInflate()):d.pipe(h.default.createInflateRaw()),g))}),b.on("end",function(){t||e(t=new J(d,g))});return}"br"==i&&"function"==typeof h.default.createBrotliDecompress?e(t=new J(d=d.pipe(h.default.createBrotliDecompress()),g)):e(t=new J(d,g))}),null===(n=o.body)?z.end():s(n)?n.stream().pipe(z):Buffer.isBuffer(n)?(z.write(n),z.end()):n.pipe(z)})}function X(a,b){a.destroy?a.destroy(b):(a.emit("error",b),a.end())}W.isRedirect=function(a){return 301===a||302===a||303===a||307===a||308===a},W.Promise=a.g.Promise,a.s(["AbortError",()=>S,"FetchError",()=>m,"Headers",()=>C,"Request",()=>R,"Response",()=>J,"default",0,W])},4385,(a,b,c)=>{"use strict";let d=a=>null!==a&&"object"==typeof a&&"function"==typeof a.pipe;d.writable=a=>d(a)&&!1!==a.writable&&"function"==typeof a._write&&"object"==typeof a._writableState,d.readable=a=>d(a)&&!1!==a.readable&&"function"==typeof a._read&&"object"==typeof a._readableState,d.duplex=a=>d.writable(a)&&d.readable(a),d.transform=a=>d.duplex(a)&&"function"==typeof a._transform,b.exports=d},94107,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.pkg=void 0,c.pkg=a.r(451)},33985,(a,b,c)=>{"use strict";var d,e=a.e&&a.e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(c,"__esModule",{value:!0}),c.GaxiosError=c.GAXIOS_ERROR_SYMBOL=void 0,c.defaultErrorRedactor=function a(b){let c="<<REDACTED> - See `errorRedactor` option in `gaxios` for configuration>.";function d(a){if(a)for(let b of Object.keys(a))/^authentication$/i.test(b)&&(a[b]=c),/^authorization$/i.test(b)&&(a[b]=c),/secret/i.test(b)&&(a[b]=c)}function e(a,b){if("object"==typeof a&&null!==a&&"string"==typeof a[b]){let d=a[b];(/grant_type=/i.test(d)||/assertion=/i.test(d)||/secret/i.test(d))&&(a[b]=c)}}function g(a){"object"==typeof a&&null!==a&&("grant_type"in a&&(a.grant_type=c),"assertion"in a&&(a.assertion=c),"client_secret"in a&&(a.client_secret=c))}if(b.config){d(b.config.headers),e(b.config,"data"),g(b.config.data),e(b.config,"body"),g(b.config.body);try{let a=new f.URL("",b.config.url);a.searchParams.has("token")&&a.searchParams.set("token",c),a.searchParams.has("client_secret")&&a.searchParams.set("client_secret",c),b.config.url=a.toString()}catch(a){}}return b.response&&(a({config:b.response.config}),d(b.response.headers),e(b.response,"data"),g(b.response.data)),b};let f=a.r(92509),g=a.r(94107),h=e(a.r(79398));c.GAXIOS_ERROR_SYMBOL=Symbol.for(`${g.pkg.name}-gaxios-error`);class i extends Error{static[(d=c.GAXIOS_ERROR_SYMBOL,Symbol.hasInstance)](a){return!!a&&"object"==typeof a&&c.GAXIOS_ERROR_SYMBOL in a&&a[c.GAXIOS_ERROR_SYMBOL]===g.pkg.version||Function.prototype[Symbol.hasInstance].call(i,a)}constructor(a,b,c,e){var f;if(super(a),this.config=b,this.response=c,this.error=e,this[d]=g.pkg.version,this.config=(0,h.default)(!0,{},b),this.response&&(this.response.config=(0,h.default)(!0,{},this.response.config)),this.response){try{this.response.data=function(a,b){switch(a){case"stream":default:return b;case"json":return JSON.parse(JSON.stringify(b));case"arraybuffer":return JSON.parse(Buffer.from(b).toString("utf8"));case"blob":return JSON.parse(b.text())}}(this.config.responseType,null==(f=this.response)?void 0:f.data)}catch(a){}this.status=this.response.status}e&&"code"in e&&e.code&&(this.code=e.code),b.errorRedactor&&b.errorRedactor({config:this.config,response:this.response})}}c.GaxiosError=i},94706,(a,b,c)=>{"use strict";async function d(a){var b,c;let d=f(a);if(!a||!a.config||!d&&!a.config.retry)return{shouldRetry:!1};(d=d||{}).currentRetryAttempt=d.currentRetryAttempt||0,d.retry=void 0===d.retry||null===d.retry?3:d.retry,d.httpMethodsToRetry=d.httpMethodsToRetry||["GET","HEAD","PUT","OPTIONS","DELETE"],d.noResponseRetries=void 0===d.noResponseRetries||null===d.noResponseRetries?2:d.noResponseRetries,d.retryDelayMultiplier=d.retryDelayMultiplier?d.retryDelayMultiplier:2,d.timeOfFirstRequest=d.timeOfFirstRequest?d.timeOfFirstRequest:Date.now(),d.totalTimeout=d.totalTimeout?d.totalTimeout:Number.MAX_SAFE_INTEGER,d.maxRetryDelay=d.maxRetryDelay?d.maxRetryDelay:Number.MAX_SAFE_INTEGER,d.statusCodesToRetry=d.statusCodesToRetry||[[100,199],[408,408],[429,429],[500,599]],a.config.retryConfig=d;let g=d.shouldRetry||e;if(!await g(a))return{shouldRetry:!1,config:a.config};let h=Math.min(((b=d).currentRetryAttempt?0:null!=(c=b.retryDelay)?c:100)+(Math.pow(b.retryDelayMultiplier,b.currentRetryAttempt)-1)/2*1e3,b.totalTimeout-(Date.now()-b.timeOfFirstRequest),b.maxRetryDelay);a.config.retryConfig.currentRetryAttempt+=1;let i=d.retryBackoff?d.retryBackoff(a,h):new Promise(a=>{setTimeout(a,h)});return d.onRetryAttempt&&d.onRetryAttempt(a),await i,{shouldRetry:!0,config:a.config}}function e(a){var b;let c=f(a);if("AbortError"===a.name||(null==(b=a.error)?void 0:b.name)==="AbortError"||!c||0===c.retry||!a.response&&(c.currentRetryAttempt||0)>=c.noResponseRetries||!a.config.method||0>c.httpMethodsToRetry.indexOf(a.config.method.toUpperCase()))return!1;if(a.response&&a.response.status){let b=!1;for(let[d,e]of c.statusCodesToRetry){let c=a.response.status;if(c>=d&&c<=e){b=!0;break}}if(!b)return!1}return c.currentRetryAttempt=c.currentRetryAttempt||0,!(c.currentRetryAttempt>=c.retry)}function f(a){if(a&&a.config&&a.config.retryConfig)return a.config.retryConfig}Object.defineProperty(c,"__esModule",{value:!0}),c.getRetryConfig=d},44481,a=>{"use strict";let b,c;a.s([],34883),a.i(34883);var d=a.i(54799);let e=new Uint8Array(256),f=e.length;function g(){return f>e.length-16&&(d.default.randomFillSync(e),f=0),e.slice(f,f+=16)}let h=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,i=function(a){return"string"==typeof a&&h.test(a)},j=[];for(let a=0;a<256;++a)j.push((a+256).toString(16).slice(1));function k(a,b=0){return j[a[b+0]]+j[a[b+1]]+j[a[b+2]]+j[a[b+3]]+"-"+j[a[b+4]]+j[a[b+5]]+"-"+j[a[b+6]]+j[a[b+7]]+"-"+j[a[b+8]]+j[a[b+9]]+"-"+j[a[b+10]]+j[a[b+11]]+j[a[b+12]]+j[a[b+13]]+j[a[b+14]]+j[a[b+15]]}let l=0,m=0,n=function(a){let b;if(!i(a))throw TypeError("Invalid UUID");let c=new Uint8Array(16);return c[0]=(b=parseInt(a.slice(0,8),16))>>>24,c[1]=b>>>16&255,c[2]=b>>>8&255,c[3]=255&b,c[4]=(b=parseInt(a.slice(9,13),16))>>>8,c[5]=255&b,c[6]=(b=parseInt(a.slice(14,18),16))>>>8,c[7]=255&b,c[8]=(b=parseInt(a.slice(19,23),16))>>>8,c[9]=255&b,c[10]=(b=parseInt(a.slice(24,36),16))/0x10000000000&255,c[11]=b/0x100000000&255,c[12]=b>>>24&255,c[13]=b>>>16&255,c[14]=b>>>8&255,c[15]=255&b,c};function o(a,b,c){function d(a,d,e,f){var g;if("string"==typeof a&&(a=function(a){a=unescape(encodeURIComponent(a));let b=[];for(let c=0;c<a.length;++c)b.push(a.charCodeAt(c));return b}(a)),"string"==typeof d&&(d=n(d)),(null==(g=d)?void 0:g.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let h=new Uint8Array(16+a.length);if(h.set(d),h.set(a,d.length),(h=c(h))[6]=15&h[6]|b,h[8]=63&h[8]|128,e){f=f||0;for(let a=0;a<16;++a)e[f+a]=h[a];return e}return k(h)}try{d.name=a}catch(a){}return d.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",d.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",d}let p=o("v3",48,function(a){return Array.isArray(a)?a=Buffer.from(a):"string"==typeof a&&(a=Buffer.from(a,"utf8")),d.default.createHash("md5").update(a).digest()}),q={randomUUID:d.default.randomUUID},r=o("v5",80,function(a){return Array.isArray(a)?a=Buffer.from(a):"string"==typeof a&&(a=Buffer.from(a,"utf8")),d.default.createHash("sha1").update(a).digest()});a.s(["NIL",0,"00000000-0000-0000-0000-000000000000","parse",0,n,"stringify",0,function(a,b=0){let c=k(a,b);if(!i(c))throw TypeError("Stringified UUID is invalid");return c},"v1",0,function(a,d,e){let f=d&&e||0,h=d||Array(16),i=(a=a||{}).node||b,j=void 0!==a.clockseq?a.clockseq:c;if(null==i||null==j){let d=a.random||(a.rng||g)();null==i&&(i=b=[1|d[0],d[1],d[2],d[3],d[4],d[5]]),null==j&&(j=c=(d[6]<<8|d[7])&16383)}let n=void 0!==a.msecs?a.msecs:Date.now(),o=void 0!==a.nsecs?a.nsecs:m+1,p=n-l+(o-m)/1e4;if(p<0&&void 0===a.clockseq&&(j=j+1&16383),(p<0||n>l)&&void 0===a.nsecs&&(o=0),o>=1e4)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");l=n,m=o,c=j;let q=((0xfffffff&(n+=122192928e5))*1e4+o)%0x100000000;h[f++]=q>>>24&255,h[f++]=q>>>16&255,h[f++]=q>>>8&255,h[f++]=255&q;let r=n/0x100000000*1e4&0xfffffff;h[f++]=r>>>8&255,h[f++]=255&r,h[f++]=r>>>24&15|16,h[f++]=r>>>16&255,h[f++]=j>>>8|128,h[f++]=255&j;for(let a=0;a<6;++a)h[f+a]=i[a];return d||k(h)},"v3",0,p,"v4",0,function(a,b,c){if(q.randomUUID&&!b&&!a)return q.randomUUID();let d=(a=a||{}).random||(a.rng||g)();if(d[6]=15&d[6]|64,d[8]=63&d[8]|128,b){c=c||0;for(let a=0;a<16;++a)b[c+a]=d[a];return b}return k(d)},"v5",0,r,"validate",0,i,"version",0,function(a){if(!i(a))throw TypeError("Invalid UUID");return parseInt(a.slice(14,15),16)}],44481)},2458,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.GaxiosInterceptorManager=void 0;class d extends Set{}c.GaxiosInterceptorManager=d},41610,(a,b,c)=>{"use strict";var d,e,f,g,h,i,j,k=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),l=a.e&&a.e.__setModuleDefault||(Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:!0,value:b})}:function(a,b){a.default=b}),m=a.e&&a.e.__importStar||function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)"default"!==c&&Object.prototype.hasOwnProperty.call(a,c)&&k(b,a,c);return l(b,a),b},n=a.e&&a.e.__classPrivateFieldGet||function(a,b,c,d){if("a"===c&&!d)throw TypeError("Private accessor was defined without a getter");if("function"==typeof b?a!==b||!d:!b.has(a))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===c?d:"a"===c?d.call(a):d?d.value:b.get(a)},o=a.e&&a.e.__classPrivateFieldSet||function(a,b,c,d,e){if("m"===d)throw TypeError("Private method is not writable");if("a"===d&&!e)throw TypeError("Private accessor was defined without a setter");if("function"==typeof b?a!==b||!e:!b.has(a))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===d?e.call(a,c):e?e.value=c:b.set(a,c),c},p=a.e&&a.e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(c,"__esModule",{value:!0}),c.Gaxios=void 0;let q=p(a.r(79398)),r=a.r(24836),s=p(a.r(98445)),t=p(a.r(45706)),u=p(a.r(4385)),v=a.r(92509),w=a.r(33985),x=a.r(94706),y=a.r(88947),z=a.r(44481),A=a.r(2458),B=(0,s.default);function C(a,b){for(let c of(b=b.toLowerCase(),Object.keys((null==a?void 0:a.headers)||{})))if(b===c.toLowerCase())return a.headers[c]}class D{constructor(a){d.add(this),this.agentCache=new Map,this.defaults=a||{},this.interceptors={request:new A.GaxiosInterceptorManager,response:new A.GaxiosInterceptorManager}}async request(a={}){return a=await n(this,d,"m",h).call(this,a),a=await n(this,d,"m",f).call(this,a),n(this,d,"m",g).call(this,this._request(a))}async _defaultAdapter(a){let b=a.fetchImplementation||B,c=await b(a.url,a),d=await this.getResponseData(a,c);return this.translateResponse(a,c,d)}async _request(a={}){var b;try{let b;if(b=a.adapter?await a.adapter(a,this._defaultAdapter.bind(this)):await this._defaultAdapter(a),!a.validateStatus(b.status)){if("stream"===a.responseType){let a="";await new Promise(c=>{(null==b?void 0:b.data).on("data",b=>{a+=b}),(null==b?void 0:b.data).on("end",c)}),b.data=a}throw new w.GaxiosError(`Request failed with status code ${b.status}`,a,b)}return b}catch(f){let c=f instanceof w.GaxiosError?f:new w.GaxiosError(f.message,a,void 0,f),{shouldRetry:d,config:e}=await (0,x.getRetryConfig)(c);if(d&&e)return c.config.retryConfig.currentRetryAttempt=e.retryConfig.currentRetryAttempt,a.retryConfig=null==(b=c.config)?void 0:b.retryConfig,this._request(a);throw c}}async getResponseData(a,b){switch(a.responseType){case"stream":return b.body;case"json":{let a=await b.text();try{a=JSON.parse(a)}catch(a){}return a}case"arraybuffer":return b.arrayBuffer();case"blob":return b.blob();case"text":return b.text();default:return this.getResponseDataFromContentType(b)}}validateStatus(a){return a>=200&&a<300}paramsSerializer(a){return t.default.stringify(a)}translateResponse(a,b,c){let d={};return b.headers.forEach((a,b)=>{d[b]=a}),{config:a,data:c,headers:d,status:b.status,statusText:b.statusText,request:{responseURL:b.url}}}async getResponseDataFromContentType(a){let b=a.headers.get("Content-Type");if(null===b)return a.text();if((b=b.toLowerCase()).includes("application/json")){let b=await a.text();try{b=JSON.parse(b)}catch(a){}return b}return b.match(/^text\//)?a.text():a.blob()}async *getMultipartRequest(a,b){let c=`--${b}--`;for(let c of a){let a=c.headers["Content-Type"]||"application/octet-stream",d=`--${b}\r
Content-Type: ${a}\r
\r
`;yield d,"string"==typeof c.content?yield c.content:yield*c.content,yield"\r\n"}yield c}}c.Gaxios=D,d=new WeakSet,e=function(a,b=[]){var c,d;let e=new v.URL(a),f=[...b];for(let a of(null==(d=null!=(c=process.env.NO_PROXY)?c:process.env.no_proxy)?void 0:d.split(","))||[])f.push(a.trim());for(let a of f)if(a instanceof RegExp){if(a.test(e.toString()))return!1}else if(a instanceof v.URL){if(a.origin===e.origin)return!1}else if(a.startsWith("*.")||a.startsWith(".")){let b=a.replace(/^\*\./,".");if(e.hostname.endsWith(b))return!1}else if(a===e.origin||a===e.hostname||a===e.href)return!1;return!0},f=async function(a){let b=Promise.resolve(a);for(let a of this.interceptors.request.values())a&&(b=b.then(a.resolved,a.rejected));return b},g=async function(a){let b=Promise.resolve(a);for(let a of this.interceptors.response.values())a&&(b=b.then(a.resolved,a.rejected));return b},h=async function(a){var b,c,f,g;let h=(0,q.default)(!0,{},this.defaults,a);if(!h.url)throw Error("URL is required.");let i=h.baseUrl||h.baseURL;if(i&&(h.url=i.toString()+h.url),h.paramsSerializer=h.paramsSerializer||this.paramsSerializer,h.params&&Object.keys(h.params).length>0){let a=h.paramsSerializer(h.params);a.startsWith("?")&&(a=a.slice(1));let b=h.url.toString().includes("?")?"&":"?";h.url=h.url+b+a}if("number"==typeof a.maxContentLength&&(h.size=a.maxContentLength),"number"==typeof a.maxRedirects&&(h.follow=a.maxRedirects),h.headers=h.headers||{},void 0===h.multipart&&h.data){let a="undefined"!=typeof FormData&&(null==h?void 0:h.data)instanceof FormData;u.default.readable(h.data)?h.body=h.data:"undefined"!=typeof Buffer&&Buffer.isBuffer(h.data)?(h.body=h.data,C(h,"Content-Type")||(h.headers["Content-Type"]="application/json")):"object"==typeof h.data?a||("application/x-www-form-urlencoded"===C(h,"content-type")?h.body=h.paramsSerializer(h.data):(C(h,"Content-Type")||(h.headers["Content-Type"]="application/json"),h.body=JSON.stringify(h.data))):h.body=h.data}else if(h.multipart&&h.multipart.length>0){let a=(0,z.v4)();h.headers["Content-Type"]=`multipart/related; boundary=${a}`;let b=new y.PassThrough;h.body=b,(0,y.pipeline)(this.getMultipartRequest(h.multipart,a),b,()=>{})}h.validateStatus=h.validateStatus||this.validateStatus,h.responseType=h.responseType||"unknown",h.headers.Accept||"json"!==h.responseType||(h.headers.Accept="application/json"),h.method=h.method||"GET";let k=h.proxy||(null==(b=null==process?void 0:process.env)?void 0:b.HTTPS_PROXY)||(null==(c=null==process?void 0:process.env)?void 0:c.https_proxy)||(null==(f=null==process?void 0:process.env)?void 0:f.HTTP_PROXY)||(null==(g=null==process?void 0:process.env)?void 0:g.http_proxy),l=n(this,d,"m",e).call(this,h.url,h.noProxy);if(h.agent);else if(k&&l){let a=await n(D,D,"m",j).call(D);this.agentCache.has(k)?h.agent=this.agentCache.get(k):(h.agent=new a(k,{cert:h.cert,key:h.key}),this.agentCache.set(k,h.agent))}else h.cert&&h.key&&(this.agentCache.has(h.key)?h.agent=this.agentCache.get(h.key):(h.agent=new r.Agent({cert:h.cert,key:h.key}),this.agentCache.set(h.key,h.agent)));return"function"!=typeof h.errorRedactor&&!1!==h.errorRedactor&&(h.errorRedactor=w.defaultErrorRedactor),h},j=async function(){return o(this,D,n(this,D,"f",i)||(await Promise.resolve().then(()=>m(a.r(48081)))).HttpsProxyAgent,"f",i),n(this,D,"f",i)},i={value:void 0}},48376,(a,b,c)=>{"use strict";var d=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),c.instance=c.Gaxios=c.GaxiosError=void 0,c.request=h;let f=a.r(41610);Object.defineProperty(c,"Gaxios",{enumerable:!0,get:function(){return f.Gaxios}});var g=a.r(33985);async function h(a){return c.instance.request(a)}Object.defineProperty(c,"GaxiosError",{enumerable:!0,get:function(){return g.GaxiosError}}),e(a.r(2458),c),c.instance=new f.Gaxios},29129,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.Colours=void 0;class d{static isEnabled(a){return a.isTTY&&("function"!=typeof a.getColorDepth||a.getColorDepth()>2)}static refresh(){d.enabled=d.isEnabled(process.stderr),this.enabled?(d.reset="\x1b[0m",d.bright="\x1b[1m",d.dim="\x1b[2m",d.red="\x1b[31m",d.green="\x1b[32m",d.yellow="\x1b[33m",d.blue="\x1b[34m",d.magenta="\x1b[35m",d.cyan="\x1b[36m",d.white="\x1b[37m",d.grey="\x1b[90m"):(d.reset="",d.bright="",d.dim="",d.red="",d.green="",d.yellow="",d.blue="",d.magenta="",d.cyan="",d.white="",d.grey="")}}c.Colours=d,d.enabled=!1,d.reset="",d.bright="",d.dim="",d.red="",d.green="",d.yellow="",d.blue="",d.magenta="",d.cyan="",d.white="",d.grey="",d.refresh()},20295,(a,b,c)=>{"use strict";let d;var e,f,g=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),h=a.e&&a.e.__setModuleDefault||(Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:!0,value:b})}:function(a,b){a.default=b}),i=a.e&&a.e.__importStar||function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)"default"!==c&&Object.prototype.hasOwnProperty.call(a,c)&&g(b,a,c);return h(b,a),b};Object.defineProperty(c,"__esModule",{value:!0}),c.env=c.DebugLogBackendBase=c.placeholder=c.AdhocDebugLogger=c.LogSeverity=void 0,c.getNodeBackend=q,c.getDebugBackend=function(a){return new r(a)},c.getStructuredBackend=function(a){return new s(a)},c.setBackend=function(a){d=a,t.clear()},c.log=u;let j=a.r(87769),k=i(a.r(59639)),l=i(a.r(12057)),m=a.r(29129);(e=f||(c.LogSeverity=f={})).DEFAULT="DEFAULT",e.DEBUG="DEBUG",e.INFO="INFO",e.WARNING="WARNING",e.ERROR="ERROR";class n extends j.EventEmitter{constructor(a,b){super(),this.namespace=a,this.upstream=b,this.func=Object.assign(this.invoke.bind(this),{instance:this,on:(a,b)=>this.on(a,b)}),this.func.debug=(...a)=>this.invokeSeverity(f.DEBUG,...a),this.func.info=(...a)=>this.invokeSeverity(f.INFO,...a),this.func.warn=(...a)=>this.invokeSeverity(f.WARNING,...a),this.func.error=(...a)=>this.invokeSeverity(f.ERROR,...a),this.func.sublog=a=>u(a,this.func)}invoke(a,...b){this.upstream&&this.upstream(a,...b),this.emit("log",a,b)}invokeSeverity(a,...b){this.invoke({severity:a},...b)}}c.AdhocDebugLogger=n,c.placeholder=new n("",()=>{}).func;class o{constructor(){var a;this.cached=new Map,this.filters=[],this.filtersSet=!1;let b=null!=(a=k.env[c.env.nodeEnables])?a:"*";"all"===b&&(b="*"),this.filters=b.split(",")}log(a,b,...c){try{this.filtersSet||(this.setFilters(),this.filtersSet=!0);let d=this.cached.get(a);d||(d=this.makeLogger(a),this.cached.set(a,d)),d(b,...c)}catch(a){console.error(a)}}}c.DebugLogBackendBase=o;class p extends o{constructor(){super(...arguments),this.enabledRegexp=/.*/g}isEnabled(a){return this.enabledRegexp.test(a)}makeLogger(a){return this.enabledRegexp.test(a)?(b,...c)=>{var d;let e,g=`${m.Colours.green}${a}${m.Colours.reset}`,h=`${m.Colours.yellow}${k.pid}${m.Colours.reset}`;switch(b.severity){case f.ERROR:e=`${m.Colours.red}${b.severity}${m.Colours.reset}`;break;case f.INFO:e=`${m.Colours.magenta}${b.severity}${m.Colours.reset}`;break;case f.WARNING:e=`${m.Colours.yellow}${b.severity}${m.Colours.reset}`;break;default:e=null!=(d=b.severity)?d:f.DEFAULT}let i=l.formatWithOptions({colors:m.Colours.enabled},...c),j=Object.assign({},b);delete j.severity;let n=Object.getOwnPropertyNames(j).length?JSON.stringify(j):"",o=n?`${m.Colours.grey}${n}${m.Colours.reset}`:"";console.error("%s [%s|%s] %s%s",h,g,e,i,n?` ${o}`:"")}:()=>{}}setFilters(){let a=this.filters.join(",").replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^");this.enabledRegexp=RegExp(`^${a}$`,"i")}}function q(){return new p}class r extends o{constructor(a){super(),this.debugPkg=a}makeLogger(a){let b=this.debugPkg(a);return(a,...c)=>{b(c[0],...c.slice(1))}}setFilters(){var a;let b=null!=(a=k.env.NODE_DEBUG)?a:"";k.env.NODE_DEBUG=`${b}${b?",":""}${this.filters.join(",")}`}}class s extends o{constructor(a){super(),this.upstream=null!=a?a:new p}makeLogger(a){let b=this.upstream.makeLogger(a);return(a,...c)=>{var d;let e=JSON.stringify(Object.assign({severity:null!=(d=a.severity)?d:f.INFO,message:l.format(...c)},a));b(a,e)}}setFilters(){this.upstream.setFilters()}}c.env={nodeEnables:"GOOGLE_SDK_NODE_LOGGING"};let t=new Map;function u(a,b){let e;if(!k.env[c.env.nodeEnables]||!a)return c.placeholder;b&&(a=`${b.instance.namespace}:${a}`);let f=t.get(a);if(f)return f.func;if(null===d)return c.placeholder;void 0===d&&(d=q());let g=new n(a,(b,...c)=>{if(e!==d){if(null===d)return;void 0===d&&(d=q()),e=d}null==d||d.log(a,b,...c)});return t.set(a,g),g.func}},29504,(a,b,c)=>{"use strict";var d=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),e(a.r(20295),c)},33961,(a,b,c)=>{"use strict";let d;var e=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),f=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||e(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),c.gcpResidencyCache=c.METADATA_SERVER_DETECTION=c.HEADERS=c.HEADER_VALUE=c.HEADER_NAME=c.SECONDARY_HOST_ADDRESS=c.HOST_ADDRESS=c.BASE_PATH=void 0,c.instance=function(a){return m("instance",a)},c.project=function(a){return m("project",a)},c.universe=function(a){return m("universe",a)},c.bulk=o,c.isAvailable=p,c.resetIsAvailableCache=function(){d=void 0},c.getGCPResidency=q,c.setGCPResidency=r,c.requestTimeout=s;let g=a.r(48376),h=a.r(82827),i=a.r(36447),j=a.r(29504);c.BASE_PATH="/computeMetadata/v1",c.HOST_ADDRESS="http://169.254.169.254",c.SECONDARY_HOST_ADDRESS="http://metadata.google.internal.",c.HEADER_NAME="Metadata-Flavor",c.HEADER_VALUE="Google",c.HEADERS=Object.freeze({[c.HEADER_NAME]:c.HEADER_VALUE});let k=j.log("gcp metadata");function l(a){return a||(a=process.env.GCE_METADATA_IP||process.env.GCE_METADATA_HOST||c.HOST_ADDRESS),/^https?:\/\//.test(a)||(a=`http://${a}`),new URL(c.BASE_PATH,a).href}async function m(a,b={},d=3,e=!1){let f="",i={},j={};("object"==typeof a?(f=a.metadataKey,i=a.params||i,j=a.headers||j,d=a.noResponseRetries||d,e=a.fastFail||e):f=a,"string"==typeof b)?f+=`/${b}`:(Object.keys(b).forEach(a=>{switch(a){case"params":case"property":case"headers":break;case"qs":throw Error("'qs' is not a valid configuration option. Please use 'params' instead.");default:throw Error(`'${a}' is not a valid configuration option.`)}}),b.property&&(f+=`/${b.property}`),j=b.headers||j,i=b.params||i);let o=e?n:g.request,p={url:`${l()}/${f}`,headers:{...c.HEADERS,...j},retryConfig:{noResponseRetries:d},params:i,responseType:"text",timeout:s()};k.info("instance request %j",p);let q=await o(p);if(k.info("instance metadata is %s",q.data),q.headers[c.HEADER_NAME.toLowerCase()]!==c.HEADER_VALUE)throw Error(`Invalid response from metadata service: incorrect ${c.HEADER_NAME} header. Expected '${c.HEADER_VALUE}', got ${q.headers[c.HEADER_NAME.toLowerCase()]?`'${q.headers[c.HEADER_NAME.toLowerCase()]}'`:"no header"}`);if("string"==typeof q.data)try{return h.parse(q.data)}catch(a){}return q.data}async function n(a){var b;let d={...a,url:null==(b=a.url)?void 0:b.toString().replace(l(),l(c.SECONDARY_HOST_ADDRESS))},e=!1,f=(0,g.request)(a).then(a=>(e=!0,a)).catch(a=>{if(e)return h;throw e=!0,a}),h=(0,g.request)(d).then(a=>(e=!0,a)).catch(a=>{if(e)return f;throw e=!0,a});return Promise.race([f,h])}async function o(a){let b={};return await Promise.all(a.map(a=>(async()=>{let c=await m(a);b[a.metadataKey]=c})())),b}async function p(){if(process.env.METADATA_SERVER_DETECTION){let a=process.env.METADATA_SERVER_DETECTION.trim().toLocaleLowerCase();if(!(a in c.METADATA_SERVER_DETECTION))throw RangeError(`Unknown \`METADATA_SERVER_DETECTION\` env variable. Got \`${a}\`, but it should be \`${Object.keys(c.METADATA_SERVER_DETECTION).join("`, `")}\`, or unset`);switch(a){case"assume-present":return!0;case"none":return!1;case"bios-only":return q()}}try{return void 0===d&&(d=m("instance",void 0,process.env.DETECT_GCP_RETRIES?Number(process.env.DETECT_GCP_RETRIES):0,!(process.env.GCE_METADATA_IP||process.env.GCE_METADATA_HOST))),await d,!0}catch(a){if(process.env.DEBUG_AUTH&&console.info(a),"request-timeout"===a.type||a.response&&404===a.response.status)return!1;if(!(a.response&&404===a.response.status)&&(!a.code||!["EHOSTDOWN","EHOSTUNREACH","ENETUNREACH","ENOENT","ENOTFOUND","ECONNREFUSED"].includes(a.code))){let b="UNKNOWN";a.code&&(b=a.code),process.emitWarning(`received unexpected error = ${a.message} code = ${b}`,"MetadataLookupWarning")}return!1}}function q(){return null===c.gcpResidencyCache&&r(),c.gcpResidencyCache}function r(a=null){c.gcpResidencyCache=null!==a?a:(0,i.detectGCPResidency)()}function s(){return 3e3*!q()}c.METADATA_SERVER_DETECTION=Object.freeze({"assume-present":"don't try to ping the metadata server, but assume it's present",none:"don't try to ping the metadata server, but don't try to use it either","bios-only":"treat the result of a BIOS probe as canonical (don't fall back to pinging)","ping-only":"skip the BIOS probe, and go straight to pinging"}),c.gcpResidencyCache=null,f(a.r(36447),c)},26792,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.BrowserCrypto=void 0;let d=a.r(61283),e=a.r(15032);class f{constructor(){throw Error("SubtleCrypto not found. Make sure it's an https:// website.")}async sha256DigestBase64(a){let b=new TextEncoder().encode(a),c=await window.crypto.subtle.digest("SHA-256",b);return d.fromByteArray(new Uint8Array(c))}randomBytesBase64(a){let b=new Uint8Array(a);return window.crypto.getRandomValues(b),d.fromByteArray(b)}static padBase64(a){for(;a.length%4!=0;)a+="=";return a}async verify(a,b,c){let e={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},g=new TextEncoder().encode(b),h=d.toByteArray(f.padBase64(c)),i=await window.crypto.subtle.importKey("jwk",a,e,!0,["verify"]);return await window.crypto.subtle.verify(e,i,h,g)}async sign(a,b){let c={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},e=new TextEncoder().encode(b),f=await window.crypto.subtle.importKey("jwk",a,c,!0,["sign"]),g=await window.crypto.subtle.sign(c,f,e);return d.fromByteArray(new Uint8Array(g))}decodeBase64StringUtf8(a){let b=d.toByteArray(f.padBase64(a));return new TextDecoder().decode(b)}encodeBase64StringUtf8(a){let b=new TextEncoder().encode(a);return d.fromByteArray(b)}async sha256DigestHex(a){let b=new TextEncoder().encode(a),c=await window.crypto.subtle.digest("SHA-256",b);return(0,e.fromArrayBufferToHex)(c)}async signWithHmacSha256(a,b){let c="string"==typeof a?a:String.fromCharCode(...new Uint16Array(a)),d=new TextEncoder,e=await window.crypto.subtle.importKey("raw",d.encode(c),{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);return window.crypto.subtle.sign("HMAC",e,d.encode(b))}}c.BrowserCrypto=f},97790,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.NodeCrypto=void 0;let d=a.r(54799);c.NodeCrypto=class{async sha256DigestBase64(a){return d.createHash("sha256").update(a).digest("base64")}randomBytesBase64(a){return d.randomBytes(a).toString("base64")}async verify(a,b,c){let e=d.createVerify("RSA-SHA256");return e.update(b),e.end(),e.verify(a,c,"base64")}async sign(a,b){let c=d.createSign("RSA-SHA256");return c.update(b),c.end(),c.sign(a,"base64")}decodeBase64StringUtf8(a){return Buffer.from(a,"base64").toString("utf-8")}encodeBase64StringUtf8(a){return Buffer.from(a,"utf-8").toString("base64")}async sha256DigestHex(a){return d.createHash("sha256").update(a).digest("hex")}async signWithHmacSha256(a,b){var c,e;let f="string"==typeof a?a:(c=a,Buffer.from(c));return(e=d.createHmac("sha256",f).update(b).digest()).buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}}},15032,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.createCrypto=function(){return function(){;}(),new d.NodeCrypto},c.hasBrowserCrypto=e,c.fromArrayBufferToHex=function(a){return Array.from(new Uint8Array(a)).map(a=>a.toString(16).padStart(2,"0")).join("")},a.r(26792);let d=a.r(97790);function e(){return!1}},33787,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.validate=function(a){for(let b of[{invalid:"uri",expected:"url"},{invalid:"json",expected:"data"},{invalid:"qs",expected:"params"}])if(a[b.invalid])throw Error(`'${b.invalid}' is not a valid configuration option. Please use '${b.expected}' instead. This library is using Axios for requests. Please see https://github.com/axios/axios to learn more about the valid request options.`)}},91633,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.DefaultTransporter=void 0;let d=a.r(48376),e=a.r(33787),f=a.r(70108),g="google-api-nodejs-client";class h{constructor(){this.instance=new d.Gaxios}configure(a={}){a.headers=a.headers||{};{let b=a.headers["User-Agent"];if(b?b.includes(`${g}/`)||(a.headers["User-Agent"]=`${b} ${h.USER_AGENT}`):a.headers["User-Agent"]=h.USER_AGENT,!a.headers["x-goog-api-client"]){let b=process.version.replace(/^v/,"");a.headers["x-goog-api-client"]=`gl-node/${b}`}}return a}request(a){return a=this.configure(a),(0,e.validate)(a),this.instance.request(a).catch(a=>{throw this.processError(a)})}get defaults(){return this.instance.defaults}set defaults(a){this.instance.defaults=a}processError(a){let b=a.response,c=b?b.data:null;return b&&c&&c.error&&200!==b.status?"string"==typeof c.error?(a.message=c.error,a.status=b.status):Array.isArray(c.error.errors)?(a.message=c.error.errors.map(a=>a.message).join("\n"),a.code=c.error.code,a.errors=c.error.errors):(a.message=c.error.message,a.code=c.error.code):b&&b.status>=400&&(a.message=c,a.status=b.status),a}}c.DefaultTransporter=h,h.USER_AGENT=`${g}/${f.version}`},63100,(a,b,c)=>{"use strict";var d,e,f,g,h=a.e&&a.e.__classPrivateFieldGet||function(a,b,c,d){if("a"===c&&!d)throw TypeError("Private accessor was defined without a getter");if("function"==typeof b?a!==b||!d:!b.has(a))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===c?d:"a"===c?d.call(a):d?d.value:b.get(a)};function i(a){return a.replace(/([_][^_])/g,a=>a.slice(1).toUpperCase())}Object.defineProperty(c,"__esModule",{value:!0}),c.LRUCache=void 0,c.snakeToCamel=i,c.originalOrCamelOptions=function(a){return{get:function(b){var c;let d=a||{};return null!=(c=d[b])?c:d[i(b)]}}},c.LRUCache=class{constructor(a){d.add(this),e.set(this,new Map),this.capacity=a.capacity,this.maxAge=a.maxAge}set(a,b){h(this,d,"m",f).call(this,a,b),h(this,d,"m",g).call(this)}get(a){let b=h(this,e,"f").get(a);if(b)return h(this,d,"m",f).call(this,a,b.value),h(this,d,"m",g).call(this),b.value}},e=new WeakMap,d=new WeakSet,f=function(a,b){h(this,e,"f").delete(a),h(this,e,"f").set(a,{value:b,lastAccessed:Date.now()})},g=function(){let a=this.maxAge?Date.now()-this.maxAge:0,b=h(this,e,"f").entries().next();for(;!b.done&&(h(this,e,"f").size>this.capacity||b.value[1].lastAccessed<a);)h(this,e,"f").delete(b.value[0]),b=h(this,e,"f").entries().next()}},73910,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.AuthClient=c.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS=c.DEFAULT_UNIVERSE=void 0;let d=a.r(27699),e=a.r(48376),f=a.r(91633),g=a.r(63100);c.DEFAULT_UNIVERSE="googleapis.com",c.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS=3e5;class h extends d.EventEmitter{constructor(a={}){var b,d,e,h,i;super(),this.credentials={},this.eagerRefreshThresholdMillis=c.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS,this.forceRefreshOnFailure=!1,this.universeDomain=c.DEFAULT_UNIVERSE;const j=(0,g.originalOrCamelOptions)(a);this.apiKey=a.apiKey,this.projectId=null!=(b=j.get("project_id"))?b:null,this.quotaProjectId=j.get("quota_project_id"),this.credentials=null!=(d=j.get("credentials"))?d:{},this.universeDomain=null!=(e=j.get("universe_domain"))?e:c.DEFAULT_UNIVERSE,this.transporter=null!=(h=a.transporter)?h:new f.DefaultTransporter,a.transporterOptions&&(this.transporter.defaults=a.transporterOptions),a.eagerRefreshThresholdMillis&&(this.eagerRefreshThresholdMillis=a.eagerRefreshThresholdMillis),this.forceRefreshOnFailure=null!=(i=a.forceRefreshOnFailure)&&i}get gaxios(){return this.transporter instanceof e.Gaxios?this.transporter:this.transporter instanceof f.DefaultTransporter||"instance"in this.transporter&&this.transporter.instance instanceof e.Gaxios?this.transporter.instance:null}setCredentials(a){this.credentials=a}addSharedMetadataHeaders(a){return!a["x-goog-user-project"]&&this.quotaProjectId&&(a["x-goog-user-project"]=this.quotaProjectId),a}static get RETRY_CONFIG(){return{retry:!0,retryConfig:{httpMethodsToRetry:["GET","PUT","POST","HEAD","OPTIONS","DELETE"]}}}}c.AuthClient=h},6052,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.LoginTicket=void 0,c.LoginTicket=class{constructor(a,b){this.envelope=a,this.payload=b}getEnvelope(){return this.envelope}getPayload(){return this.payload}getUserId(){let a=this.getPayload();return a&&a.sub?a.sub:null}getAttributes(){return{envelope:this.getEnvelope(),payload:this.getPayload()}}}},31442,(a,b,c)=>{"use strict";var d,e,f,g,h,i;Object.defineProperty(c,"__esModule",{value:!0}),c.OAuth2Client=c.ClientAuthentication=c.CertificateFormat=c.CodeChallengeMethod=void 0;let j=a.r(48376),k=a.r(45706),l=a.r(88947),m=a.r(66158),n=a.r(15032),o=a.r(73910),p=a.r(6052);(g=d||(c.CodeChallengeMethod=d={})).Plain="plain",g.S256="S256",(h=e||(c.CertificateFormat=e={})).PEM="PEM",h.JWK="JWK",(i=f||(c.ClientAuthentication=f={})).ClientSecretPost="ClientSecretPost",i.ClientSecretBasic="ClientSecretBasic",i.None="None";class q extends o.AuthClient{constructor(a,b,c){const d=a&&"object"==typeof a?a:{clientId:a,clientSecret:b,redirectUri:c};super(d),this.certificateCache={},this.certificateExpiry=null,this.certificateCacheFormat=e.PEM,this.refreshTokenPromises=new Map,this._clientId=d.clientId,this._clientSecret=d.clientSecret,this.redirectUri=d.redirectUri,this.endpoints={tokenInfoUrl:"https://oauth2.googleapis.com/tokeninfo",oauth2AuthBaseUrl:"https://accounts.google.com/o/oauth2/v2/auth",oauth2TokenUrl:"https://oauth2.googleapis.com/token",oauth2RevokeUrl:"https://oauth2.googleapis.com/revoke",oauth2FederatedSignonPemCertsUrl:"https://www.googleapis.com/oauth2/v1/certs",oauth2FederatedSignonJwkCertsUrl:"https://www.googleapis.com/oauth2/v3/certs",oauth2IapPublicKeyUrl:"https://www.gstatic.com/iap/verify/public_key",...d.endpoints},this.clientAuthentication=d.clientAuthentication||f.ClientSecretPost,this.issuers=d.issuers||["accounts.google.com","https://accounts.google.com",this.universeDomain]}generateAuthUrl(a={}){if(a.code_challenge_method&&!a.code_challenge)throw Error("If a code_challenge_method is provided, code_challenge must be included.");return a.response_type=a.response_type||"code",a.client_id=a.client_id||this._clientId,a.redirect_uri=a.redirect_uri||this.redirectUri,Array.isArray(a.scope)&&(a.scope=a.scope.join(" ")),this.endpoints.oauth2AuthBaseUrl.toString()+"?"+k.stringify(a)}generateCodeVerifier(){throw Error("generateCodeVerifier is removed, please use generateCodeVerifierAsync instead.")}async generateCodeVerifierAsync(){let a=(0,n.createCrypto)(),b=a.randomBytesBase64(96).replace(/\+/g,"~").replace(/=/g,"_").replace(/\//g,"-"),c=(await a.sha256DigestBase64(b)).split("=")[0].replace(/\+/g,"-").replace(/\//g,"_");return{codeVerifier:b,codeChallenge:c}}getToken(a,b){let c="string"==typeof a?{code:a}:a;if(!b)return this.getTokenAsync(c);this.getTokenAsync(c).then(a=>b(null,a.tokens,a.res),a=>b(a,null,a.response))}async getTokenAsync(a){let b=this.endpoints.oauth2TokenUrl.toString(),c={"Content-Type":"application/x-www-form-urlencoded"},d={client_id:a.client_id||this._clientId,code_verifier:a.codeVerifier,code:a.code,grant_type:"authorization_code",redirect_uri:a.redirect_uri||this.redirectUri};if(this.clientAuthentication===f.ClientSecretBasic){let a=Buffer.from(`${this._clientId}:${this._clientSecret}`);c.Authorization=`Basic ${a.toString("base64")}`}this.clientAuthentication===f.ClientSecretPost&&(d.client_secret=this._clientSecret);let e=await this.transporter.request({...q.RETRY_CONFIG,method:"POST",url:b,data:k.stringify(d),headers:c}),g=e.data;return e.data&&e.data.expires_in&&(g.expiry_date=new Date().getTime()+1e3*e.data.expires_in,delete g.expires_in),this.emit("tokens",g),{tokens:g,res:e}}async refreshToken(a){if(!a)return this.refreshTokenNoCache(a);if(this.refreshTokenPromises.has(a))return this.refreshTokenPromises.get(a);let b=this.refreshTokenNoCache(a).then(b=>(this.refreshTokenPromises.delete(a),b),b=>{throw this.refreshTokenPromises.delete(a),b});return this.refreshTokenPromises.set(a,b),b}async refreshTokenNoCache(a){var b;let c;if(!a)throw Error("No refresh token is set.");let d=this.endpoints.oauth2TokenUrl.toString(),e={refresh_token:a,client_id:this._clientId,client_secret:this._clientSecret,grant_type:"refresh_token"};try{c=await this.transporter.request({...q.RETRY_CONFIG,method:"POST",url:d,data:k.stringify(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}})}catch(a){throw a instanceof j.GaxiosError&&"invalid_grant"===a.message&&(null==(b=a.response)?void 0:b.data)&&/ReAuth/i.test(a.response.data.error_description)&&(a.message=JSON.stringify(a.response.data)),a}let f=c.data;return c.data&&c.data.expires_in&&(f.expiry_date=new Date().getTime()+1e3*c.data.expires_in,delete f.expires_in),this.emit("tokens",f),{tokens:f,res:c}}refreshAccessToken(a){if(!a)return this.refreshAccessTokenAsync();this.refreshAccessTokenAsync().then(b=>a(null,b.credentials,b.res),a)}async refreshAccessTokenAsync(){let a=await this.refreshToken(this.credentials.refresh_token),b=a.tokens;return b.refresh_token=this.credentials.refresh_token,this.credentials=b,{credentials:this.credentials,res:a.res}}getAccessToken(a){if(!a)return this.getAccessTokenAsync();this.getAccessTokenAsync().then(b=>a(null,b.token,b.res),a)}async getAccessTokenAsync(){if(!(!this.credentials.access_token||this.isTokenExpiring()))return{token:this.credentials.access_token};{if(!this.credentials.refresh_token)if(this.refreshHandler){let a=await this.processAndValidateRefreshHandler();if(null==a?void 0:a.access_token)return this.setCredentials(a),{token:this.credentials.access_token}}else throw Error("No refresh token or refresh handler callback is set.");let a=await this.refreshAccessTokenAsync();if(!a.credentials||a.credentials&&!a.credentials.access_token)throw Error("Could not refresh access token.");return{token:a.credentials.access_token,res:a.res}}}async getRequestHeaders(a){return(await this.getRequestMetadataAsync(a)).headers}async getRequestMetadataAsync(a){let b=this.credentials;if(!b.access_token&&!b.refresh_token&&!this.apiKey&&!this.refreshHandler)throw Error("No access, refresh token, API key or refresh handler callback is set.");if(b.access_token&&!this.isTokenExpiring()){b.token_type=b.token_type||"Bearer";let a={Authorization:b.token_type+" "+b.access_token};return{headers:this.addSharedMetadataHeaders(a)}}if(this.refreshHandler){let a=await this.processAndValidateRefreshHandler();if(null==a?void 0:a.access_token){this.setCredentials(a);let b={Authorization:"Bearer "+this.credentials.access_token};return{headers:this.addSharedMetadataHeaders(b)}}}if(this.apiKey)return{headers:{"X-Goog-Api-Key":this.apiKey}};let c=null,d=null;try{d=(c=await this.refreshToken(b.refresh_token)).tokens}catch(a){throw a.response&&(403===a.response.status||404===a.response.status)&&(a.message=`Could not refresh access token: ${a.message}`),a}let e=this.credentials;e.token_type=e.token_type||"Bearer",d.refresh_token=e.refresh_token,this.credentials=d;let f={Authorization:e.token_type+" "+d.access_token};return{headers:this.addSharedMetadataHeaders(f),res:c.res}}static getRevokeTokenUrl(a){return new q().getRevokeTokenURL(a).toString()}getRevokeTokenURL(a){let b=new URL(this.endpoints.oauth2RevokeUrl);return b.searchParams.append("token",a),b}revokeToken(a,b){let c={...q.RETRY_CONFIG,url:this.getRevokeTokenURL(a).toString(),method:"POST"};if(!b)return this.transporter.request(c);this.transporter.request(c).then(a=>b(null,a),b)}revokeCredentials(a){if(!a)return this.revokeCredentialsAsync();this.revokeCredentialsAsync().then(b=>a(null,b),a)}async revokeCredentialsAsync(){let a=this.credentials.access_token;if(this.credentials={},a)return this.revokeToken(a);throw Error("No access token to revoke.")}request(a,b){if(!b)return this.requestAsync(a);this.requestAsync(a).then(a=>b(null,a),a=>b(a,a.response))}async requestAsync(a,b=!1){let c;try{let b=await this.getRequestMetadataAsync(a.url);a.headers=a.headers||{},b.headers&&b.headers["x-goog-user-project"]&&(a.headers["x-goog-user-project"]=b.headers["x-goog-user-project"]),b.headers&&b.headers.Authorization&&(a.headers.Authorization=b.headers.Authorization),this.apiKey&&(a.headers["X-Goog-Api-Key"]=this.apiKey),c=await this.transporter.request(a)}catch(d){let c=d.response;if(c){let d=c.status,e=this.credentials&&this.credentials.access_token&&this.credentials.refresh_token&&(!this.credentials.expiry_date||this.forceRefreshOnFailure),f=this.credentials&&this.credentials.access_token&&!this.credentials.refresh_token&&(!this.credentials.expiry_date||this.forceRefreshOnFailure)&&this.refreshHandler,g=c.config.data instanceof l.Readable,h=401===d||403===d;if(!b&&h&&!g&&e)return await this.refreshAccessTokenAsync(),this.requestAsync(a,!0);if(!b&&h&&!g&&f){let b=await this.processAndValidateRefreshHandler();return(null==b?void 0:b.access_token)&&this.setCredentials(b),this.requestAsync(a,!0)}}throw d}return c}verifyIdToken(a,b){if(b&&"function"!=typeof b)throw Error("This method accepts an options object as the first parameter, which includes the idToken, audience, and maxExpiry.");if(!b)return this.verifyIdTokenAsync(a);this.verifyIdTokenAsync(a).then(a=>b(null,a),b)}async verifyIdTokenAsync(a){if(!a.idToken)throw Error("The verifyIdToken method requires an ID Token");let b=await this.getFederatedSignonCertsAsync();return await this.verifySignedJwtWithCertsAsync(a.idToken,b.certs,a.audience,this.issuers,a.maxExpiry)}async getTokenInfo(a){let{data:b}=await this.transporter.request({...q.RETRY_CONFIG,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:`Bearer ${a}`},url:this.endpoints.tokenInfoUrl.toString()}),c=Object.assign({expiry_date:new Date().getTime()+1e3*b.expires_in,scopes:b.scope.split(" ")},b);return delete c.expires_in,delete c.scope,c}getFederatedSignonCerts(a){if(!a)return this.getFederatedSignonCertsAsync();this.getFederatedSignonCertsAsync().then(b=>a(null,b.certs,b.res),a)}async getFederatedSignonCertsAsync(){let a,b,c=new Date().getTime(),d=(0,n.hasBrowserCrypto)()?e.JWK:e.PEM;if(this.certificateExpiry&&c<this.certificateExpiry.getTime()&&this.certificateCacheFormat===d)return{certs:this.certificateCache,format:d};switch(d){case e.PEM:b=this.endpoints.oauth2FederatedSignonPemCertsUrl.toString();break;case e.JWK:b=this.endpoints.oauth2FederatedSignonJwkCertsUrl.toString();break;default:throw Error(`Unsupported certificate format ${d}`)}try{a=await this.transporter.request({...q.RETRY_CONFIG,url:b})}catch(a){throw a instanceof Error&&(a.message=`Failed to retrieve verification certificates: ${a.message}`),a}let f=a?a.headers["cache-control"]:void 0,g=-1;if(f){let a=RegExp("max-age=([0-9]*)").exec(f);a&&2===a.length&&(g=1e3*Number(a[1]))}let h={};switch(d){case e.PEM:h=a.data;break;case e.JWK:for(let b of a.data.keys)h[b.kid]=b;break;default:throw Error(`Unsupported certificate format ${d}`)}let i=new Date;return this.certificateExpiry=-1===g?null:new Date(i.getTime()+g),this.certificateCache=h,this.certificateCacheFormat=d,{certs:h,format:d,res:a}}getIapPublicKeys(a){if(!a)return this.getIapPublicKeysAsync();this.getIapPublicKeysAsync().then(b=>a(null,b.pubkeys,b.res),a)}async getIapPublicKeysAsync(){let a,b=this.endpoints.oauth2IapPublicKeyUrl.toString();try{a=await this.transporter.request({...q.RETRY_CONFIG,url:b})}catch(a){throw a instanceof Error&&(a.message=`Failed to retrieve verification certificates: ${a.message}`),a}return{pubkeys:a.data,res:a}}verifySignedJwtWithCerts(){throw Error("verifySignedJwtWithCerts is removed, please use verifySignedJwtWithCertsAsync instead.")}async verifySignedJwtWithCertsAsync(a,b,c,d,e){let f,g,h=(0,n.createCrypto)();e||(e=q.DEFAULT_MAX_TOKEN_LIFETIME_SECS_);let i=a.split(".");if(3!==i.length)throw Error("Wrong number of segments in token: "+a);let j=i[0]+"."+i[1],k=i[2];try{f=JSON.parse(h.decodeBase64StringUtf8(i[0]))}catch(a){throw a instanceof Error&&(a.message=`Can't parse token envelope: ${i[0]}': ${a.message}`),a}if(!f)throw Error("Can't parse token envelope: "+i[0]);try{g=JSON.parse(h.decodeBase64StringUtf8(i[1]))}catch(a){throw a instanceof Error&&(a.message=`Can't parse token payload '${i[0]}`),a}if(!g)throw Error("Can't parse token payload: "+i[1]);if(!Object.prototype.hasOwnProperty.call(b,f.kid))throw Error("No pem found for envelope: "+JSON.stringify(f));let l=b[f.kid];if("ES256"===f.alg&&(k=m.joseToDer(k,"ES256").toString("base64")),!await h.verify(l,j,k))throw Error("Invalid token signature: "+a);if(!g.iat)throw Error("No issue time in token: "+JSON.stringify(g));if(!g.exp)throw Error("No expiration time in token: "+JSON.stringify(g));let o=Number(g.iat);if(isNaN(o))throw Error("iat field using invalid format");let r=Number(g.exp);if(isNaN(r))throw Error("exp field using invalid format");let s=new Date().getTime()/1e3;if(r>=s+e)throw Error("Expiration time too far in future: "+JSON.stringify(g));let t=o-q.CLOCK_SKEW_SECS_,u=r+q.CLOCK_SKEW_SECS_;if(s<t)throw Error("Token used too early, "+s+" < "+t+": "+JSON.stringify(g));if(s>u)throw Error("Token used too late, "+s+" > "+u+": "+JSON.stringify(g));if(d&&0>d.indexOf(g.iss))throw Error("Invalid issuer, expected one of ["+d+"], but got "+g.iss);if(null!=c){let a=g.aud;if(!(c.constructor===Array?c.indexOf(a)>-1:a===c))throw Error("Wrong recipient, payload audience != requiredAudience")}return new p.LoginTicket(f,g)}async processAndValidateRefreshHandler(){if(this.refreshHandler){let a=await this.refreshHandler();if(!a.access_token)throw Error("No access token is returned by the refreshHandler callback.");return a}}isTokenExpiring(){let a=this.credentials.expiry_date;return!!a&&a<=new Date().getTime()+this.eagerRefreshThresholdMillis}}c.OAuth2Client=q,q.GOOGLE_TOKEN_INFO_URL="https://oauth2.googleapis.com/tokeninfo",q.CLOCK_SKEW_SECS_=300,q.DEFAULT_MAX_TOKEN_LIFETIME_SECS_=86400},42669,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.Compute=void 0;let d=a.r(48376),e=a.r(33961),f=a.r(31442);class g extends f.OAuth2Client{constructor(a={}){super(a),this.credentials={expiry_date:1,refresh_token:"compute-placeholder"},this.serviceAccountEmail=a.serviceAccountEmail||"default",this.scopes=Array.isArray(a.scopes)?a.scopes:a.scopes?[a.scopes]:[]}async refreshTokenNoCache(a){let b,c=`service-accounts/${this.serviceAccountEmail}/token`;try{let a={property:c};this.scopes.length>0&&(a.params={scopes:this.scopes.join(",")}),b=await e.instance(a)}catch(a){throw a instanceof d.GaxiosError&&(a.message=`Could not refresh access token: ${a.message}`,this.wrapError(a)),a}let f=b;return b&&b.expires_in&&(f.expiry_date=new Date().getTime()+1e3*b.expires_in,delete f.expires_in),this.emit("tokens",f),{tokens:f,res:null}}async fetchIdToken(a){let b,c=`service-accounts/${this.serviceAccountEmail}/identity?format=full&audience=${a}`;try{b=await e.instance({property:c})}catch(a){throw a instanceof Error&&(a.message=`Could not fetch ID token: ${a.message}`),a}return b}wrapError(a){let b=a.response;b&&b.status&&(a.status=b.status,403===b.status?a.message="A Forbidden error was returned while attempting to retrieve an access token for the Compute Engine built-in service account. This may be because the Compute Engine instance does not have the correct permission scopes specified: "+a.message:404===b.status&&(a.message="A Not Found error was returned while attempting to retrieve an accesstoken for the Compute Engine built-in service account. This may be because the Compute Engine instance does not have any permission scopes specified: "+a.message))}}c.Compute=g},47789,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.IdTokenClient=void 0;let d=a.r(31442);class e extends d.OAuth2Client{constructor(a){super(a),this.targetAudience=a.targetAudience,this.idTokenProvider=a.idTokenProvider}async getRequestMetadataAsync(a){if(!this.credentials.id_token||!this.credentials.expiry_date||this.isTokenExpiring()){let a=await this.idTokenProvider.fetchIdToken(this.targetAudience);this.credentials={id_token:a,expiry_date:this.getIdTokenExpiryDate(a)}}return{headers:{Authorization:"Bearer "+this.credentials.id_token}}}getIdTokenExpiryDate(a){let b=a.split(".")[1];if(b)return 1e3*JSON.parse(Buffer.from(b,"base64").toString("ascii")).exp}}c.IdTokenClient=e},8462,(a,b,c)=>{"use strict";var d,e;let f;Object.defineProperty(c,"__esModule",{value:!0}),c.GCPEnv=void 0,c.clear=function(){f=void 0},c.getEnv=h;let g=a.r(33961);async function h(){return f||(f=i())}async function i(){d.NONE;return process.env.GAE_SERVICE||process.env.GAE_MODULE_NAME?d.APP_ENGINE:process.env.FUNCTION_NAME||process.env.FUNCTION_TARGET?d.CLOUD_FUNCTIONS:await k()?await j()?d.KUBERNETES_ENGINE:process.env.K_CONFIGURATION?d.CLOUD_RUN:d.COMPUTE_ENGINE:d.NONE}async function j(){try{return await g.instance("attributes/cluster-name"),!0}catch(a){return!1}}async function k(){return g.isAvailable()}(e=d||(c.GCPEnv=d={})).APP_ENGINE="APP_ENGINE",e.KUBERNETES_ENGINE="KUBERNETES_ENGINE",e.CLOUD_FUNCTIONS="CLOUD_FUNCTIONS",e.COMPUTE_ENGINE="COMPUTE_ENGINE",e.CLOUD_RUN="CLOUD_RUN",e.NONE="NONE"},30982,(a,b,c)=>{"use strict";var d,e,f,g,h,i,j,k,l=a.e&&a.e.__classPrivateFieldGet||function(a,b,c,d){if("a"===c&&!d)throw TypeError("Private accessor was defined without a getter");if("function"==typeof b?a!==b||!d:!b.has(a))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===c?d:"a"===c?d.call(a):d?d.value:b.get(a)},m=a.e&&a.e.__classPrivateFieldSet||function(a,b,c,d,e){if("m"===d)throw TypeError("Private method is not writable");if("a"===d&&!e)throw TypeError("Private accessor was defined without a setter");if("function"==typeof b?a!==b||!e:!b.has(a))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===d?e.call(a,c):e?e.value=c:b.set(a,c),c};Object.defineProperty(c,"__esModule",{value:!0}),c.GoogleToken=void 0;let n=a.r(22734),o=a.r(48376),p=a.r(81649),q=a.r(14747),r=(0,a.r(24361).promisify)(n.readFile),s="https://www.googleapis.com/oauth2/v4/token";class t extends Error{constructor(a,b){super(a),this.code=b}}c.GoogleToken=class{get accessToken(){return this.rawToken?this.rawToken.access_token:void 0}get idToken(){return this.rawToken?this.rawToken.id_token:void 0}get tokenType(){return this.rawToken?this.rawToken.token_type:void 0}get refreshToken(){return this.rawToken?this.rawToken.refresh_token:void 0}constructor(a){d.add(this),this.transporter={request:a=>(0,o.request)(a)},e.set(this,void 0),l(this,d,"m",j).call(this,a)}hasExpired(){let a=new Date().getTime();return!this.rawToken||!this.expiresAt||a>=this.expiresAt}isTokenExpiring(){var a;let b=new Date().getTime(),c=null!=(a=this.eagerRefreshThresholdMillis)?a:0;return!this.rawToken||!this.expiresAt||this.expiresAt<=b+c}getToken(a,b={}){if("object"==typeof a&&(b=a,a=void 0),b=Object.assign({forceRefresh:!1},b),a){let c=a;l(this,d,"m",f).call(this,b).then(a=>c(null,a),a);return}return l(this,d,"m",f).call(this,b)}async getCredentials(a){switch(q.extname(a)){case".json":{let b=JSON.parse(await r(a,"utf8")),c=b.private_key,d=b.client_email;if(!c||!d)throw new t("private_key and client_email are required.","MISSING_CREDENTIALS");return{privateKey:c,clientEmail:d}}case".der":case".crt":case".pem":return{privateKey:await r(a,"utf8")};case".p12":case".pfx":throw new t("*.p12 certificates are not supported after v6.1.2. Consider utilizing *.json format or converting *.p12 to *.pem using the OpenSSL CLI.","UNKNOWN_CERTIFICATE_TYPE");default:throw new t("Unknown certificate type. Type is determined based on file extension. Current supported extensions are *.json, and *.pem.","UNKNOWN_CERTIFICATE_TYPE")}}revokeToken(a){return a?void l(this,d,"m",i).call(this).then(()=>a(),a):l(this,d,"m",i).call(this)}},e=new WeakMap,d=new WeakSet,f=async function(a){if(l(this,e,"f")&&!a.forceRefresh)return l(this,e,"f");try{return await m(this,e,l(this,d,"m",g).call(this,a),"f")}finally{m(this,e,void 0,"f")}},g=async function(a){if(!1===this.isTokenExpiring()&&!1===a.forceRefresh)return Promise.resolve(this.rawToken);if(!this.key&&!this.keyFile)throw Error("No key or keyFile set.");if(!this.key&&this.keyFile){let a=await this.getCredentials(this.keyFile);this.key=a.privateKey,this.iss=a.clientEmail||this.iss,a.clientEmail||l(this,d,"m",h).call(this)}return l(this,d,"m",k).call(this)},h=function(){if(!this.iss)throw new t("email is required.","MISSING_CREDENTIALS")},i=async function(){if(!this.accessToken)throw Error("No token to revoke.");let a="https://accounts.google.com/o/oauth2/revoke?token="+this.accessToken;await this.transporter.request({url:a,retry:!0}),l(this,d,"m",j).call(this,{email:this.iss,sub:this.sub,key:this.key,keyFile:this.keyFile,scope:this.scope,additionalClaims:this.additionalClaims})},j=function(a={}){this.keyFile=a.keyFile,this.key=a.key,this.rawToken=void 0,this.iss=a.email||a.iss,this.sub=a.sub,this.additionalClaims=a.additionalClaims,"object"==typeof a.scope?this.scope=a.scope.join(" "):this.scope=a.scope,this.eagerRefreshThresholdMillis=a.eagerRefreshThresholdMillis,a.transporter&&(this.transporter=a.transporter)},k=async function(){var a,b;let c=Math.floor(new Date().getTime()/1e3),d=this.additionalClaims||{},e=Object.assign({iss:this.iss,scope:this.scope,aud:s,exp:c+3600,iat:c,sub:this.sub},d),f=p.sign({header:{alg:"RS256"},payload:e,secret:this.key});try{let a=await this.transporter.request({method:"POST",url:s,data:{grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:f},headers:{"Content-Type":"application/x-www-form-urlencoded"},responseType:"json",retryConfig:{httpMethodsToRetry:["POST"]}});return this.rawToken=a.data,this.expiresAt=null===a.data.expires_in||void 0===a.data.expires_in?void 0:(c+a.data.expires_in)*1e3,this.rawToken}catch(d){this.rawToken=void 0,this.tokenExpires=void 0;let c=d.response&&(null==(a=d.response)?void 0:a.data)?null==(b=d.response)?void 0:b.data:{};if(c.error){let a=c.error_description?`: ${c.error_description}`:"";d.message=`${c.error}${a}`}throw d}}},97843,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.JWTAccess=void 0;let d=a.r(81649),e=a.r(63100),f={alg:"RS256",typ:"JWT"};class g{constructor(a,b,c,d){this.cache=new e.LRUCache({capacity:500,maxAge:36e5}),this.email=a,this.key=b,this.keyId=c,this.eagerRefreshThresholdMillis=null!=d?d:3e5}getCachedKey(a,b){let c=a;if(b&&Array.isArray(b)&&b.length?c=a?`${a}_${b.join("_")}`:`${b.join("_")}`:"string"==typeof b&&(c=a?`${a}_${b}`:b),!c)throw Error("Scopes or url must be provided");return c}getRequestHeaders(a,b,c){let e,h=this.getCachedKey(a,c),i=this.cache.get(h),j=Date.now();if(i&&i.expiration-j>this.eagerRefreshThresholdMillis)return i.headers;let k=Math.floor(Date.now()/1e3),l=g.getExpirationTime(k);if(Array.isArray(c)&&(c=c.join(" ")),e=c?{iss:this.email,sub:this.email,scope:c,exp:l,iat:k}:{iss:this.email,sub:this.email,aud:a,exp:l,iat:k},b){for(let a in e)if(b[a])throw Error(`The '${a}' property is not allowed when passing additionalClaims. This claim is included in the JWT by default.`)}let m=this.keyId?{...f,kid:this.keyId}:f,n=Object.assign(e,b),o=d.sign({header:m,payload:n,secret:this.key}),p={Authorization:`Bearer ${o}`};return this.cache.set(h,{expiration:1e3*l,headers:p}),p}static getExpirationTime(a){return a+3600}fromJSON(a){if(!a)throw Error("Must pass in a JSON object containing the service account auth settings.");if(!a.client_email)throw Error("The incoming JSON object does not contain a client_email field");if(!a.private_key)throw Error("The incoming JSON object does not contain a private_key field");this.email=a.client_email,this.key=a.private_key,this.keyId=a.private_key_id,this.projectId=a.project_id}fromStream(a,b){if(!b)return this.fromStreamAsync(a);this.fromStreamAsync(a).then(()=>b(),b)}fromStreamAsync(a){return new Promise((b,c)=>{a||c(Error("Must pass in a stream containing the service account auth settings."));let d="";a.setEncoding("utf8").on("data",a=>d+=a).on("error",c).on("end",()=>{try{let a=JSON.parse(d);this.fromJSON(a),b()}catch(a){c(a)}})})}}c.JWTAccess=g},22983,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.JWT=void 0;let d=a.r(30982),e=a.r(97843),f=a.r(31442),g=a.r(73910);class h extends f.OAuth2Client{constructor(a,b,c,d,e,f){const g=a&&"object"==typeof a?a:{email:a,keyFile:b,key:c,keyId:f,scopes:d,subject:e};super(g),this.email=g.email,this.keyFile=g.keyFile,this.key=g.key,this.keyId=g.keyId,this.scopes=g.scopes,this.subject=g.subject,this.additionalClaims=g.additionalClaims,this.credentials={refresh_token:"jwt-placeholder",expiry_date:1}}createScoped(a){let b=new h(this);return b.scopes=a,b}async getRequestMetadataAsync(a){a=this.defaultServicePath?`https://${this.defaultServicePath}/`:a;let b=!this.hasUserScopes()&&a||this.useJWTAccessWithScope&&this.hasAnyScopes()||this.universeDomain!==g.DEFAULT_UNIVERSE;if(this.subject&&this.universeDomain!==g.DEFAULT_UNIVERSE)throw RangeError(`Service Account user is configured for the credential. Domain-wide delegation is not supported in universes other than ${g.DEFAULT_UNIVERSE}`);if(!this.apiKey&&b)if(this.additionalClaims&&this.additionalClaims.target_audience){let{tokens:a}=await this.refreshToken();return{headers:this.addSharedMetadataHeaders({Authorization:`Bearer ${a.id_token}`})}}else{let b;this.access||(this.access=new e.JWTAccess(this.email,this.key,this.keyId,this.eagerRefreshThresholdMillis)),this.hasUserScopes()?b=this.scopes:a||(b=this.defaultScopes);let c=this.useJWTAccessWithScope||this.universeDomain!==g.DEFAULT_UNIVERSE,d=await this.access.getRequestHeaders(null!=a?a:void 0,this.additionalClaims,c?b:void 0);return{headers:this.addSharedMetadataHeaders(d)}}return this.hasAnyScopes()||this.apiKey?super.getRequestMetadataAsync(a):{headers:{}}}async fetchIdToken(a){let b=new d.GoogleToken({iss:this.email,sub:this.subject,scope:this.scopes||this.defaultScopes,keyFile:this.keyFile,key:this.key,additionalClaims:{target_audience:a},transporter:this.transporter});if(await b.getToken({forceRefresh:!0}),!b.idToken)throw Error("Unknown error: Failed to fetch ID token");return b.idToken}hasUserScopes(){return!!this.scopes&&this.scopes.length>0}hasAnyScopes(){return!!this.scopes&&!!(this.scopes.length>0)||!!this.defaultScopes&&!!(this.defaultScopes.length>0)}authorize(a){if(!a)return this.authorizeAsync();this.authorizeAsync().then(b=>a(null,b),a)}async authorizeAsync(){let a=await this.refreshToken();if(!a)throw Error("No result returned");return this.credentials=a.tokens,this.credentials.refresh_token="jwt-placeholder",this.key=this.gtoken.key,this.email=this.gtoken.iss,a.tokens}async refreshTokenNoCache(a){let b=this.createGToken(),c={access_token:(await b.getToken({forceRefresh:this.isTokenExpiring()})).access_token,token_type:"Bearer",expiry_date:b.expiresAt,id_token:b.idToken};return this.emit("tokens",c),{res:null,tokens:c}}createGToken(){return this.gtoken||(this.gtoken=new d.GoogleToken({iss:this.email,sub:this.subject,scope:this.scopes||this.defaultScopes,keyFile:this.keyFile,key:this.key,additionalClaims:this.additionalClaims,transporter:this.transporter})),this.gtoken}fromJSON(a){if(!a)throw Error("Must pass in a JSON object containing the service account auth settings.");if(!a.client_email)throw Error("The incoming JSON object does not contain a client_email field");if(!a.private_key)throw Error("The incoming JSON object does not contain a private_key field");this.email=a.client_email,this.key=a.private_key,this.keyId=a.private_key_id,this.projectId=a.project_id,this.quotaProjectId=a.quota_project_id,this.universeDomain=a.universe_domain||this.universeDomain}fromStream(a,b){if(!b)return this.fromStreamAsync(a);this.fromStreamAsync(a).then(()=>b(),b)}fromStreamAsync(a){return new Promise((b,c)=>{if(!a)throw Error("Must pass in a stream containing the service account auth settings.");let d="";a.setEncoding("utf8").on("error",c).on("data",a=>d+=a).on("end",()=>{try{let a=JSON.parse(d);this.fromJSON(a),b()}catch(a){c(a)}})})}fromAPIKey(a){if("string"!=typeof a)throw Error("Must provide an API Key string.");this.apiKey=a}async getCredentials(){if(this.key)return{private_key:this.key,client_email:this.email};if(this.keyFile){let a=this.createGToken(),b=await a.getCredentials(this.keyFile);return{private_key:b.privateKey,client_email:b.clientEmail}}throw Error("A key or a keyFile must be provided to getCredentials.")}}c.JWT=h},85014,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.UserRefreshClient=c.USER_REFRESH_ACCOUNT_TYPE=void 0;let d=a.r(31442),e=a.r(45706);c.USER_REFRESH_ACCOUNT_TYPE="authorized_user";class f extends d.OAuth2Client{constructor(a,b,c,d,e){const f=a&&"object"==typeof a?a:{clientId:a,clientSecret:b,refreshToken:c,eagerRefreshThresholdMillis:d,forceRefreshOnFailure:e};super(f),this._refreshToken=f.refreshToken,this.credentials.refresh_token=f.refreshToken}async refreshTokenNoCache(a){return super.refreshTokenNoCache(this._refreshToken)}async fetchIdToken(a){return(await this.transporter.request({...f.RETRY_CONFIG,url:this.endpoints.oauth2TokenUrl,headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",data:(0,e.stringify)({client_id:this._clientId,client_secret:this._clientSecret,grant_type:"refresh_token",refresh_token:this._refreshToken,target_audience:a})})).data.id_token}fromJSON(a){if(!a)throw Error("Must pass in a JSON object containing the user refresh token");if("authorized_user"!==a.type)throw Error('The incoming JSON object does not have the "authorized_user" type');if(!a.client_id)throw Error("The incoming JSON object does not contain a client_id field");if(!a.client_secret)throw Error("The incoming JSON object does not contain a client_secret field");if(!a.refresh_token)throw Error("The incoming JSON object does not contain a refresh_token field");this._clientId=a.client_id,this._clientSecret=a.client_secret,this._refreshToken=a.refresh_token,this.credentials.refresh_token=a.refresh_token,this.quotaProjectId=a.quota_project_id,this.universeDomain=a.universe_domain||this.universeDomain}fromStream(a,b){if(!b)return this.fromStreamAsync(a);this.fromStreamAsync(a).then(()=>b(),b)}async fromStreamAsync(a){return new Promise((b,c)=>{if(!a)return c(Error("Must pass in a stream containing the user refresh token."));let d="";a.setEncoding("utf8").on("error",c).on("data",a=>d+=a).on("end",()=>{try{let a=JSON.parse(d);return this.fromJSON(a),b()}catch(a){return c(a)}})})}static fromJSON(a){let b=new f;return b.fromJSON(a),b}}c.UserRefreshClient=f},28069,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.Impersonated=c.IMPERSONATED_ACCOUNT_TYPE=void 0;let d=a.r(31442),e=a.r(48376),f=a.r(63100);c.IMPERSONATED_ACCOUNT_TYPE="impersonated_service_account";class g extends d.OAuth2Client{constructor(a={}){var b,c,e,g,h,i;if(super(a),this.credentials={expiry_date:1,refresh_token:"impersonated-placeholder"},this.sourceClient=null!=(b=a.sourceClient)?b:new d.OAuth2Client,this.targetPrincipal=null!=(c=a.targetPrincipal)?c:"",this.delegates=null!=(e=a.delegates)?e:[],this.targetScopes=null!=(g=a.targetScopes)?g:[],this.lifetime=null!=(h=a.lifetime)?h:3600,(0,f.originalOrCamelOptions)(a).get("universe_domain")){if(this.sourceClient.universeDomain!==this.universeDomain)throw RangeError(`Universe domain ${this.sourceClient.universeDomain} in source credentials does not match ${this.universeDomain} universe domain set for impersonated credentials.`)}else this.universeDomain=this.sourceClient.universeDomain;this.endpoint=null!=(i=a.endpoint)?i:`https://iamcredentials.${this.universeDomain}`}async sign(a){await this.sourceClient.getAccessToken();let b=`projects/-/serviceAccounts/${this.targetPrincipal}`,c=`${this.endpoint}/v1/${b}:signBlob`,d={delegates:this.delegates,payload:Buffer.from(a).toString("base64")};return(await this.sourceClient.request({...g.RETRY_CONFIG,url:c,data:d,method:"POST"})).data}getTargetPrincipal(){return this.targetPrincipal}async refreshToken(){var a,b,c,d,f,h;try{await this.sourceClient.getAccessToken();let a="projects/-/serviceAccounts/"+this.targetPrincipal,b=`${this.endpoint}/v1/${a}:generateAccessToken`,c={delegates:this.delegates,scope:this.targetScopes,lifetime:this.lifetime+"s"},d=await this.sourceClient.request({...g.RETRY_CONFIG,url:b,data:c,method:"POST"}),e=d.data;return this.credentials.access_token=e.accessToken,this.credentials.expiry_date=Date.parse(e.expireTime),{tokens:this.credentials,res:d}}catch(j){if(!(j instanceof Error))throw j;let g=0,i="";if(j instanceof e.GaxiosError&&(g=null==(c=null==(b=null==(a=null==j?void 0:j.response)?void 0:a.data)?void 0:b.error)?void 0:c.status,i=null==(h=null==(f=null==(d=null==j?void 0:j.response)?void 0:d.data)?void 0:f.error)?void 0:h.message),g&&i)throw j.message=`${g}: unable to impersonate: ${i}`,j;throw j.message=`unable to impersonate: ${j}`,j}}async fetchIdToken(a,b){var c,d;await this.sourceClient.getAccessToken();let e=`projects/-/serviceAccounts/${this.targetPrincipal}`,f=`${this.endpoint}/v1/${e}:generateIdToken`,h={delegates:this.delegates,audience:a,includeEmail:null==(c=null==b?void 0:b.includeEmail)||c,useEmailAzp:null==(d=null==b?void 0:b.includeEmail)||d};return(await this.sourceClient.request({...g.RETRY_CONFIG,url:f,data:h,method:"POST"})).data.token}}c.Impersonated=g},95924,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.OAuthClientAuthHandler=void 0,c.getErrorFromOAuthErrorResponse=function(a,b){let c=a.error,d=a.error_description,e=a.error_uri,f=`Error code ${c}`;void 0!==d&&(f+=`: ${d}`),void 0!==e&&(f+=` - ${e}`);let g=Error(f);if(b){let a=Object.keys(b);b.stack&&a.push("stack"),a.forEach(a=>{"message"!==a&&Object.defineProperty(g,a,{value:b[a],writable:!1,enumerable:!0})})}return g};let d=a.r(45706),e=a.r(15032),f=["PUT","POST","PATCH"];c.OAuthClientAuthHandler=class{constructor(a){this.clientAuthentication=a,this.crypto=(0,e.createCrypto)()}applyClientAuthenticationOptions(a,b){this.injectAuthenticatedHeaders(a,b),b||this.injectAuthenticatedRequestBody(a)}injectAuthenticatedHeaders(a,b){var c;if(b)a.headers=a.headers||{},Object.assign(a.headers,{Authorization:`Bearer ${b}}`});else if((null==(c=this.clientAuthentication)?void 0:c.confidentialClientType)==="basic"){a.headers=a.headers||{};let b=this.clientAuthentication.clientId,c=this.clientAuthentication.clientSecret||"",d=this.crypto.encodeBase64StringUtf8(`${b}:${c}`);Object.assign(a.headers,{Authorization:`Basic ${d}`})}}injectAuthenticatedRequestBody(a){var b;if((null==(b=this.clientAuthentication)?void 0:b.confidentialClientType)==="request-body"){let b=(a.method||"GET").toUpperCase();if(-1!==f.indexOf(b)){let b,c=a.headers||{};for(let a in c)if("content-type"===a.toLowerCase()&&c[a]){b=c[a].toLowerCase();break}if("application/x-www-form-urlencoded"===b){a.data=a.data||"";let b=d.parse(a.data);Object.assign(b,{client_id:this.clientAuthentication.clientId,client_secret:this.clientAuthentication.clientSecret||""}),a.data=d.stringify(b)}else if("application/json"===b)a.data=a.data||{},Object.assign(a.data,{client_id:this.clientAuthentication.clientId,client_secret:this.clientAuthentication.clientSecret||""});else throw Error(`${b} content-types are not supported with ${this.clientAuthentication.confidentialClientType} client authentication`)}else throw Error(`${b} HTTP method does not support ${this.clientAuthentication.confidentialClientType} client authentication`)}}static get RETRY_CONFIG(){return{retry:!0,retryConfig:{httpMethodsToRetry:["GET","PUT","POST","HEAD","OPTIONS","DELETE"]}}}}},10525,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.StsCredentials=void 0;let d=a.r(48376),e=a.r(45706),f=a.r(91633),g=a.r(95924);class h extends g.OAuthClientAuthHandler{constructor(a,b){super(b),this.tokenExchangeEndpoint=a,this.transporter=new f.DefaultTransporter}async exchangeToken(a,b,c){var f,i,j;let k={grant_type:a.grantType,resource:a.resource,audience:a.audience,scope:null==(f=a.scope)?void 0:f.join(" "),requested_token_type:a.requestedTokenType,subject_token:a.subjectToken,subject_token_type:a.subjectTokenType,actor_token:null==(i=a.actingParty)?void 0:i.actorToken,actor_token_type:null==(j=a.actingParty)?void 0:j.actorTokenType,options:c&&JSON.stringify(c)};Object.keys(k).forEach(a=>{void 0===k[a]&&delete k[a]});let l={"Content-Type":"application/x-www-form-urlencoded"};Object.assign(l,b||{});let m={...h.RETRY_CONFIG,url:this.tokenExchangeEndpoint.toString(),method:"POST",headers:l,data:e.stringify(k),responseType:"json"};this.applyClientAuthenticationOptions(m);try{let a=await this.transporter.request(m),b=a.data;return b.res=a,b}catch(a){if(a instanceof d.GaxiosError&&a.response)throw(0,g.getErrorFromOAuthErrorResponse)(a.response.data,a);throw a}}}c.StsCredentials=h},75467,(a,b,c)=>{"use strict";var d,e,f,g=a.e&&a.e.__classPrivateFieldGet||function(a,b,c,d){if("a"===c&&!d)throw TypeError("Private accessor was defined without a getter");if("function"==typeof b?a!==b||!d:!b.has(a))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===c?d:"a"===c?d.call(a):d?d.value:b.get(a)},h=a.e&&a.e.__classPrivateFieldSet||function(a,b,c,d,e){if("m"===d)throw TypeError("Private method is not writable");if("a"===d&&!e)throw TypeError("Private accessor was defined without a setter");if("function"==typeof b?a!==b||!e:!b.has(a))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===d?e.call(a,c):e?e.value=c:b.set(a,c),c};Object.defineProperty(c,"__esModule",{value:!0}),c.BaseExternalAccountClient=c.DEFAULT_UNIVERSE=c.CLOUD_RESOURCE_MANAGER=c.EXTERNAL_ACCOUNT_TYPE=c.EXPIRATION_TIME_OFFSET=void 0;let i=a.r(88947),j=a.r(73910),k=a.r(10525),l=a.r(63100),m="https://www.googleapis.com/auth/cloud-platform";c.EXPIRATION_TIME_OFFSET=3e5,c.EXTERNAL_ACCOUNT_TYPE="external_account",c.CLOUD_RESOURCE_MANAGER="https://cloudresourcemanager.googleapis.com/v1/projects/";let n=a.r(70108);var o=a.r(73910);Object.defineProperty(c,"DEFAULT_UNIVERSE",{enumerable:!0,get:function(){return o.DEFAULT_UNIVERSE}});class p extends j.AuthClient{constructor(a,b){var f;super({...a,...b}),d.add(this),e.set(this,null);const g=(0,l.originalOrCamelOptions)(a),h=g.get("type");if(h&&h!==c.EXTERNAL_ACCOUNT_TYPE)throw Error(`Expected "${c.EXTERNAL_ACCOUNT_TYPE}" type but received "${a.type}"`);const i=g.get("client_id"),j=g.get("client_secret"),n=null!=(f=g.get("token_url"))?f:"https://sts.{universeDomain}/v1/token".replace("{universeDomain}",this.universeDomain),o=g.get("subject_token_type"),p=g.get("workforce_pool_user_project"),q=g.get("service_account_impersonation_url"),r=g.get("service_account_impersonation"),s=(0,l.originalOrCamelOptions)(r).get("token_lifetime_seconds");this.cloudResourceManagerURL=new URL(g.get("cloud_resource_manager_url")||`https://cloudresourcemanager.${this.universeDomain}/v1/projects/`),i&&(this.clientAuth={confidentialClientType:"basic",clientId:i,clientSecret:j}),this.stsCredential=new k.StsCredentials(n,this.clientAuth),this.scopes=g.get("scopes")||[m],this.cachedAccessToken=null,this.audience=g.get("audience"),this.subjectTokenType=o,this.workforcePoolUserProject=p;const t=RegExp("//iam\\.googleapis\\.com/locations/[^/]+/workforcePools/[^/]+/providers/.+");if(this.workforcePoolUserProject&&!this.audience.match(t))throw Error("workforcePoolUserProject should not be set for non-workforce pool credentials.");this.serviceAccountImpersonationUrl=q,this.serviceAccountImpersonationLifetime=s,this.serviceAccountImpersonationLifetime?this.configLifetimeRequested=!0:(this.configLifetimeRequested=!1,this.serviceAccountImpersonationLifetime=3600),this.projectNumber=this.getProjectNumber(this.audience),this.supplierContext={audience:this.audience,subjectTokenType:this.subjectTokenType,transporter:this.transporter}}getServiceAccountEmail(){var a;if(this.serviceAccountImpersonationUrl){if(this.serviceAccountImpersonationUrl.length>256)throw RangeError(`URL is too long: ${this.serviceAccountImpersonationUrl}`);let b=/serviceAccounts\/(?<email>[^:]+):generateAccessToken$/.exec(this.serviceAccountImpersonationUrl);return(null==(a=null==b?void 0:b.groups)?void 0:a.email)||null}return null}setCredentials(a){super.setCredentials(a),this.cachedAccessToken=a}async getAccessToken(){return(!this.cachedAccessToken||this.isExpired(this.cachedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedAccessToken.access_token,res:this.cachedAccessToken.res}}async getRequestHeaders(){let a=await this.getAccessToken(),b={Authorization:`Bearer ${a.token}`};return this.addSharedMetadataHeaders(b)}request(a,b){if(!b)return this.requestAsync(a);this.requestAsync(a).then(a=>b(null,a),a=>b(a,a.response))}async getProjectId(){let a=this.projectNumber||this.workforcePoolUserProject;if(this.projectId)return this.projectId;if(a){let b=await this.getRequestHeaders(),c=await this.transporter.request({...p.RETRY_CONFIG,headers:b,url:`${this.cloudResourceManagerURL.toString()}${a}`,responseType:"json"});return this.projectId=c.data.projectId,this.projectId}return null}async requestAsync(a,b=!1){let c;try{let b=await this.getRequestHeaders();a.headers=a.headers||{},b&&b["x-goog-user-project"]&&(a.headers["x-goog-user-project"]=b["x-goog-user-project"]),b&&b.Authorization&&(a.headers.Authorization=b.Authorization),c=await this.transporter.request(a)}catch(d){let c=d.response;if(c){let d=c.status,e=c.config.data instanceof i.Readable;if(!b&&(401===d||403===d)&&!e&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(a,!0)}throw d}return c}async refreshAccessTokenAsync(){h(this,e,g(this,e,"f")||g(this,d,"m",f).call(this),"f");try{return await g(this,e,"f")}finally{h(this,e,null,"f")}}getProjectNumber(a){let b=a.match(/\/projects\/([^/]+)/);return b?b[1]:null}async getImpersonatedAccessToken(a){let b={...p.RETRY_CONFIG,url:this.serviceAccountImpersonationUrl,method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},data:{scope:this.getScopesArray(),lifetime:this.serviceAccountImpersonationLifetime+"s"},responseType:"json"},c=await this.transporter.request(b),d=c.data;return{access_token:d.accessToken,expiry_date:new Date(d.expireTime).getTime(),res:c}}isExpired(a){let b=new Date().getTime();return!!a.expiry_date&&b>=a.expiry_date-this.eagerRefreshThresholdMillis}getScopesArray(){return"string"==typeof this.scopes?[this.scopes]:this.scopes||[m]}getMetricsHeaderValue(){let a=process.version.replace(/^v/,""),b=void 0!==this.serviceAccountImpersonationUrl,c=this.credentialSourceType?this.credentialSourceType:"unknown";return`gl-node/${a} auth/${n.version} google-byoid-sdk source/${c} sa-impersonation/${b} config-lifetime/${this.configLifetimeRequested}`}}c.BaseExternalAccountClient=p,e=new WeakMap,d=new WeakSet,f=async function(){let a=await this.retrieveSubjectToken(),b={grantType:"urn:ietf:params:oauth:grant-type:token-exchange",audience:this.audience,requestedTokenType:"urn:ietf:params:oauth:token-type:access_token",subjectToken:a,subjectTokenType:this.subjectTokenType,scope:this.serviceAccountImpersonationUrl?[m]:this.getScopesArray()},c=!this.clientAuth&&this.workforcePoolUserProject?{userProject:this.workforcePoolUserProject}:void 0,d={"x-goog-api-client":this.getMetricsHeaderValue()},e=await this.stsCredential.exchangeToken(b,d,c);return this.serviceAccountImpersonationUrl?this.cachedAccessToken=await this.getImpersonatedAccessToken(e.access_token):e.expires_in?this.cachedAccessToken={access_token:e.access_token,expiry_date:new Date().getTime()+1e3*e.expires_in,res:e.res}:this.cachedAccessToken={access_token:e.access_token,res:e.res},this.credentials={},Object.assign(this.credentials,this.cachedAccessToken),delete this.credentials.res,this.emit("tokens",{refresh_token:null,expiry_date:this.cachedAccessToken.expiry_date,access_token:this.cachedAccessToken.access_token,token_type:"Bearer",id_token:null}),this.cachedAccessToken}},60907,(a,b,c)=>{"use strict";var d,e,f;Object.defineProperty(c,"__esModule",{value:!0}),c.FileSubjectTokenSupplier=void 0;let g=a.r(24361),h=a.r(22734),i=(0,g.promisify)(null!=(d=h.readFile)?d:()=>{}),j=(0,g.promisify)(null!=(e=h.realpath)?e:()=>{}),k=(0,g.promisify)(null!=(f=h.lstat)?f:()=>{});c.FileSubjectTokenSupplier=class{constructor(a){this.filePath=a.filePath,this.formatType=a.formatType,this.subjectTokenFieldName=a.subjectTokenFieldName}async getSubjectToken(a){let b,c=this.filePath;try{if(c=await j(c),!(await k(c)).isFile())throw Error()}catch(a){throw a instanceof Error&&(a.message=`The file at ${c} does not exist, or it is not a file. ${a.message}`),a}let d=await i(c,{encoding:"utf8"});if("text"===this.formatType?b=d:"json"===this.formatType&&this.subjectTokenFieldName&&(b=JSON.parse(d)[this.subjectTokenFieldName]),!b)throw Error("Unable to parse the subject_token from the credential_source file");return b}}},9753,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.UrlSubjectTokenSupplier=void 0,c.UrlSubjectTokenSupplier=class{constructor(a){this.url=a.url,this.formatType=a.formatType,this.subjectTokenFieldName=a.subjectTokenFieldName,this.headers=a.headers,this.additionalGaxiosOptions=a.additionalGaxiosOptions}async getSubjectToken(a){let b,c={...this.additionalGaxiosOptions,url:this.url,method:"GET",headers:this.headers,responseType:this.formatType};if("text"===this.formatType?b=(await a.transporter.request(c)).data:"json"===this.formatType&&this.subjectTokenFieldName&&(b=(await a.transporter.request(c)).data[this.subjectTokenFieldName]),!b)throw Error("Unable to parse the subject_token from the credential_source URL");return b}}},6265,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.IdentityPoolClient=void 0;let d=a.r(75467),e=a.r(63100),f=a.r(60907),g=a.r(9753);class h extends d.BaseExternalAccountClient{constructor(a,b){super(a,b);const c=(0,e.originalOrCamelOptions)(a),d=c.get("credential_source"),i=c.get("subject_token_supplier");if(!d&&!i)throw Error("A credential source or subject token supplier must be specified.");if(d&&i)throw Error("Only one of credential source or subject token supplier can be specified.");if(i)this.subjectTokenSupplier=i,this.credentialSourceType="programmatic";else{const a=(0,e.originalOrCamelOptions)(d),b=(0,e.originalOrCamelOptions)(a.get("format")),c=b.get("type")||"text",i=b.get("subject_token_field_name");if("json"!==c&&"text"!==c)throw Error(`Invalid credential_source format "${c}"`);if("json"===c&&!i)throw Error("Missing subject_token_field_name for JSON credential_source format");const j=a.get("file"),k=a.get("url"),l=a.get("headers");if(j&&k)throw Error('No valid Identity Pool "credential_source" provided, must be either file or url.');if(j&&!k)this.credentialSourceType="file",this.subjectTokenSupplier=new f.FileSubjectTokenSupplier({filePath:j,formatType:c,subjectTokenFieldName:i});else if(!j&&k)this.credentialSourceType="url",this.subjectTokenSupplier=new g.UrlSubjectTokenSupplier({url:k,formatType:c,subjectTokenFieldName:i,headers:l,additionalGaxiosOptions:h.RETRY_CONFIG});else throw Error('No valid Identity Pool "credential_source" provided, must be either file or url.')}}async retrieveSubjectToken(){return this.subjectTokenSupplier.getSubjectToken(this.supplierContext)}}c.IdentityPoolClient=h},36674,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.AwsRequestSigner=void 0;let d=a.r(15032),e="AWS4-HMAC-SHA256";async function f(a,b,c){return await a.signWithHmacSha256(b,c)}async function g(a,b,c,d,e){let g=await f(a,`AWS4${b}`,c),h=await f(a,g,d),i=await f(a,h,e);return await f(a,i,"aws4_request")}async function h(a){let b=a.additionalAmzHeaders||{},c=a.requestPayload||"",h=a.host.split(".")[0],i=new Date,j=i.toISOString().replace(/[-:]/g,"").replace(/\.[0-9]+/,""),k=i.toISOString().replace(/[-]/g,"").replace(/T.*/,""),l={};Object.keys(b).forEach(a=>{l[a.toLowerCase()]=b[a]}),a.securityCredentials.token&&(l["x-amz-security-token"]=a.securityCredentials.token);let m=Object.assign({host:a.host},l.date?{}:{"x-amz-date":j},l),n="",o=Object.keys(m).sort();o.forEach(a=>{n+=`${a}:${m[a]}
`});let p=o.join(";"),q=await a.crypto.sha256DigestHex(c),r=`${a.method}
${a.canonicalUri}
${a.canonicalQuerystring}
${n}
${p}
${q}`,s=`${k}/${a.region}/${h}/aws4_request`,t=`${e}
${j}
${s}
`+await a.crypto.sha256DigestHex(r),u=await g(a.crypto,a.securityCredentials.secretAccessKey,k,a.region,h),v=await f(a.crypto,u,t),w=`${e} Credential=${a.securityCredentials.accessKeyId}/${s}, SignedHeaders=${p}, Signature=${(0,d.fromArrayBufferToHex)(v)}`;return{amzDate:l.date?void 0:j,authorizationHeader:w,canonicalQuerystring:a.canonicalQuerystring}}c.AwsRequestSigner=class{constructor(a,b){this.getCredentials=a,this.region=b,this.crypto=(0,d.createCrypto)()}async getRequestOptions(a){if(!a.url)throw Error('"url" is required in "amzOptions"');let b="object"==typeof a.data?JSON.stringify(a.data):a.data,c=a.url,d=a.method||"GET",e=a.body||b,f=a.headers,g=await this.getCredentials(),i=new URL(c),j=await h({crypto:this.crypto,host:i.host,canonicalUri:i.pathname,canonicalQuerystring:i.search.substr(1),method:d,region:this.region,securityCredentials:g,requestPayload:e,additionalAmzHeaders:f}),k=Object.assign(j.amzDate?{"x-amz-date":j.amzDate}:{},{Authorization:j.authorizationHeader,host:i.host},f||{});g.token&&Object.assign(k,{"x-amz-security-token":g.token});let l={url:c,method:d,headers:k};return void 0!==e&&(l.body=e),l}}},15663,(a,b,c)=>{"use strict";var d,e,f,g,h,i,j=a.e&&a.e.__classPrivateFieldGet||function(a,b,c,d){if("a"===c&&!d)throw TypeError("Private accessor was defined without a getter");if("function"==typeof b?a!==b||!d:!b.has(a))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===c?d:"a"===c?d.call(a):d?d.value:b.get(a)};Object.defineProperty(c,"__esModule",{value:!0}),c.DefaultAwsSecurityCredentialsSupplier=void 0,c.DefaultAwsSecurityCredentialsSupplier=class{constructor(a){d.add(this),this.regionUrl=a.regionUrl,this.securityCredentialsUrl=a.securityCredentialsUrl,this.imdsV2SessionTokenUrl=a.imdsV2SessionTokenUrl,this.additionalGaxiosOptions=a.additionalGaxiosOptions}async getAwsRegion(a){if(j(this,d,"a",h))return j(this,d,"a",h);let b={};if(!j(this,d,"a",h)&&this.imdsV2SessionTokenUrl&&(b["x-aws-ec2-metadata-token"]=await j(this,d,"m",e).call(this,a.transporter)),!this.regionUrl)throw Error('Unable to determine AWS region due to missing "options.credential_source.region_url"');let c={...this.additionalGaxiosOptions,url:this.regionUrl,method:"GET",responseType:"text",headers:b},f=await a.transporter.request(c);return f.data.substr(0,f.data.length-1)}async getAwsSecurityCredentials(a){if(j(this,d,"a",i))return j(this,d,"a",i);let b={};this.imdsV2SessionTokenUrl&&(b["x-aws-ec2-metadata-token"]=await j(this,d,"m",e).call(this,a.transporter));let c=await j(this,d,"m",f).call(this,b,a.transporter),h=await j(this,d,"m",g).call(this,c,b,a.transporter);return{accessKeyId:h.AccessKeyId,secretAccessKey:h.SecretAccessKey,token:h.Token}}},d=new WeakSet,e=async function(a){let b={...this.additionalGaxiosOptions,url:this.imdsV2SessionTokenUrl,method:"PUT",responseType:"text",headers:{"x-aws-ec2-metadata-token-ttl-seconds":"300"}};return(await a.request(b)).data},f=async function(a,b){if(!this.securityCredentialsUrl)throw Error('Unable to determine AWS role name due to missing "options.credential_source.url"');let c={...this.additionalGaxiosOptions,url:this.securityCredentialsUrl,method:"GET",responseType:"text",headers:a};return(await b.request(c)).data},g=async function(a,b,c){return(await c.request({...this.additionalGaxiosOptions,url:`${this.securityCredentialsUrl}/${a}`,responseType:"json",headers:b})).data},h=function(){return process.env.AWS_REGION||process.env.AWS_DEFAULT_REGION||null},i=function(){return process.env.AWS_ACCESS_KEY_ID&&process.env.AWS_SECRET_ACCESS_KEY?{accessKeyId:process.env.AWS_ACCESS_KEY_ID,secretAccessKey:process.env.AWS_SECRET_ACCESS_KEY,token:process.env.AWS_SESSION_TOKEN}:null}},95343,(a,b,c)=>{"use strict";var d,e,f=a.e&&a.e.__classPrivateFieldGet||function(a,b,c,d){if("a"===c&&!d)throw TypeError("Private accessor was defined without a getter");if("function"==typeof b?a!==b||!d:!b.has(a))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===c?d:"a"===c?d.call(a):d?d.value:b.get(a)};Object.defineProperty(c,"__esModule",{value:!0}),c.AwsClient=void 0;let g=a.r(36674),h=a.r(75467),i=a.r(15663),j=a.r(63100);class k extends h.BaseExternalAccountClient{constructor(a,b){super(a,b);const c=(0,j.originalOrCamelOptions)(a),g=c.get("credential_source"),h=c.get("aws_security_credentials_supplier");if(!g&&!h)throw Error("A credential source or AWS security credentials supplier must be specified.");if(g&&h)throw Error("Only one of credential source or AWS security credentials supplier can be specified.");if(h)this.awsSecurityCredentialsSupplier=h,this.regionalCredVerificationUrl=f(d,d,"f",e),this.credentialSourceType="programmatic";else{const a=(0,j.originalOrCamelOptions)(g);this.environmentId=a.get("environment_id");const b=a.get("region_url"),c=a.get("url"),d=a.get("imdsv2_session_token_url");this.awsSecurityCredentialsSupplier=new i.DefaultAwsSecurityCredentialsSupplier({regionUrl:b,securityCredentialsUrl:c,imdsV2SessionTokenUrl:d}),this.regionalCredVerificationUrl=a.get("regional_cred_verification_url"),this.credentialSourceType="aws",this.validateEnvironmentId()}this.awsRequestSigner=null,this.region=""}validateEnvironmentId(){var a;let b=null==(a=this.environmentId)?void 0:a.match(/^(aws)(\d+)$/);if(b&&this.regionalCredVerificationUrl){if(1!==parseInt(b[2],10))throw Error(`aws version "${b[2]}" is not supported in the current build.`)}else throw Error('No valid AWS "credential_source" provided')}async retrieveSubjectToken(){this.awsRequestSigner||(this.region=await this.awsSecurityCredentialsSupplier.getAwsRegion(this.supplierContext),this.awsRequestSigner=new g.AwsRequestSigner(async()=>this.awsSecurityCredentialsSupplier.getAwsSecurityCredentials(this.supplierContext),this.region));let a=await this.awsRequestSigner.getRequestOptions({...d.RETRY_CONFIG,url:this.regionalCredVerificationUrl.replace("{region}",this.region),method:"POST"}),b=[],c=Object.assign({"x-goog-cloud-target-resource":this.audience},a.headers);for(let a in c)b.push({key:a,value:c[a]});return encodeURIComponent(JSON.stringify({url:a.url,method:a.method,headers:b}))}}c.AwsClient=k,d=k,e={value:"https://sts.{region}.amazonaws.com?Action=GetCallerIdentity&Version=2011-06-15"},k.AWS_EC2_METADATA_IPV4_ADDRESS="169.254.169.254",k.AWS_EC2_METADATA_IPV6_ADDRESS="fd00:ec2::254"},77680,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.InvalidSubjectTokenError=c.InvalidMessageFieldError=c.InvalidCodeFieldError=c.InvalidTokenTypeFieldError=c.InvalidExpirationTimeFieldError=c.InvalidSuccessFieldError=c.InvalidVersionFieldError=c.ExecutableResponseError=c.ExecutableResponse=void 0;let d="urn:ietf:params:oauth:token-type:saml2",e="urn:ietf:params:oauth:token-type:id_token",f="urn:ietf:params:oauth:token-type:jwt";c.ExecutableResponse=class{constructor(a){if(!a.version)throw new h("Executable response must contain a 'version' field.");if(void 0===a.success)throw new i("Executable response must contain a 'success' field.");if(this.version=a.version,this.success=a.success,this.success){if(this.expirationTime=a.expiration_time,this.tokenType=a.token_type,this.tokenType!==d&&this.tokenType!==e&&this.tokenType!==f)throw new j(`Executable response must contain a 'token_type' field when successful and it must be one of ${e}, ${f}, or ${d}.`);if(this.tokenType===d){if(!a.saml_response)throw new m(`Executable response must contain a 'saml_response' field when token_type=${d}.`);this.subjectToken=a.saml_response}else{if(!a.id_token)throw new m(`Executable response must contain a 'id_token' field when token_type=${e} or ${f}.`);this.subjectToken=a.id_token}}else{if(!a.code)throw new k("Executable response must contain a 'code' field when unsuccessful.");if(!a.message)throw new l("Executable response must contain a 'message' field when unsuccessful.");this.errorCode=a.code,this.errorMessage=a.message}}isValid(){return!this.isExpired()&&this.success}isExpired(){return void 0!==this.expirationTime&&this.expirationTime<Math.round(Date.now()/1e3)}};class g extends Error{constructor(a){super(a),Object.setPrototypeOf(this,new.target.prototype)}}c.ExecutableResponseError=g;class h extends g{}c.InvalidVersionFieldError=h;class i extends g{}c.InvalidSuccessFieldError=i,c.InvalidExpirationTimeFieldError=class extends g{};class j extends g{}c.InvalidTokenTypeFieldError=j;class k extends g{}c.InvalidCodeFieldError=k;class l extends g{}c.InvalidMessageFieldError=l;class m extends g{}c.InvalidSubjectTokenError=m},83212,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.PluggableAuthHandler=void 0;let d=a.r(31294),e=a.r(77680),f=a.r(33405),g=a.r(22734);class h{constructor(a){if(!a.command)throw Error("No command provided.");if(this.commandComponents=h.parseCommand(a.command),this.timeoutMillis=a.timeoutMillis,!this.timeoutMillis)throw Error("No timeoutMillis provided.");this.outputFile=a.outputFile}retrieveResponseFromExecutable(a){return new Promise((b,c)=>{let g=f.spawn(this.commandComponents[0],this.commandComponents.slice(1),{env:{...process.env,...Object.fromEntries(a)}}),h="";g.stdout.on("data",a=>{h+=a}),g.stderr.on("data",a=>{h+=a});let i=setTimeout(()=>(g.removeAllListeners(),g.kill(),c(Error("The executable failed to finish within the timeout specified."))),this.timeoutMillis);g.on("close",a=>{if(clearTimeout(i),0!==a)return c(new d.ExecutableError(h,a.toString()));try{let a=JSON.parse(h),c=new e.ExecutableResponse(a);return b(c)}catch(a){if(a instanceof e.ExecutableResponseError)return c(a);return c(new e.ExecutableResponseError(`The executable returned an invalid response: ${h}`))}})})}async retrieveCachedResponse(){let a;if(!this.outputFile||0===this.outputFile.length)return;try{a=await g.promises.realpath(this.outputFile)}catch(a){return}if(!(await g.promises.lstat(a)).isFile())return;let b=await g.promises.readFile(a,{encoding:"utf8"});if(""!==b)try{let a=JSON.parse(b);if(new e.ExecutableResponse(a).isValid())return new e.ExecutableResponse(a);return}catch(a){if(a instanceof e.ExecutableResponseError)throw a;throw new e.ExecutableResponseError(`The output file contained an invalid response: ${b}`)}}static parseCommand(a){let b=a.match(/(?:[^\s"]+|"[^"]*")+/g);if(!b)throw Error(`Provided command: "${a}" could not be parsed.`);for(let a=0;a<b.length;a++)'"'===b[a][0]&&'"'===b[a].slice(-1)&&(b[a]=b[a].slice(1,-1));return b}}c.PluggableAuthHandler=h},31294,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.PluggableAuthClient=c.ExecutableError=void 0;let d=a.r(75467),e=a.r(77680),f=a.r(83212);class g extends Error{constructor(a,b){super(`The executable failed with exit code: ${b} and error message: ${a}.`),this.code=b,Object.setPrototypeOf(this,new.target.prototype)}}c.ExecutableError=g;class h extends d.BaseExternalAccountClient{constructor(a,b){if(super(a,b),!a.credential_source.executable||(this.command=a.credential_source.executable.command,!this.command))throw Error('No valid Pluggable Auth "credential_source" provided.');if(void 0===a.credential_source.executable.timeout_millis)this.timeoutMillis=3e4;else if(this.timeoutMillis=a.credential_source.executable.timeout_millis,this.timeoutMillis<5e3||this.timeoutMillis>12e4)throw Error("Timeout must be between 5000120000 milliseconds.");this.outputFile=a.credential_source.executable.output_file,this.handler=new f.PluggableAuthHandler({command:this.command,timeoutMillis:this.timeoutMillis,outputFile:this.outputFile}),this.credentialSourceType="executable"}async retrieveSubjectToken(){let a;if("1"!==process.env.GOOGLE_EXTERNAL_ACCOUNT_ALLOW_EXECUTABLES)throw Error("Pluggable Auth executables need to be explicitly allowed to run by setting the GOOGLE_EXTERNAL_ACCOUNT_ALLOW_EXECUTABLES environment Variable to 1.");if(this.outputFile&&(a=await this.handler.retrieveCachedResponse()),!a){let b=new Map;b.set("GOOGLE_EXTERNAL_ACCOUNT_AUDIENCE",this.audience),b.set("GOOGLE_EXTERNAL_ACCOUNT_TOKEN_TYPE",this.subjectTokenType),b.set("GOOGLE_EXTERNAL_ACCOUNT_INTERACTIVE","0"),this.outputFile&&b.set("GOOGLE_EXTERNAL_ACCOUNT_OUTPUT_FILE",this.outputFile);let c=this.getServiceAccountEmail();c&&b.set("GOOGLE_EXTERNAL_ACCOUNT_IMPERSONATED_EMAIL",c),a=await this.handler.retrieveResponseFromExecutable(b)}if(a.version>1)throw Error("Version of executable is not currently supported, maximum supported version is 1.");if(!a.success)throw new g(a.errorMessage,a.errorCode);if(this.outputFile&&!a.expirationTime)throw new e.InvalidExpirationTimeFieldError("The executable response must contain the `expiration_time` field for successful responses when an output_file has been specified in the configuration.");if(a.isExpired())throw Error("Executable response is expired.");return a.subjectToken}}c.PluggableAuthClient=h},64541,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ExternalAccountClient=void 0;let d=a.r(75467),e=a.r(6265),f=a.r(95343),g=a.r(31294);c.ExternalAccountClient=class{constructor(){throw Error("ExternalAccountClients should be initialized via: ExternalAccountClient.fromJSON(), directly via explicit constructors, eg. new AwsClient(options), new IdentityPoolClient(options), newPluggableAuthClientOptions, or via new GoogleAuth(options).getClient()")}static fromJSON(a,b){var c,h;return a&&a.type===d.EXTERNAL_ACCOUNT_TYPE?(null==(c=a.credential_source)?void 0:c.environment_id)?new f.AwsClient(a,b):(null==(h=a.credential_source)?void 0:h.executable)?new g.PluggableAuthClient(a,b):new e.IdentityPoolClient(a,b):null}}},71253,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ExternalAccountAuthorizedUserClient=c.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE=void 0;let d=a.r(73910),e=a.r(95924),f=a.r(48376),g=a.r(88947),h=a.r(75467);c.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE="external_account_authorized_user";class i extends e.OAuthClientAuthHandler{constructor(a,b,c){super(c),this.url=a,this.transporter=b}async refreshToken(a,b){let c=new URLSearchParams({grant_type:"refresh_token",refresh_token:a}),d={"Content-Type":"application/x-www-form-urlencoded",...b},g={...i.RETRY_CONFIG,url:this.url,method:"POST",headers:d,data:c.toString(),responseType:"json"};this.applyClientAuthenticationOptions(g);try{let a=await this.transporter.request(g),b=a.data;return b.res=a,b}catch(a){if(a instanceof f.GaxiosError&&a.response)throw(0,e.getErrorFromOAuthErrorResponse)(a.response.data,a);throw a}}}class j extends d.AuthClient{constructor(a,b){var c;super({...a,...b}),a.universe_domain&&(this.universeDomain=a.universe_domain),this.refreshToken=a.refresh_token;const d={confidentialClientType:"basic",clientId:a.client_id,clientSecret:a.client_secret};this.externalAccountAuthorizedUserHandler=new i(null!=(c=a.token_url)?c:"https://sts.{universeDomain}/v1/oauthtoken".replace("{universeDomain}",this.universeDomain),this.transporter,d),this.cachedAccessToken=null,this.quotaProjectId=a.quota_project_id,"number"!=typeof(null==b?void 0:b.eagerRefreshThresholdMillis)?this.eagerRefreshThresholdMillis=h.EXPIRATION_TIME_OFFSET:this.eagerRefreshThresholdMillis=b.eagerRefreshThresholdMillis,this.forceRefreshOnFailure=!!(null==b?void 0:b.forceRefreshOnFailure)}async getAccessToken(){return(!this.cachedAccessToken||this.isExpired(this.cachedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedAccessToken.access_token,res:this.cachedAccessToken.res}}async getRequestHeaders(){let a=await this.getAccessToken(),b={Authorization:`Bearer ${a.token}`};return this.addSharedMetadataHeaders(b)}request(a,b){if(!b)return this.requestAsync(a);this.requestAsync(a).then(a=>b(null,a),a=>b(a,a.response))}async requestAsync(a,b=!1){let c;try{let b=await this.getRequestHeaders();a.headers=a.headers||{},b&&b["x-goog-user-project"]&&(a.headers["x-goog-user-project"]=b["x-goog-user-project"]),b&&b.Authorization&&(a.headers.Authorization=b.Authorization),c=await this.transporter.request(a)}catch(d){let c=d.response;if(c){let d=c.status,e=c.config.data instanceof g.Readable;if(!b&&(401===d||403===d)&&!e&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(a,!0)}throw d}return c}async refreshAccessTokenAsync(){let a=await this.externalAccountAuthorizedUserHandler.refreshToken(this.refreshToken);return this.cachedAccessToken={access_token:a.access_token,expiry_date:new Date().getTime()+1e3*a.expires_in,res:a.res},void 0!==a.refresh_token&&(this.refreshToken=a.refresh_token),this.cachedAccessToken}isExpired(a){let b=new Date().getTime();return!!a.expiry_date&&b>=a.expiry_date-this.eagerRefreshThresholdMillis}}c.ExternalAccountAuthorizedUserClient=j},15593,(a,b,c)=>{"use strict";var d,e,f,g,h=a.e&&a.e.__classPrivateFieldGet||function(a,b,c,d){if("a"===c&&!d)throw TypeError("Private accessor was defined without a getter");if("function"==typeof b?a!==b||!d:!b.has(a))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===c?d:"a"===c?d.call(a):d?d.value:b.get(a)},i=a.e&&a.e.__classPrivateFieldSet||function(a,b,c,d,e){if("m"===d)throw TypeError("Private method is not writable");if("a"===d&&!e)throw TypeError("Private accessor was defined without a setter");if("function"==typeof b?a!==b||!e:!b.has(a))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===d?e.call(a,c):e?e.value=c:b.set(a,c),c};Object.defineProperty(c,"__esModule",{value:!0}),c.GoogleAuth=c.GoogleAuthExceptionMessages=c.CLOUD_SDK_CLIENT_ID=void 0;let j=a.r(33405),k=a.r(22734),l=a.r(33961),m=a.r(46786),n=a.r(14747),o=a.r(15032),p=a.r(91633),q=a.r(42669),r=a.r(47789),s=a.r(8462),t=a.r(22983),u=a.r(85014),v=a.r(28069),w=a.r(64541),x=a.r(75467),y=a.r(73910),z=a.r(71253),A=a.r(63100);c.CLOUD_SDK_CLIENT_ID="764086051850-6qr4p6gpi6hn506pt8ejuq83di341hur.apps.googleusercontent.com",c.GoogleAuthExceptionMessages={API_KEY_WITH_CREDENTIALS:"API Keys and Credentials are mutually exclusive authentication methods and cannot be used together.",NO_PROJECT_ID_FOUND:"Unable to detect a Project Id in the current environment. \nTo learn more about authentication and Google APIs, visit: \nhttps://cloud.google.com/docs/authentication/getting-started",NO_CREDENTIALS_FOUND:"Unable to find credentials in current environment. \nTo learn more about authentication and Google APIs, visit: \nhttps://cloud.google.com/docs/authentication/getting-started",NO_ADC_FOUND:"Could not load the default credentials. Browse to https://cloud.google.com/docs/authentication/getting-started for more information.",NO_UNIVERSE_DOMAIN_FOUND:"Unable to detect a Universe Domain in the current environment.\nTo learn more about Universe Domain retrieval, visit: \nhttps://cloud.google.com/compute/docs/metadata/predefined-metadata-keys"};class B{get isGCE(){return this.checkIsGCE}constructor(a={}){if(d.add(this),this.checkIsGCE=void 0,this.jsonContent=null,this.cachedCredential=null,e.set(this,null),this.clientOptions={},this._cachedProjectId=a.projectId||null,this.cachedCredential=a.authClient||null,this.keyFilename=a.keyFilename||a.keyFile,this.scopes=a.scopes,this.clientOptions=a.clientOptions||{},this.jsonContent=a.credentials||null,this.apiKey=a.apiKey||this.clientOptions.apiKey||null,this.apiKey&&(this.jsonContent||this.clientOptions.credentials))throw RangeError(c.GoogleAuthExceptionMessages.API_KEY_WITH_CREDENTIALS);a.universeDomain&&(this.clientOptions.universeDomain=a.universeDomain)}setGapicJWTValues(a){a.defaultServicePath=this.defaultServicePath,a.useJWTAccessWithScope=this.useJWTAccessWithScope,a.defaultScopes=this.defaultScopes}getProjectId(a){if(!a)return this.getProjectIdAsync();this.getProjectIdAsync().then(b=>a(null,b),a)}async getProjectIdOptional(){try{return await this.getProjectId()}catch(a){if(a instanceof Error&&a.message===c.GoogleAuthExceptionMessages.NO_PROJECT_ID_FOUND)return null;throw a}}async findAndCacheProjectId(){let a=null;if((a=await this.getProductionProjectId())||(a=await this.getFileProjectId()),a||(a=await this.getDefaultServiceProjectId()),a||(a=await this.getGCEProjectId()),a||(a=await this.getExternalAccountClientProjectId()),a)return this._cachedProjectId=a,a;throw Error(c.GoogleAuthExceptionMessages.NO_PROJECT_ID_FOUND)}async getProjectIdAsync(){return this._cachedProjectId?this._cachedProjectId:(this._findProjectIdPromise||(this._findProjectIdPromise=this.findAndCacheProjectId()),this._findProjectIdPromise)}async getUniverseDomainFromMetadataServer(){var a;let b;try{(b=await l.universe("universe-domain"))||(b=y.DEFAULT_UNIVERSE)}catch(c){if(c&&(null==(a=null==c?void 0:c.response)?void 0:a.status)===404)b=y.DEFAULT_UNIVERSE;else throw c}return b}async getUniverseDomain(){let a=(0,A.originalOrCamelOptions)(this.clientOptions).get("universe_domain");try{null!=a||(a=(await this.getClient()).universeDomain)}catch(b){null!=a||(a=y.DEFAULT_UNIVERSE)}return a}getAnyScopes(){return this.scopes||this.defaultScopes}getApplicationDefault(a={},b){let c;if("function"==typeof a?b=a:c=a,!b)return this.getApplicationDefaultAsync(c);this.getApplicationDefaultAsync(c).then(a=>b(null,a.credential,a.projectId),b)}async getApplicationDefaultAsync(a={}){let b;if(this.cachedCredential)return await h(this,d,"m",f).call(this,this.cachedCredential,null);if((b=await this._tryGetApplicationCredentialsFromEnvironmentVariable(a))||(b=await this._tryGetApplicationCredentialsFromWellKnownFile(a)))return b instanceof t.JWT?b.scopes=this.scopes:b instanceof x.BaseExternalAccountClient&&(b.scopes=this.getAnyScopes()),await h(this,d,"m",f).call(this,b);if(await this._checkIsGCE())return a.scopes=this.getAnyScopes(),await h(this,d,"m",f).call(this,new q.Compute(a));throw Error(c.GoogleAuthExceptionMessages.NO_ADC_FOUND)}async _checkIsGCE(){return void 0===this.checkIsGCE&&(this.checkIsGCE=l.getGCPResidency()||await l.isAvailable()),this.checkIsGCE}async _tryGetApplicationCredentialsFromEnvironmentVariable(a){let b=process.env.GOOGLE_APPLICATION_CREDENTIALS||process.env.google_application_credentials;if(!b||0===b.length)return null;try{return this._getApplicationCredentialsFromFilePath(b,a)}catch(a){throw a instanceof Error&&(a.message=`Unable to read the credential file specified by the GOOGLE_APPLICATION_CREDENTIALS environment variable: ${a.message}`),a}}async _tryGetApplicationCredentialsFromWellKnownFile(a){let b=null;if(this._isWindows())b=process.env.APPDATA;else{let a=process.env.HOME;a&&(b=n.join(a,".config"))}return(b&&(b=n.join(b,"gcloud","application_default_credentials.json"),k.existsSync(b)||(b=null)),b)?await this._getApplicationCredentialsFromFilePath(b,a):null}async _getApplicationCredentialsFromFilePath(a,b={}){if(!a||0===a.length)throw Error("The file path is invalid.");try{if(a=k.realpathSync(a),!k.lstatSync(a).isFile())throw Error()}catch(b){throw b instanceof Error&&(b.message=`The file at ${a} does not exist, or it is not a file. ${b.message}`),b}let c=k.createReadStream(a);return this.fromStream(c,b)}fromImpersonatedJSON(a){var b,c,d,e;if(!a)throw Error("Must pass in a JSON object containing an  impersonated refresh token");if(a.type!==v.IMPERSONATED_ACCOUNT_TYPE)throw Error(`The incoming JSON object does not have the "${v.IMPERSONATED_ACCOUNT_TYPE}" type`);if(!a.source_credentials)throw Error("The incoming JSON object does not contain a source_credentials field");if(!a.service_account_impersonation_url)throw Error("The incoming JSON object does not contain a service_account_impersonation_url field");let f=this.fromJSON(a.source_credentials);if((null==(b=a.service_account_impersonation_url)?void 0:b.length)>256)throw RangeError(`Target principal is too long: ${a.service_account_impersonation_url}`);let g=null==(d=null==(c=/(?<target>[^/]+):(generateAccessToken|generateIdToken)$/.exec(a.service_account_impersonation_url))?void 0:c.groups)?void 0:d.target;if(!g)throw RangeError(`Cannot extract target principal from ${a.service_account_impersonation_url}`);let h=null!=(e=this.getAnyScopes())?e:[];return new v.Impersonated({...a,sourceClient:f,targetPrincipal:g,targetScopes:Array.isArray(h)?h:[h]})}fromJSON(a,b={}){let c,d=(0,A.originalOrCamelOptions)(b).get("universe_domain");return a.type===u.USER_REFRESH_ACCOUNT_TYPE?(c=new u.UserRefreshClient(b)).fromJSON(a):a.type===v.IMPERSONATED_ACCOUNT_TYPE?c=this.fromImpersonatedJSON(a):a.type===x.EXTERNAL_ACCOUNT_TYPE?(c=w.ExternalAccountClient.fromJSON(a,b)).scopes=this.getAnyScopes():a.type===z.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE?c=new z.ExternalAccountAuthorizedUserClient(a,b):(b.scopes=this.scopes,c=new t.JWT(b),this.setGapicJWTValues(c),c.fromJSON(a)),d&&(c.universeDomain=d),c}_cacheClientFromJSON(a,b){let c=this.fromJSON(a,b);return this.jsonContent=a,this.cachedCredential=c,c}fromStream(a,b={},c){let d={};if("function"==typeof b?c=b:d=b,!c)return this.fromStreamAsync(a,d);this.fromStreamAsync(a,d).then(a=>c(null,a),c)}fromStreamAsync(a,b){return new Promise((c,d)=>{if(!a)throw Error("Must pass in a stream containing the Google auth settings.");let e=[];a.setEncoding("utf8").on("error",d).on("data",a=>e.push(a)).on("end",()=>{try{try{let a=JSON.parse(e.join("")),d=this._cacheClientFromJSON(a,b);return c(d)}catch(b){if(!this.keyFilename)throw b;let a=new t.JWT({...this.clientOptions,keyFile:this.keyFilename});return this.cachedCredential=a,this.setGapicJWTValues(a),c(a)}}catch(a){return d(a)}})})}fromAPIKey(a,b={}){return new t.JWT({...b,apiKey:a})}_isWindows(){let a=m.platform();return!!a&&!!(a.length>=3)&&"win"===a.substring(0,3).toLowerCase()}async getDefaultServiceProjectId(){return new Promise(a=>{(0,j.exec)("gcloud config config-helper --format json",(b,c)=>{if(!b&&c)try{let b=JSON.parse(c).configuration.properties.core.project;a(b);return}catch(a){}a(null)})})}getProductionProjectId(){return process.env.GCLOUD_PROJECT||process.env.GOOGLE_CLOUD_PROJECT||process.env.gcloud_project||process.env.google_cloud_project}async getFileProjectId(){if(this.cachedCredential)return this.cachedCredential.projectId;if(this.keyFilename){let a=await this.getClient();if(a&&a.projectId)return a.projectId}let a=await this._tryGetApplicationCredentialsFromEnvironmentVariable();return a?a.projectId:null}async getExternalAccountClientProjectId(){if(!this.jsonContent||this.jsonContent.type!==x.EXTERNAL_ACCOUNT_TYPE)return null;let a=await this.getClient();return await a.getProjectId()}async getGCEProjectId(){try{return await l.project("project-id")}catch(a){return null}}getCredentials(a){if(!a)return this.getCredentialsAsync();this.getCredentialsAsync().then(b=>a(null,b),a)}async getCredentialsAsync(){let a=await this.getClient();if(a instanceof v.Impersonated)return{client_email:a.getTargetPrincipal()};if(a instanceof x.BaseExternalAccountClient){let b=a.getServiceAccountEmail();if(b)return{client_email:b,universe_domain:a.universeDomain}}if(this.jsonContent)return{client_email:this.jsonContent.client_email,private_key:this.jsonContent.private_key,universe_domain:this.jsonContent.universe_domain};if(await this._checkIsGCE()){let[a,b]=await Promise.all([l.instance("service-accounts/default/email"),this.getUniverseDomain()]);return{client_email:a,universe_domain:b}}throw Error(c.GoogleAuthExceptionMessages.NO_CREDENTIALS_FOUND)}async getClient(){if(this.cachedCredential)return this.cachedCredential;i(this,e,h(this,e,"f")||h(this,d,"m",g).call(this),"f");try{return await h(this,e,"f")}finally{i(this,e,null,"f")}}async getIdTokenClient(a){let b=await this.getClient();if(!("fetchIdToken"in b))throw Error("Cannot fetch ID token in this environment, use GCE or set the GOOGLE_APPLICATION_CREDENTIALS environment variable to a service account credentials JSON file.");return new r.IdTokenClient({targetAudience:a,idTokenProvider:b})}async getAccessToken(){let a=await this.getClient();return(await a.getAccessToken()).token}async getRequestHeaders(a){return(await this.getClient()).getRequestHeaders(a)}async authorizeRequest(a){let b=(a=a||{}).url||a.uri,c=await this.getClient(),d=await c.getRequestHeaders(b);return a.headers=Object.assign(a.headers||{},d),a}async request(a){return(await this.getClient()).request(a)}getEnv(){return(0,s.getEnv)()}async sign(a,b){let c=await this.getClient(),d=await this.getUniverseDomain();if(b=b||`https://iamcredentials.${d}/v1/projects/-/serviceAccounts/`,c instanceof v.Impersonated)return(await c.sign(a)).signedBlob;let e=(0,o.createCrypto)();if(c instanceof t.JWT&&c.key)return await e.sign(c.key,a);let f=await this.getCredentials();if(!f.client_email)throw Error("Cannot sign data without `client_email`.");return this.signBlob(e,f.client_email,a,b)}async signBlob(a,b,c,d){let e=new URL(d+`${b}:signBlob`);return(await this.request({method:"POST",url:e.href,data:{payload:a.encodeBase64StringUtf8(c)},retry:!0,retryConfig:{httpMethodsToRetry:["POST"]}})).data.signedBlob}}c.GoogleAuth=B,e=new WeakMap,d=new WeakSet,f=async function(a,b=process.env.GOOGLE_CLOUD_QUOTA_PROJECT||null){let c=await this.getProjectIdOptional();return b&&(a.quotaProjectId=b),this.cachedCredential=a,{credential:a,projectId:c}},g=async function(){if(this.jsonContent)return this._cacheClientFromJSON(this.jsonContent,this.clientOptions);if(this.keyFilename){let a=n.resolve(this.keyFilename),b=k.createReadStream(a);return await this.fromStreamAsync(b,this.clientOptions)}if(this.apiKey){let a=await this.fromAPIKey(this.apiKey,this.clientOptions);a.scopes=this.scopes;let{credential:b}=await h(this,d,"m",f).call(this,a);return b}{let{credential:a}=await this.getApplicationDefaultAsync(this.clientOptions);return a}},B.DefaultTransporter=p.DefaultTransporter},58404,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.IAMAuth=void 0,c.IAMAuth=class{constructor(a,b){this.selector=a,this.token=b,this.selector=a,this.token=b}getRequestHeaders(){return{"x-goog-iam-authority-selector":this.selector,"x-goog-iam-authorization-token":this.token}}}},67101,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.DownscopedClient=c.EXPIRATION_TIME_OFFSET=c.MAX_ACCESS_BOUNDARY_RULES_COUNT=void 0;let d=a.r(88947),e=a.r(73910),f=a.r(10525);c.MAX_ACCESS_BOUNDARY_RULES_COUNT=10,c.EXPIRATION_TIME_OFFSET=3e5;class g extends e.AuthClient{constructor(a,b,d,e){if(super({...d,quotaProjectId:e}),this.authClient=a,this.credentialAccessBoundary=b,0===b.accessBoundary.accessBoundaryRules.length)throw Error("At least one access boundary rule needs to be defined.");if(b.accessBoundary.accessBoundaryRules.length>c.MAX_ACCESS_BOUNDARY_RULES_COUNT)throw Error(`The provided access boundary has more than ${c.MAX_ACCESS_BOUNDARY_RULES_COUNT} access boundary rules.`);for(const a of b.accessBoundary.accessBoundaryRules)if(0===a.availablePermissions.length)throw Error("At least one permission should be defined in access boundary rules.");this.stsCredential=new f.StsCredentials(`https://sts.${this.universeDomain}/v1/token`),this.cachedDownscopedAccessToken=null}setCredentials(a){if(!a.expiry_date)throw Error("The access token expiry_date field is missing in the provided credentials.");super.setCredentials(a),this.cachedDownscopedAccessToken=a}async getAccessToken(){return(!this.cachedDownscopedAccessToken||this.isExpired(this.cachedDownscopedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedDownscopedAccessToken.access_token,expirationTime:this.cachedDownscopedAccessToken.expiry_date,res:this.cachedDownscopedAccessToken.res}}async getRequestHeaders(){let a=await this.getAccessToken(),b={Authorization:`Bearer ${a.token}`};return this.addSharedMetadataHeaders(b)}request(a,b){if(!b)return this.requestAsync(a);this.requestAsync(a).then(a=>b(null,a),a=>b(a,a.response))}async requestAsync(a,b=!1){let c;try{let b=await this.getRequestHeaders();a.headers=a.headers||{},b&&b["x-goog-user-project"]&&(a.headers["x-goog-user-project"]=b["x-goog-user-project"]),b&&b.Authorization&&(a.headers.Authorization=b.Authorization),c=await this.transporter.request(a)}catch(e){let c=e.response;if(c){let e=c.status,f=c.config.data instanceof d.Readable;if(!b&&(401===e||403===e)&&!f&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(a,!0)}throw e}return c}async refreshAccessTokenAsync(){var a;let b=(await this.authClient.getAccessToken()).token,c=await this.stsCredential.exchangeToken({grantType:"urn:ietf:params:oauth:grant-type:token-exchange",requestedTokenType:"urn:ietf:params:oauth:token-type:access_token",subjectToken:b,subjectTokenType:"urn:ietf:params:oauth:token-type:access_token"},void 0,this.credentialAccessBoundary),d=(null==(a=this.authClient.credentials)?void 0:a.expiry_date)||null,e=c.expires_in?new Date().getTime()+1e3*c.expires_in:d;return this.cachedDownscopedAccessToken={access_token:c.access_token,expiry_date:e,res:c.res},this.credentials={},Object.assign(this.credentials,this.cachedDownscopedAccessToken),delete this.credentials.res,this.emit("tokens",{refresh_token:null,expiry_date:this.cachedDownscopedAccessToken.expiry_date,access_token:this.cachedDownscopedAccessToken.access_token,token_type:"Bearer",id_token:null}),this.cachedDownscopedAccessToken}isExpired(a){let b=new Date().getTime();return!!a.expiry_date&&b>=a.expiry_date-this.eagerRefreshThresholdMillis}}c.DownscopedClient=g},50249,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.PassThroughClient=void 0;let d=a.r(73910);class e extends d.AuthClient{async request(a){return this.transporter.request(a)}async getAccessToken(){return{}}async getRequestHeaders(){return{}}}c.PassThroughClient=e,new e().getAccessToken()},27106,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.GoogleAuth=c.auth=c.DefaultTransporter=c.PassThroughClient=c.ExecutableError=c.PluggableAuthClient=c.DownscopedClient=c.BaseExternalAccountClient=c.ExternalAccountClient=c.IdentityPoolClient=c.AwsRequestSigner=c.AwsClient=c.UserRefreshClient=c.LoginTicket=c.ClientAuthentication=c.OAuth2Client=c.CodeChallengeMethod=c.Impersonated=c.JWT=c.JWTAccess=c.IdTokenClient=c.IAMAuth=c.GCPEnv=c.Compute=c.DEFAULT_UNIVERSE=c.AuthClient=c.gaxios=c.gcpMetadata=void 0;let d=a.r(15593);Object.defineProperty(c,"GoogleAuth",{enumerable:!0,get:function(){return d.GoogleAuth}}),c.gcpMetadata=a.r(33961),c.gaxios=a.r(48376);var e=a.r(73910);Object.defineProperty(c,"AuthClient",{enumerable:!0,get:function(){return e.AuthClient}}),Object.defineProperty(c,"DEFAULT_UNIVERSE",{enumerable:!0,get:function(){return e.DEFAULT_UNIVERSE}});var f=a.r(42669);Object.defineProperty(c,"Compute",{enumerable:!0,get:function(){return f.Compute}});var g=a.r(8462);Object.defineProperty(c,"GCPEnv",{enumerable:!0,get:function(){return g.GCPEnv}});var h=a.r(58404);Object.defineProperty(c,"IAMAuth",{enumerable:!0,get:function(){return h.IAMAuth}});var i=a.r(47789);Object.defineProperty(c,"IdTokenClient",{enumerable:!0,get:function(){return i.IdTokenClient}});var j=a.r(97843);Object.defineProperty(c,"JWTAccess",{enumerable:!0,get:function(){return j.JWTAccess}});var k=a.r(22983);Object.defineProperty(c,"JWT",{enumerable:!0,get:function(){return k.JWT}});var l=a.r(28069);Object.defineProperty(c,"Impersonated",{enumerable:!0,get:function(){return l.Impersonated}});var m=a.r(31442);Object.defineProperty(c,"CodeChallengeMethod",{enumerable:!0,get:function(){return m.CodeChallengeMethod}}),Object.defineProperty(c,"OAuth2Client",{enumerable:!0,get:function(){return m.OAuth2Client}}),Object.defineProperty(c,"ClientAuthentication",{enumerable:!0,get:function(){return m.ClientAuthentication}});var n=a.r(6052);Object.defineProperty(c,"LoginTicket",{enumerable:!0,get:function(){return n.LoginTicket}});var o=a.r(85014);Object.defineProperty(c,"UserRefreshClient",{enumerable:!0,get:function(){return o.UserRefreshClient}});var p=a.r(95343);Object.defineProperty(c,"AwsClient",{enumerable:!0,get:function(){return p.AwsClient}});var q=a.r(36674);Object.defineProperty(c,"AwsRequestSigner",{enumerable:!0,get:function(){return q.AwsRequestSigner}});var r=a.r(6265);Object.defineProperty(c,"IdentityPoolClient",{enumerable:!0,get:function(){return r.IdentityPoolClient}});var s=a.r(64541);Object.defineProperty(c,"ExternalAccountClient",{enumerable:!0,get:function(){return s.ExternalAccountClient}});var t=a.r(75467);Object.defineProperty(c,"BaseExternalAccountClient",{enumerable:!0,get:function(){return t.BaseExternalAccountClient}});var u=a.r(67101);Object.defineProperty(c,"DownscopedClient",{enumerable:!0,get:function(){return u.DownscopedClient}});var v=a.r(31294);Object.defineProperty(c,"PluggableAuthClient",{enumerable:!0,get:function(){return v.PluggableAuthClient}}),Object.defineProperty(c,"ExecutableError",{enumerable:!0,get:function(){return v.ExecutableError}});var w=a.r(50249);Object.defineProperty(c,"PassThroughClient",{enumerable:!0,get:function(){return w.PassThroughClient}});var x=a.r(91633);Object.defineProperty(c,"DefaultTransporter",{enumerable:!0,get:function(){return x.DefaultTransporter}}),c.auth=new d.GoogleAuth},8283,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.CREDENTIAL_ERROR_MESSAGE=c.USER_AGENT=c.SYSTEM_ROLE=c.MODEL_ROLE=c.USER_ROLE=c.COUNT_TOKENS_METHOD=c.STREAMING_GENERATE_CONTENT_METHOD=c.GENERATE_CONTENT_METHOD=void 0,c.GENERATE_CONTENT_METHOD="generateContent",c.STREAMING_GENERATE_CONTENT_METHOD="streamGenerateContent",c.COUNT_TOKENS_METHOD="countTokens",c.USER_ROLE="user",c.MODEL_ROLE="model",c.SYSTEM_ROLE="system";let d="1.10.0",e=`grpc-node/${d}`;c.USER_AGENT=`model-builder/${d} ${e}`,c.CREDENTIAL_ERROR_MESSAGE="\nUnable to authenticate your request        \nDepending on your run time environment, you can get authentication by        \n- if in local instance or cloud shell: `!gcloud auth login`        \n- if in Colab:        \n    -`from google.colab import auth`        \n    -`auth.authenticate_user()`        \n- if in service account or other: please follow guidance in https://cloud.google.com/docs/authentication"},1108,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.constants=void 0,c.constants=a.r(8283)},39992,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.formulateSystemInstructionIntoContent=void 0;let d=a.r(1108);c.formulateSystemInstructionIntoContent=function(a){return"string"==typeof a?{role:d.constants.SYSTEM_ROLE,parts:[{text:a}]}:(a.role=d.constants.SYSTEM_ROLE,a)}},82373,(a,b,c)=>{"use strict";function d(a,b){return`[VertexAI.${a}]: ${b}`}Object.defineProperty(c,"__esModule",{value:!0}),c.IllegalArgumentError=c.GoogleGenerativeAIError=c.GoogleAuthError=c.GoogleApiError=c.ClientError=void 0,c.GoogleAuthError=class extends Error{constructor(a,b){super(a,{cause:b}),this.message=d("GoogleAuthError",a),this.name="GoogleAuthError",this.stackTrace=b}},c.ClientError=class extends Error{constructor(a,b){super(a,{cause:b}),this.message=d("ClientError",a),this.name="ClientError",this.stackTrace=b}},c.GoogleApiError=class extends Error{constructor(a,b,c,d){super(a),this.code=b,this.status=c,this.errorDetails=d}},c.GoogleGenerativeAIError=class extends Error{constructor(a,b){super(a,{cause:b}),this.message=d("GoogleGenerativeAIError",a),this.name="GoogleGenerativeAIError",this.stackTrace=b}},c.IllegalArgumentError=class extends Error{constructor(a,b){super(a,{cause:b}),this.message=d("IllegalArgumentError",a),this.name="IllegalArgumentError",this.stackTrace=b}}},87974,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.processCountTokenResponse=c.processUnary=c.aggregateResponses=c.processStream=c.throwErrorIfNotOK=void 0;let d=a.r(1108),e=a.r(82373);c.throwErrorIfNotOK=async function(a){if(void 0===a)throw new e.GoogleGenerativeAIError("response is undefined");if(!a.ok){let b=a.status,c=a.statusText,d=await a.json(),f=`got status: ${b} ${c}. ${JSON.stringify(d)}`;if(b>=400&&b<500)throw new e.ClientError(f,new e.GoogleApiError(d.error.message,d.error.code,d.error.status,d.error.details));throw new e.GoogleGenerativeAIError(f)}};let f=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;async function*g(a){let b=a.getReader();for(;;){let{value:a,done:c}=await b.read();if(c)break;yield j(a)}}async function h(a){let b=[],c=a.getReader();for(;;){let{done:a,value:d}=await c.read();if(a)return i(b);b.push(d)}}function i(a){var b,c,f,g;let h=a[a.length-1];if(void 0===h)throw new e.GoogleGenerativeAIError("Error aggregating stream chunks because the final response in stream chunk is undefined");let i={};for(let e of(h.promptFeedback&&(i.promptFeedback=h.promptFeedback),h.usageMetadata&&(i.usageMetadata=h.usageMetadata),a))if(e.candidates&&0!==e.candidates.length)for(let a=0;a<e.candidates.length;a++){i.candidates||(i.candidates=[]),i.candidates[a]||(i.candidates[a]={index:null!=(b=e.candidates[a].index)?b:a,content:{role:null!=(f=null==(c=e.candidates[a].content)?void 0:c.role)?f:d.constants.MODEL_ROLE,parts:[{text:""}]}});let g=function(a,b){var c;if(!a.citationMetadata)return;let d=null!=(c=b.citationMetadata)?c:{citations:[]},e=a.citationMetadata;return e.citations&&(d.citations=d.citations.concat(e.citations)),d}(e.candidates[a],i.candidates[a]);g&&(i.candidates[a].citationMetadata=g),e.candidates[a].finishReason&&(i.candidates[a].finishReason=e.candidates[a].finishReason);let h=e.candidates[a].finishMessage;h&&(i.candidates[a].finishMessage=h);let j=e.candidates[a].safetyRatings;if(j&&(i.candidates[a].safetyRatings=j),e.candidates[a].content&&e.candidates[a].content.parts&&e.candidates[a].content.parts.length>0){let{parts:b}=i.candidates[a].content;for(let c of e.candidates[a].content.parts)c.text&&(b[0].text+=c.text),c.functionCall&&b.push({functionCall:c.functionCall})}let k=function(a,b){var c;if(!a.groundingMetadata)return;let d=null!=(c=b.groundingMetadata)?c:{webSearchQueries:[],retrievalQueries:[],groundingChunks:[],groundingSupports:[]},e=a.groundingMetadata;return e.webSearchQueries&&(d.webSearchQueries=d.webSearchQueries.concat(e.webSearchQueries)),e.retrievalQueries&&(d.retrievalQueries=d.retrievalQueries.concat(e.retrievalQueries)),e.groundingChunks&&(d.groundingChunks=d.groundingChunks.concat(e.groundingChunks)),e.groundingSupports&&(d.groundingSupports=d.groundingSupports.concat(e.groundingSupports)),e.searchEntryPoint&&(d.searchEntryPoint=e.searchEntryPoint),d}(e.candidates[a],i.candidates[a]);k&&(i.candidates[a].groundingMetadata=k)}return(null==(g=i.candidates)?void 0:g.length)&&i.candidates.forEach(a=>{a.content.parts.length>1&&""===a.content.parts[0].text&&a.content.parts.shift()}),i}function j(a){return a.candidates&&a.candidates.length>0&&a.candidates.forEach((b,c)=>{void 0===b.index&&(a.candidates[c].index=c),void 0===b.content&&(a.candidates[c].content={}),void 0===b.content.role&&(a.candidates[c].content.role=d.constants.MODEL_ROLE)}),a}c.processStream=async function(a){let b;if(void 0===a)throw new e.GoogleGenerativeAIError("Error processing stream because response === undefined");if(!a.body)throw new e.GoogleGenerativeAIError("Error processing stream because response.body not found");let[c,d]=(b=a.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})).getReader(),new ReadableStream({start(a){let c="";return function d(){return b.read().then(({value:b,done:g})=>{let h;if(g)return c.trim()?void a.error(new e.GoogleGenerativeAIError(`Failed to parse final chunk of stream: ${c}`)):void a.close();let i=(c+=b).match(f);for(;i;){try{h=JSON.parse(i[1])}catch(b){a.error(new e.GoogleGenerativeAIError(`Error parsing JSON response from stream chunk: "${i[1]}"`));return}a.enqueue(h),i=(c=c.substring(i[0].length)).match(f)}return d()})}()}})).tee();return Promise.resolve({stream:g(c),response:h(d)})},c.aggregateResponses=i,c.processUnary=async function(a){return void 0!==a?Promise.resolve({response:j(await a.json())}):Promise.resolve({response:{}})},c.processCountTokenResponse=async function(a){return a?a.json():Promise.resolve({})}},92180,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.postRequest=void 0;let d="Authorization",e="Content-Type",f=[d,e],g=a.r(82373),h=a.r(8283);function i(a){return null!=a&&(a.includes("\n")||a.includes("\r"))}c.postRequest=async function({region:a,resourcePath:b,resourceMethod:c,token:j,data:k,apiEndpoint:l,requestOptions:m,apiVersion:n="v1"}){let o=null!=l?l:`${a}-aiplatform.googleapis.com`,p=`https://${o}/${n}/${b}:${c}`;c===h.STREAMING_GENERATE_CONTENT_METHOD&&(p+="?alt=sse");let q=function(a,b,c){var d;let e;if(i(null==c?void 0:c.apiClient))throw new g.ClientError("Found line break in apiClient request option field, please remove the line break and try again.");if(function(a){if(!a)return!1;for(let[b,c]of a.entries())if(i(b)||i(c))return!0;return!1}(null==c?void 0:c.customHeaders))throw new g.ClientError("Found line break in customerHeaders request option field, please remove the line break and try again.");let h=new Headers(b),j=null!=(d=null==c?void 0:c.customHeaders)?d:new Headers;for(let[a,b]of j.entries())h.append(a,b);for(let d of((null==c?void 0:c.apiClient)&&h.append("X-Goog-Api-Client",null==c?void 0:c.apiClient),e=a.endsWith("googleapis.com")?b:j,f))e.has(d)&&h.set(d,e.get(d));return h}(o,new Headers({[d]:`Bearer ${j}`,[e]:"application/json","User-Agent":h.USER_AGENT}),m);return fetch(p,{...function(a){let b={};if(!a||void 0===a.timeout||a.timeout<0)return b;let c=new AbortController,d=c.signal;return setTimeout(()=>c.abort(),a.timeout),b.signal=d,b}(m),method:"POST",headers:q,body:JSON.stringify(k)})}},35799,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.hasVertexAISearch=c.hasVertexRagStore=c.getApiVersion=c.validateGenerationConfig=c.validateGenerateContentRequest=c.formatContentRequest=void 0;let d=a.r(82373),e=a.r(8283);function f(a){var b;for(let c of null!=(b=null==a?void 0:a.tools)?b:[]){let a=c.retrieval;if(a&&a.vertexRagStore)return!0}return!1}function g(a){var b;for(let c of null!=(b=null==a?void 0:a.tools)?b:[]){let a=c.retrieval;if(a&&a.vertexAiSearch)return!0}return!1}c.formatContentRequest=function(a,b,c){return"string"==typeof a?{contents:[{role:e.USER_ROLE,parts:[{text:a}]}],generationConfig:b,safetySettings:c}:a},c.validateGenerateContentRequest=function(a){if(g(a)&&f(a))throw new d.ClientError("Found both vertexAiSearch and vertexRagStore field are set in tool. Either set vertexAiSearch or vertexRagStore.")},c.validateGenerationConfig=function(a){return"topK"in a&&(!(a.topK>0)||!(a.topK<=40))&&delete a.topK,a},c.getApiVersion=function(a){return f(a)||a.cachedContent?"v1beta1":"v1"},c.hasVertexRagStore=f,c.hasVertexAISearch=g},74527,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.generateContentStream=c.generateContent=void 0;let d=a.r(82373),e=a.r(8283),f=a.r(87974),g=a.r(92180),h=a.r(35799);c.generateContent=async function(a,b,c,i,j,k,l,m,n,o){var p,q,r,s;i=(0,h.formatContentRequest)(i,k,l),(0,h.validateGenerateContentRequest)(i),i.generationConfig&&(i.generationConfig=(0,h.validateGenerationConfig)(i.generationConfig));let t={contents:i.contents,systemInstruction:i.systemInstruction,cachedContent:i.cachedContent,generationConfig:null!=(p=i.generationConfig)?p:k,safetySettings:null!=(q=i.safetySettings)?q:l,tools:null!=(r=i.tools)?r:m,toolConfig:null!=(s=i.toolConfig)?s:n,labels:i.labels},u=await (0,g.postRequest)({region:a,resourcePath:b,resourceMethod:e.GENERATE_CONTENT_METHOD,token:await c,data:t,apiEndpoint:j,requestOptions:o,apiVersion:(0,h.getApiVersion)(i)}).catch(a=>{throw new d.GoogleGenerativeAIError("exception posting request to model",a)});return await (0,f.throwErrorIfNotOK)(u).catch(a=>{throw a}),(0,f.processUnary)(u)},c.generateContentStream=async function(a,b,c,i,j,k,l,m,n,o){var p,q,r,s;i=(0,h.formatContentRequest)(i,k,l),(0,h.validateGenerateContentRequest)(i),i.generationConfig&&(i.generationConfig=(0,h.validateGenerationConfig)(i.generationConfig));let t={contents:i.contents,systemInstruction:i.systemInstruction,cachedContent:i.cachedContent,generationConfig:null!=(p=i.generationConfig)?p:k,safetySettings:null!=(q=i.safetySettings)?q:l,tools:null!=(r=i.tools)?r:m,toolConfig:null!=(s=i.toolConfig)?s:n,labels:i.labels},u=await (0,g.postRequest)({region:a,resourcePath:b,resourceMethod:e.STREAMING_GENERATE_CONTENT_METHOD,token:await c,data:t,apiEndpoint:j,requestOptions:o,apiVersion:(0,h.getApiVersion)(i)}).catch(a=>{throw new d.GoogleGenerativeAIError("exception posting request",a)});return await (0,f.throwErrorIfNotOK)(u).catch(a=>{throw a}),(0,f.processStream)(u)}},25320,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ChatSessionPreview=c.ChatSession=void 0;let d=a.r(39992),e=a.r(74527),f=a.r(82373),g=a.r(1108);function h(a){let b=[];if("string"==typeof a)b=[{text:a}];else if(Array.isArray(a))for(let c of a)"string"==typeof c?b.push({text:c}):b.push(c);var c=b;let d={role:g.constants.USER_ROLE,parts:[]},e={role:g.constants.USER_ROLE,parts:[]},h=!1,i=!1;for(let a of c)"functionResponse"in a?(e.parts.push(a),i=!0):(d.parts.push(a),h=!0);if(h&&i)throw new f.ClientError("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!h&&!i)throw new f.ClientError("No content is provided for sending chat message.");return h?[d]:[e]}c.ChatSession=class{async getHistory(){return Promise.resolve(this.historyInternal)}constructor(a,b){var c;this.sendStreamPromise=Promise.resolve(),this.project=a.project,this.location=a.location,this.googleAuth=a.googleAuth,this.resourcePath=a.resourcePath,this.historyInternal=null!=(c=a.history)?c:[],this.generationConfig=a.generationConfig,this.safetySettings=a.safetySettings,this.tools=a.tools,this.toolConfig=a.toolConfig,this.apiEndpoint=a.apiEndpoint,this.requestOptions=null!=b?b:{},a.systemInstruction&&(this.systemInstruction=(0,d.formulateSystemInstructionIntoContent)(a.systemInstruction))}fetchToken(){return this.googleAuth.getAccessToken().catch(a=>{throw new f.GoogleAuthError(g.constants.CREDENTIAL_ERROR_MESSAGE,a)})}async sendMessage(a){let b=h(a),c={contents:this.historyInternal.concat(b),safetySettings:this.safetySettings,generationConfig:this.generationConfig,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction},d=await (0,e.generateContent)(this.location,this.resourcePath,this.fetchToken(),c,this.apiEndpoint,this.generationConfig,this.safetySettings,this.tools,this.toolConfig,this.requestOptions).catch(a=>{throw a}),f=await d.response;if(f.candidates&&0!==f.candidates.length){this.historyInternal=this.historyInternal.concat(b);let a=f.candidates[0].content;this.historyInternal.push(a)}return Promise.resolve(d)}async appendHistory(a,b){let c=await a,d=await c.response;if(d.candidates&&0!==d.candidates.length){this.historyInternal=this.historyInternal.concat(b);let a=d.candidates[0].content;this.historyInternal.push(a)}}async sendMessageStream(a){let b=h(a),c={contents:this.historyInternal.concat(b),safetySettings:this.safetySettings,generationConfig:this.generationConfig,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction},d=(0,e.generateContentStream)(this.location,this.resourcePath,this.fetchToken(),c,this.apiEndpoint,this.generationConfig,this.safetySettings,this.tools,this.toolConfig,this.requestOptions).catch(a=>{throw a});return this.sendStreamPromise=this.appendHistory(d,b).catch(a=>{console.error(a)}),d}},c.ChatSessionPreview=class{async getHistory(){return Promise.resolve(this.historyInternal)}constructor(a,b){var c;this.sendStreamPromise=Promise.resolve(),this.project=a.project,this.location=a.location,this.googleAuth=a.googleAuth,this.resourcePath=a.resourcePath,this.historyInternal=null!=(c=a.history)?c:[],this.generationConfig=a.generationConfig,this.safetySettings=a.safetySettings,this.tools=a.tools,this.toolConfig=a.toolConfig,this.apiEndpoint=a.apiEndpoint,this.requestOptions=null!=b?b:{},this.cachedContent=a.cachedContent,a.systemInstruction&&(this.systemInstruction=(0,d.formulateSystemInstructionIntoContent)(a.systemInstruction))}fetchToken(){return this.googleAuth.getAccessToken().catch(a=>{throw new f.GoogleAuthError(g.constants.CREDENTIAL_ERROR_MESSAGE,a)})}async sendMessage(a){let b=h(a),c={contents:this.historyInternal.concat(b),safetySettings:this.safetySettings,generationConfig:this.generationConfig,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent},d=await (0,e.generateContent)(this.location,this.resourcePath,this.fetchToken(),c,this.apiEndpoint,this.generationConfig,this.safetySettings,this.tools,this.toolConfig,this.requestOptions).catch(a=>{throw a}),f=await d.response;if(f.candidates&&0!==f.candidates.length){this.historyInternal=this.historyInternal.concat(b);let a=f.candidates[0].content;this.historyInternal.push(a)}return Promise.resolve(d)}async appendHistory(a,b){let c=await a,d=await c.response;if(d.candidates&&0!==d.candidates.length){this.historyInternal=this.historyInternal.concat(b);let a=d.candidates[0].content;this.historyInternal.push(a)}}async sendMessageStream(a){let b=h(a),c={contents:this.historyInternal.concat(b),safetySettings:this.safetySettings,generationConfig:this.generationConfig,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent},d=(0,e.generateContentStream)(this.location,this.resourcePath,this.fetchToken(),c,this.apiEndpoint,this.generationConfig,this.safetySettings,this.tools,this.toolConfig,this.requestOptions).catch(a=>{throw a});return this.sendStreamPromise=this.appendHistory(d,b).catch(a=>{console.error(a)}),d}}},33197,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.countTokens=void 0;let d=a.r(82373),e=a.r(8283),f=a.r(87974),g=a.r(92180);c.countTokens=async function(a,b,c,h,i,j){let k=await (0,g.postRequest)({region:a,resourcePath:b,resourceMethod:e.COUNT_TOKENS_METHOD,token:await c,data:h,apiEndpoint:i,requestOptions:j}).catch(a=>{throw new d.GoogleGenerativeAIError("exception posting request",a)});return await (0,f.throwErrorIfNotOK)(k).catch(a=>{throw a}),(0,f.processCountTokenResponse)(k)}},15911,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.GenerativeModelPreview=c.GenerativeModel=void 0;let d=a.r(39992),e=a.r(33197),f=a.r(74527),g=a.r(82373),h=a.r(1108),i=a.r(25320);function j(a,b,c){let d;if(!a)throw new g.ClientError("model parameter must not be empty.");if(a.includes("/"))if(a.startsWith("models/"))d=`projects/${b}/locations/${c}/publishers/google/${a}`;else if(a.startsWith("projects/"))d=a;else throw new g.ClientError("model parameter must be either a Model Garden model ID or a full resource name.");else d=`projects/${b}/locations/${c}/publishers/google/models/${a}`;return d}function k(a){return"string"==typeof a?{contents:[{role:h.constants.USER_ROLE,parts:[{text:a}]}]}:a}function l(a,b){return a.systemInstruction?a.systemInstruction=(0,d.formulateSystemInstructionIntoContent)(a.systemInstruction):b&&(a.systemInstruction=b),a}c.GenerativeModel=class{constructor(a){var b;this.project=a.project,this.location=a.location,this.apiEndpoint=a.apiEndpoint,this.googleAuth=a.googleAuth,this.model=a.model,this.generationConfig=a.generationConfig,this.safetySettings=a.safetySettings,this.tools=a.tools,this.toolConfig=a.toolConfig,this.requestOptions=null!=(b=a.requestOptions)?b:{},a.systemInstruction&&(this.systemInstruction=(0,d.formulateSystemInstructionIntoContent)(a.systemInstruction)),this.resourcePath=j(this.model,this.project,this.location),this.publisherModelEndpoint=this.resourcePath}fetchToken(){return this.googleAuth.getAccessToken().catch(a=>{throw new g.GoogleAuthError(h.constants.CREDENTIAL_ERROR_MESSAGE,a)})}async generateContent(a){let b=l(a=k(a),this.systemInstruction);return(0,f.generateContent)(this.location,this.resourcePath,this.fetchToken(),b,this.apiEndpoint,this.generationConfig,this.safetySettings,this.tools,this.toolConfig,this.requestOptions)}async generateContentStream(a){let b=l(a=k(a),this.systemInstruction);return(0,f.generateContentStream)(this.location,this.resourcePath,this.fetchToken(),b,this.apiEndpoint,this.generationConfig,this.safetySettings,this.tools,this.toolConfig,this.requestOptions)}async countTokens(a){return(0,e.countTokens)(this.location,this.resourcePath,this.fetchToken(),a,this.apiEndpoint,this.requestOptions)}startChat(a){var b,c,d,e,f,g;let h={project:this.project,location:this.location,googleAuth:this.googleAuth,publisherModelEndpoint:this.publisherModelEndpoint,resourcePath:this.resourcePath,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction};return a&&(h.history=a.history,h.generationConfig=null!=(b=a.generationConfig)?b:this.generationConfig,h.safetySettings=null!=(c=a.safetySettings)?c:this.safetySettings,h.tools=null!=(d=a.tools)?d:this.tools,h.toolConfig=null!=(e=a.toolConfig)?e:this.toolConfig,h.apiEndpoint=null!=(f=a.apiEndpoint)?f:this.apiEndpoint,h.systemInstruction=null!=(g=a.systemInstruction)?g:this.systemInstruction),new i.ChatSession(h,this.requestOptions)}},c.GenerativeModelPreview=class{constructor(a){var b;this.project=a.project,this.location=a.location,this.apiEndpoint=a.apiEndpoint,this.googleAuth=a.googleAuth,this.model=a.model,this.generationConfig=a.generationConfig,this.safetySettings=a.safetySettings,this.tools=a.tools,this.toolConfig=a.toolConfig,this.cachedContent=a.cachedContent,this.requestOptions=null!=(b=a.requestOptions)?b:{},a.systemInstruction&&(this.systemInstruction=(0,d.formulateSystemInstructionIntoContent)(a.systemInstruction)),this.resourcePath=j(this.model,this.project,this.location),this.publisherModelEndpoint=this.resourcePath}fetchToken(){return this.googleAuth.getAccessToken().catch(a=>{throw new g.GoogleAuthError(h.constants.CREDENTIAL_ERROR_MESSAGE,a)})}async generateContent(a){var b;let c={...l(a=k(a),this.systemInstruction),cachedContent:null==(b=this.cachedContent)?void 0:b.name};return(0,f.generateContent)(this.location,this.resourcePath,this.fetchToken(),c,this.apiEndpoint,this.generationConfig,this.safetySettings,this.tools,this.toolConfig,this.requestOptions)}async generateContentStream(a){var b;let c={...l(a=k(a),this.systemInstruction),cachedContent:null==(b=this.cachedContent)?void 0:b.name};return(0,f.generateContentStream)(this.location,this.resourcePath,this.fetchToken(),c,this.apiEndpoint,this.generationConfig,this.safetySettings,this.tools,this.toolConfig,this.requestOptions)}async countTokens(a){return(0,e.countTokens)(this.location,this.resourcePath,this.fetchToken(),a,this.apiEndpoint,this.requestOptions)}startChat(a){var b,c,d,e,f,g,h,j;let k={project:this.project,location:this.location,googleAuth:this.googleAuth,publisherModelEndpoint:this.publisherModelEndpoint,resourcePath:this.resourcePath,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:null==(b=this.cachedContent)?void 0:b.name};return a&&(k.history=a.history,k.generationConfig=null!=(c=a.generationConfig)?c:this.generationConfig,k.safetySettings=null!=(d=a.safetySettings)?d:this.safetySettings,k.tools=null!=(e=a.tools)?e:this.tools,k.toolConfig=null!=(f=a.toolConfig)?f:this.toolConfig,k.systemInstruction=null!=(g=a.systemInstruction)?g:this.systemInstruction,k.cachedContent=null!=(h=a.cachedContent)?h:null==(j=this.cachedContent)?void 0:j.name),new i.ChatSessionPreview(k,this.requestOptions)}getModelName(){return this.model}getCachedContent(){return this.cachedContent}getSystemInstruction(){return this.systemInstruction}}},56674,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.GenerativeModelPreview=c.GenerativeModel=c.ChatSessionPreview=c.ChatSession=void 0;var d=a.r(25320);Object.defineProperty(c,"ChatSession",{enumerable:!0,get:function(){return d.ChatSession}}),Object.defineProperty(c,"ChatSessionPreview",{enumerable:!0,get:function(){return d.ChatSessionPreview}});var e=a.r(15911);Object.defineProperty(c,"GenerativeModel",{enumerable:!0,get:function(){return e.GenerativeModel}}),Object.defineProperty(c,"GenerativeModelPreview",{enumerable:!0,get:function(){return e.GenerativeModelPreview}})},33288,(a,b,c)=>{"use strict";var d,e;Object.defineProperty(c,"__esModule",{value:!0}),c.SchemaType=void 0,(e=d||(c.SchemaType=d={})).STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT"},39090,(a,b,c)=>{"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q;Object.defineProperty(c,"__esModule",{value:!0}),c.FunctionDeclarationSchemaType=c.Mode=c.FinishReason=c.BlockedReason=c.HarmSeverity=c.HarmProbability=c.HarmBlockThreshold=c.HarmCategory=void 0;let r=a.r(33288);(k=d||(c.HarmCategory=d={})).HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",k.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",k.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",k.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",k.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",(l=e||(c.HarmBlockThreshold=e={})).HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",l.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",l.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",l.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",l.BLOCK_NONE="BLOCK_NONE",l.OFF="OFF",(m=f||(c.HarmProbability=f={})).HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",m.NEGLIGIBLE="NEGLIGIBLE",m.LOW="LOW",m.MEDIUM="MEDIUM",m.HIGH="HIGH",(n=g||(c.HarmSeverity=g={})).HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH",(o=h||(c.BlockedReason=h={})).BLOCKED_REASON_UNSPECIFIED="BLOCK_REASON_UNSPECIFIED",o.SAFETY="SAFETY",o.OTHER="OTHER",o.BLOCKLIST="BLOCKLIST",o.PROHIBITED_CONTENT="PROHIBITED_CONTENT",(p=i||(c.FinishReason=i={})).FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",p.STOP="STOP",p.MAX_TOKENS="MAX_TOKENS",p.SAFETY="SAFETY",p.RECITATION="RECITATION",p.OTHER="OTHER",p.BLOCKLIST="BLOCKLIST",p.PROHIBITED_CONTENT="PROHIBITED_CONTENT",p.SPII="SPII",(q=j||(c.Mode=j={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",q.MODE_DYNAMIC="MODE_DYNAMIC",c.FunctionDeclarationSchemaType={...r.SchemaType}},34754,(a,b,c)=>{"use strict";var d,e;Object.defineProperty(c,"__esModule",{value:!0}),c.FunctionCallingMode=void 0,(e=d||(c.FunctionCallingMode=d={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"},44142,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.GenerateContentResponseHandler=void 0,c.GenerateContentResponseHandler=class{static getFunctionCallsFromCandidate(a){return a?a.content.parts.filter(a=>!!a&&!!a.functionCall).map(a=>a.functionCall):[]}}},42782,(a,b,c)=>{"use strict";var d=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),c.GenerateContentResponseHandler=void 0,e(a.r(39090),c),e(a.r(82373),c),e(a.r(34754),c),e(a.r(33288),c);var f=a.r(44142);Object.defineProperty(c,"GenerateContentResponseHandler",{enumerable:!0,get:function(){return f.GenerateContentResponseHandler}})},55643,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.CachedContents=c.inferModelName=c.inferFullResourceName=void 0;let d=a.r(39992),e=a.r(42782);class f{constructor(a){this.apiClient=a}create(a){return this.apiClient.unaryApiCall(new URL(this.apiClient.getBaseUrl()+"/"+this.apiClient.getBaseResourePath()+"/cachedContents"),{body:JSON.stringify(a)},"POST")}update(a,b){let c=new URL(this.apiClient.getBaseUrl()+"/"+a.name);return c.searchParams.append("updateMask",b.map(a=>a.replace(/[A-Z]/g,a=>`_${a.toLowerCase()}`)).join(",")),this.apiClient.unaryApiCall(c,{body:JSON.stringify(a)},"PATCH")}delete(a){return this.apiClient.unaryApiCall(new URL(this.apiClient.getBaseUrl()+"/"+a),{},"DELETE")}list(a,b){let c=new URL(this.apiClient.getBaseUrl()+"/"+this.apiClient.getBaseResourePath()+"/cachedContents");return a&&c.searchParams.append("pageSize",String(a)),b&&c.searchParams.append("pageToken",b),this.apiClient.unaryApiCall(c,{},"GET")}get(a){return this.apiClient.unaryApiCall(new URL(this.apiClient.getBaseUrl()+"/"+a),{},"GET")}}function g(a,b,c){if(c.startsWith("projects/"))return c;if(c.startsWith("locations/"))return`projects/${a}/${c}`;if(c.startsWith("cachedContents/"))return`projects/${a}/locations/${b}/${c}`;if(!c.includes("/"))return`projects/${a}/locations/${b}/cachedContents/${c}`;throw new e.ClientError(`Invalid CachedContent.name: ${c}. CachedContent.name should start with 'projects/', 'locations/', 'cachedContents/' or is a number type.`)}function h(a,b,c){if(!c)throw new e.ClientError("Model name is required.");return c.startsWith("publishers/")?`projects/${a}/locations/${b}/${c}`:c.startsWith("projects/")?c:`projects/${a}/locations/${b}/publishers/google/models/${c}`}c.inferFullResourceName=g,c.inferModelName=h,c.CachedContents=class{constructor(a){this.client=new f(a)}create(a){let b={...a,systemInstruction:a.systemInstruction?(0,d.formulateSystemInstructionIntoContent)(a.systemInstruction):void 0,model:h(this.client.apiClient.project,this.client.apiClient.location,a.model)};return this.client.create(b)}update(a,b){if(!a.name)throw new e.ClientError("Cached content name is required for update.");if(!b||0===b.length)throw new e.ClientError('Update mask is required for update. Fields set in cachedContent but not in updateMask will be ignored. Examples: ["ttl"] or ["expireTime"].');let c={...a,systemInstruction:a.systemInstruction?(0,d.formulateSystemInstructionIntoContent)(a.systemInstruction):void 0,name:g(this.client.apiClient.project,this.client.apiClient.location,a.name)};return this.client.update(c,b)}delete(a){return this.client.delete(g(this.client.apiClient.project,this.client.apiClient.location,a))}list(a,b){return this.client.list(a,b)}get(a){return this.client.get(g(this.client.apiClient.project,this.client.apiClient.location,a))}}},6070,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ApiClient=void 0;let d=a.r(1108),e=a.r(42782);async function f(a,b,c){var d;if(void 0===a)throw new e.GoogleGenerativeAIError("response is undefined");if(!a.ok){let f,g=a.status,h=a.statusText;f=(null==(d=a.headers.get("content-type"))?void 0:d.includes("application/json"))?await a.json():{error:{message:`exception sending request to url: ${b} with requestInit: ${JSON.stringify(c)}}`,code:a.status,status:a.statusText}};let i=`got status: ${g} ${h}. ${JSON.stringify(f)}`;if(g>=400&&g<500)throw new e.ClientError(i,new e.GoogleApiError(f.error.message,f.error.code,f.error.status,f.error.details));throw new e.GoogleGenerativeAIError(i)}}c.ApiClient=class{constructor(a,b,c,d){this.project=a,this.location=b,this.apiVersion=c,this.googleAuth=d}fetchToken(){return this.googleAuth.getAccessToken().catch(a=>{throw new e.GoogleAuthError(d.constants.CREDENTIAL_ERROR_MESSAGE,a)})}getBaseUrl(){return`https://${this.location}-aiplatform.googleapis.com/${this.apiVersion}`}getBaseResourePath(){return`projects/${this.project}/locations/${this.location}`}async unaryApiCall(a,b,c){let d=await this.getHeaders();return this.apiCall(a.toString(),{...b,method:c,headers:d})}async apiCall(a,b){let c=await fetch(a,b).catch(c=>{throw new e.GoogleGenerativeAIError(`exception sending request to url: ${a} with requestInit: ${JSON.stringify(b)}}`,c)});await f(c,a,b).catch(a=>{throw a});try{return await c.json()}catch(a){throw new e.GoogleGenerativeAIError(JSON.stringify(c),a)}}async getHeaders(){let a=await this.fetchToken();return new Headers({Authorization:`Bearer ${a}`,"Content-Type":"application/json","User-Agent":d.constants.USER_AGENT})}}},32469,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.ApiClient=c.CachedContents=void 0;var d=a.r(55643);Object.defineProperty(c,"CachedContents",{enumerable:!0,get:function(){return d.CachedContents}});var e=a.r(6070);Object.defineProperty(c,"ApiClient",{enumerable:!0,get:function(){return e.ApiClient}})},77088,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.VertexAI=void 0;let d=a.r(27106),e=a.r(56674),f=a.r(82373),g=a.r(32469),h=a.r(55643);c.VertexAI=class{constructor(a){const b=function(a,b){let c,d="https://www.googleapis.com/auth/cloud-platform";if(!b)return{scopes:d};if(b.projectId&&b.projectId!==a)throw Error(`inconsistent project ID values. argument project got value ${a} but googleAuthOptions.projectId got value ${b.projectId}`);if(!(c=b).scopes)return c.scopes=d,c;if("string"==typeof c.scopes&&c.scopes!==d||Array.isArray(c.scopes)&&0>c.scopes.indexOf(d))throw new f.GoogleAuthError(`input GoogleAuthOptions.scopes ${c.scopes} doesn't contain required scope ${d}, please include ${d} into GoogleAuthOptions.scopes or leave GoogleAuthOptions.scopes undefined`);return c}(a.project,a.googleAuthOptions);this.location=function(a){if(a)return a;let b=process.env.GOOGLE_CLOUD_REGION||process.env.CLOUD_ML_REGION;return b||"us-central1"}(a.location),this.project=function(a){if(a)return a;let b=process.env.GOOGLE_CLOUD_PROJECT;if(b)return b;throw new f.IllegalArgumentError("Unable to infer your project.Please provide a project Id by one of the following:\n- Passing a constructor argument by using new VertexAI({project: my-project})\n- Setting project using `gcloud config set project my-project`")}(a.project),this.googleAuth=new d.GoogleAuth(b),this.apiEndpoint=a.apiEndpoint,this.preview=new i(this.project,this.location,this.googleAuth,this.apiEndpoint)}getGenerativeModel(a,b){let c={model:a.model,project:this.project,location:this.location,googleAuth:this.googleAuth,apiEndpoint:this.apiEndpoint,safetySettings:a.safetySettings,generationConfig:a.generationConfig,tools:a.tools,toolConfig:a.toolConfig,requestOptions:b,systemInstruction:a.systemInstruction};return new e.GenerativeModel(c)}getProject(){return this.project}getLocation(){return this.location}};class i{constructor(a,b,c,d){this.project=a,this.location=b,this.googleAuth=c,this.apiEndpoint=d,this.apiClient=new g.ApiClient(this.project,this.location,"v1beta1",this.googleAuth),this.cachedContents=new g.CachedContents(this.apiClient)}getGenerativeModel(a,b){let c={model:a.model,project:this.project,location:this.location,googleAuth:this.googleAuth,apiEndpoint:this.apiEndpoint,safetySettings:a.safetySettings,generationConfig:a.generationConfig,tools:a.tools,toolConfig:a.toolConfig,requestOptions:b,systemInstruction:a.systemInstruction};return new e.GenerativeModelPreview(c)}getGenerativeModelFromCachedContent(a,b,c){if(!a.name)throw new f.ClientError("Cached content must contain a `name` field.");if(!a.model)throw new f.ClientError("Cached content must contain a `model` field.");var d=a.model;if(!(d.startsWith("models/")||d.startsWith("projects/")&&d.includes("/publishers/google/models/"))&&d.includes("/"))throw new f.ClientError(`Cached content model name must start with "models/" or match "projects/.*/publishers/google/models/.*" or is a model name listed at https://cloud.google.com/vertex-ai/generative-ai/docs/learn/model-versions. Received: ${d}`);for(let c of["model","systemInstruction"])if((null==b?void 0:b[c])&&a[c]&&(null==b?void 0:b[c])!==a[c]){if("model"===c&&j(b[c])===j(a[c]))continue;throw new f.ClientError(`Different value for "${c}" specified in modelParams (${b[c]}) and cachedContent (${a[c]})`)}a.name=(0,h.inferFullResourceName)(this.project,this.location,a.name);let g={model:a.model,project:this.project,location:this.location,googleAuth:this.googleAuth,apiEndpoint:this.apiEndpoint,safetySettings:null==b?void 0:b.safetySettings,generationConfig:null==b?void 0:b.generationConfig,tools:a.tools,toolConfig:a.toolConfig,requestOptions:c,systemInstruction:a.systemInstruction,cachedContent:a};return new e.GenerativeModelPreview(g)}}function j(a){return a.includes("/")?a.split("/").pop():a}},26022,(a,b,c)=>{"use strict";var d=a.e&&a.e.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=a.e&&a.e.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(c,"__esModule",{value:!0}),c.VertexAI=void 0;var f=a.r(77088);Object.defineProperty(c,"VertexAI",{enumerable:!0,get:function(){return f.VertexAI}}),e(a.r(42782),c),e(a.r(56674),c)},13095,(a,b,c)=>{"use strict";function d(a){for(let b=0;b<a.length;b++){let c=a[b];if("function"!=typeof c)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof c}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ensureServerEntryExports",{enumerable:!0,get:function(){return d}})},9496,a=>{"use strict";var b=a.i(37936),c=a.i(77530),d=a.i(69041);function e(){return d.apps.length||d.initializeApp({credential:d.credential.applicationDefault()}),d.firestore()}async function f(b){{console.log(`[Prod] Enqueuing analysis for ${b} to Cloud Tasks.`);let{CloudTasksClient:c}=await a.A(61486),d=new c,e=process.env.GOOGLE_CLOUD_PROJECT,f=`https://${process.env.NEXT_PUBLIC_HOST}/api/tasks/analyze`,g=d.queuePath(e,"us-central1","analysis-queue"),h={httpRequest:{httpMethod:"POST",url:f,body:Buffer.from(JSON.stringify({placeId:b})).toString("base64"),headers:{"Content-Type":"application/json"}}};await d.createTask({parent:g,task:h})}}a.i(26022);var g=a.i(13095);async function h(a){console.log(`Analyzing place: ${a}`);let b=e().collection("places").doc(a),d=await b.get();if(d.exists){let b=d.data();console.log(`Place ${a} found. Status: ${b.status}`);let c=new Date,e=b.updatedAt?b.updatedAt.toDate():new Date(0),g=Math.ceil(Math.abs(c.getTime()-e.getTime())/864e5);if(g>30)console.log(`Place ${a} data is expired (${g} days old). Re-fetching...`);else if("error"===b.status)return await f(a),a;else return a}console.log(`Fetching fresh data for place ${a}...`);try{let e=new c.GoogleAuth({scopes:"https://www.googleapis.com/auth/cloud-platform"}),g=await e.getClient(),h=await g.getAccessToken(),i=`https://places.googleapis.com/v1/places/${a}?languageCode=ja`,j={"Content-Type":"application/json",Authorization:`Bearer ${h.token}`,"X-Goog-FieldMask":"id,displayName,formattedAddress,rating,userRatingCount,reviews,priceLevel,priceRange"},k=await fetch(i,{method:"GET",headers:j});if(!k.ok){let a=await k.text();throw console.error("Google Places API Details Error:",a),Error(`Google Places API Error: ${k.statusText}`)}let l=await k.json();console.log("API Response Data:",JSON.stringify(l,null,2));let m=l.reviews?.map(a=>a.text?.text).filter(Boolean)||[];console.log(`Fetched reviews: ${m.length}`);let n={id:l.id,name:l.displayName?.text||"Unknown",address:l.formattedAddress,originalRating:l.rating||0,userRatingsTotal:l.userRatingCount||0,...l.priceLevel?{priceLevel:l.priceLevel}:{},...l.priceRange?{priceRange:l.priceRange}:{},reviews:m,status:"pending",createdAt:d.exists?d.data().createdAt:new Date,updatedAt:new Date};await b.set(n),await f(a)}catch(a){throw console.error("Failed to fetch place details:",a),a}return a}async function i(a){console.log(`Searching places (ID only) for: ${a}`);try{let b=new c.GoogleAuth({scopes:"https://www.googleapis.com/auth/cloud-platform"}),d=await b.getClient(),e=await d.getAccessToken(),f=await fetch("https://places.googleapis.com/v1/places:searchText",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.token}`,"X-Goog-FieldMask":"places.id"},body:JSON.stringify({textQuery:a,languageCode:"ja",maxResultCount:10})});if(!f.ok)throw Error(`Google Places API Error: ${f.statusText}`);let g=await f.json();return g.places?.map(a=>a.id)||[]}catch(a){return console.error("Failed to search places (ID only):",a),[]}}async function j(a){console.log(`Searching places list for: ${a}`);try{let b=await i(a);if(0===b.length)return[];let d=e(),f=d.collection("places"),g=[],h=!0;for(let a of b){let b=await f.doc(a).get();if(b.exists){let a=b.data(),c=new Date,d=a.updatedAt?a.updatedAt.toDate():new Date(0),e=Math.abs(c.getTime()-d.getTime());if(30>=Math.ceil(e/864e5)&&"error"!==a.status)g.push({id:a.id,name:a.name,rating:a.originalRating,userRatingsTotal:a.userRatingsTotal,vicinity:a.address});else{h=!1;break}}else{h=!1;break}}if(h&&g.length===b.length)return console.log("All places found in cache. Returning cached data."),g;console.log("Cache miss or expired data found. Fetching fresh data from API...");let j=new c.GoogleAuth({scopes:"https://www.googleapis.com/auth/cloud-platform"}),k=await j.getClient(),l=await k.getAccessToken(),m=await fetch("https://places.googleapis.com/v1/places:searchText",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l.token}`,"X-Goog-FieldMask":"places.id,places.displayName,places.formattedAddress,places.rating,places.userRatingCount"},body:JSON.stringify({textQuery:a,languageCode:"ja",maxResultCount:10})});if(!m.ok){let a=await m.text();throw console.error("Google Places API Error:",a),Error(`Google Places API Error: ${m.statusText}`)}let n=await m.json();if(!n.places)return[];let o=n.places.map(a=>({id:a.id,name:a.displayName?.text||"Unknown",rating:a.rating||0,userRatingsTotal:a.userRatingCount||0,vicinity:a.formattedAddress}));return(async()=>{let a=d.batch();for(let b of o){let c=f.doc(b.id);a.set(c,{id:b.id,name:b.name,address:b.vicinity,originalRating:b.rating,userRatingsTotal:b.userRatingsTotal,updatedAt:new Date},{merge:!0})}})(),o}catch(a){return console.error("Failed to search places:",a),[]}}async function k(){let a=process.env.GOOGLE_MAPS_API_KEY;return(console.log("getGoogleMapsApiKey called. Key exists:",!!a),a)?a:(console.warn("GOOGLE_MAPS_API_KEY is not set"),"")}(0,g.ensureServerEntryExports)([h,j]),(0,b.registerServerReference)(h,"4056822d4ade9a311a32427aeda022a176ce08eaf4",null),(0,b.registerServerReference)(j,"40643ffc311fa554980b6ccefb27d019ded1354a44",null),(0,g.ensureServerEntryExports)([k]),(0,b.registerServerReference)(k,"0025dcc66d69f150902d2eb593de3fa8e72d85c838",null),a.s([],39984),a.i(39984),a.s(["0025dcc66d69f150902d2eb593de3fa8e72d85c838",()=>k,"4056822d4ade9a311a32427aeda022a176ce08eaf4",()=>h,"40643ffc311fa554980b6ccefb27d019ded1354a44",()=>j],9496)}];

//# sourceMappingURL=_7647bf62._.js.map